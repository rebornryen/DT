function aaa(e){}function getToken(e){var t={},a="",o="",n="",i=$(window),s=i.data("verification")||[],l=$("input","#form-token");return(a=$.Bom.getCookie("csrftoken"))?(o="csrfmiddlewaretoken="+a,t.csrfmiddlewaretoken=a):l.length&&(a=l.val(),t.csrfmiddlewaretoken=a,o=$.param(t)),n='<input type="hidden" name="csrfmiddlewaretoken" value="'+a+'" />',a&&s.length&&(o+="&recaptcha_response_field="+s[0],o+="&recaptcha_challenge_field="+s[1],t.recaptcha_response_field=s[0],t.recaptcha_challenge_field=s[1],n+='<input type="hidden" name="recaptcha_response_field" value="'+s[0]+'" /><input type="hidden" name="recaptcha_challenge_field" value="'+s[1]+'" />'),e?3==e?n:2==e?t:o:o}function getTokenVal(){var e="",t=$("input","#form-token");return(e=$.Bom.getCookie("csrftoken"))||t.length&&(e=t.val()),e}function mergeServerMessage(t){var a="";if($.isArray(t)){for(var o=0;o<t.length;o++){if($.isArray(t[o])){var n=t[o][1]||t[o][0]||"";a+=n+","}a+=t[o]+";"}a=a.slice(0,-1)}else if($.isPlainObject(t)){for(e in t)a+=t[e].toString()+";";a=a.slice(0,-1)}else a=t;return a=a||"",a.split(";")[0].split(",")[0]}function setIptFocus(e){function t(t){var a=t.target;a.style.color="#333",a.value="",$(e).unbind("focus",arguments.callee)}$(e).focus(t)}function setLabelIptFocus(e,t){function a(){""!==$.trim($(e).val())?(clearTimeout($(t).data("timer")),$(t).css("display","none")):$(t).data("timer",setTimeout(function(){$(t).css("display","block")},150))}$(e).bind("blur",function(e){a()}).bind("focus click",function(){clearTimeout($(t).data("timer")),$(t).css("display","none")}),a()}function resetTags(e,t){for(var a=$("a",e),o=[],n=0;n<a.length&&12>n;n++){var i=$.trim(a[n].innerHTML);o.push(i)}var s=$(t).val(),l=!1;a.each(function(e,t){var a=$(t),n=$.trim(a.text()),i=-1!=$.inArray(n,o);(" "+s+" ").match(new RegExp("\\s"+n+"\\s","ig"))?($(t).addClass("added"),!l&&i&&(l=!0)):$(t).removeClass("added")}),l&&a.each(function(e,t){var a=$(t),n=$.trim(a.text()),i=-1!=$.inArray(n,o);l&&i&&$(t).addClass("added")})}function tagSelectBind(e,t,a){$(e).delegate("a","click",function(e){e.preventDefault(),e.stopPropagation();for(var o=$(this),n=$.trim(o.text()),i=o.parent().find("a"),s=[],l=0;l<i.length&&12>l;l++){var r=$.trim(i[l].innerHTML);s.push(r)}if(!o.hasClass("added")){var c=$(t),d=$.trim(c.val()),u=$.trim(d.replace(/,/gi," ").replace(/\s{2,}/gi," ")),p=u.split(" "),f=p.length;if(f>=a)return alert("\u6700\u591a\u53ea\u80fd\u6dfb\u52a0"+a+"\u4e2a\u6807\u7b7e\u54e6"),!1;c.focus(),c.val(c.val()+(""==d||" "==d.charAt(d.length-1)?o.text()+" ":" "+o.text()+" ")),o.addClass("added")}-1!=$.inArray(n,s)&&i.each(function(e,t){var a=$(t);-1!=$.inArray($.trim(a.text()),s)&&a.addClass("added")})}),$(t).keyup(function(t){t.stopPropagation();var o=$.trim(this.value),n=$.trim(o.replace(/,/gi," ").replace(/\s{2,}/gi," ")),i=n.split(" "),s=i.length;return s>a?(this.value=o.replace(/([ ,])+?[^ ,]*$/gi,function(e,t){return t}),t.preventDefault(),!1):void resetTags(e,this)})}function setTagsHTML(e,t){var a=[];$.isArray(t)&&($(t).each(function(e,t){"|"!==t&&a.push('<a href="#"><i>'+t+"</i></a>")}),$(e).find("a").remove(),$(e).append(a.slice(0,20).join("")))}function setDefaultTags(e){for(var t=$("a",e),a=$.G.getMonthCookie("usedtags"),o=a?a.split(";"):[],n=t.length,i=n>12?12:n,s=[],l=0;i>l;l++){var r=$.trim($(t[l]).text());s.push(r)}s.push("|");for(var c=0,d=o.length;d>c;c++)-1===$.inArray(o[c],s)&&s.push(o[c]);if(n>12)for(var l=12;n>l;l++){var r=$.trim($(t[l]).text());s.length<21&&-1===$.inArray(r,s)&&s.push(r)}$.G.setMonthCookie("usedtags",s.join(";")),setTagsHTML(e,s)}function setUsedTags(e,t){var a=$(t),o=$.trim(a.val());if(o){var n=$.trim(o.replace(/\s{2,}/g," ")).split(" "),i=$.G.getMonthCookie("usedtags"),s=i.split(";"),l=$.inArray("|",s);$(n).each(function(e,t){-1===$.inArray(t,s)&&(s=$.grep(s,function(e){return e!==t&&""!==$.trim(e)}),s=s.slice(0,l).concat([t],s.slice(l)))}),s=s.slice(0,20),$.G.setMonthCookie("usedtags",s.join(";")),setTagsHTML(e,s)}}function showSelectTags(e,t,a){function o(){$(e).data("mouselock")||(window.clearTimeout(i),$.isFunction(a)?a(e,t,1):$(e).css("display","block"))}function n(){$(e).data("mouselock")||(window.clearTimeout(i),i=window.setTimeout(function(){$.isFunction(a)?a(e,t):$(e).css("display","none")},200))}var i;$(t).bind("click focus mouseenter",o).blur(n),$(e).bind("mouseenter",o),$(e).bind("mouseleave",n)}function keyupLenLimitForU(e,t,a,o,n){if(e&&"undefined"!=typeof e.value){var i,s=/(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[\w-\.\/%]*)?(?:[?][\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?(?:#[\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?(?=\s)/g,l=[],r=[],t=t||300,a=!!a,n=$(n),c=0,d=e.value.replace(s,function(e,t,a){return l.push(e),r.push(t-c),c+=e.length,""}),u=!1;if(i=a?t-d.length:Math.floor((2*t-d.lenB())/2),i-=8*l.length,0>i){a&&o?d=d.substr(0,t):o&&(d=d.cut(2*t,""));for(var p=[],f=0,h=0,m=l.length;m>f&&8>f;f++)p.push(d.slice(h,r[f])),p.push(l[f]),h=r[f];p.push(d.slice(h,d.length)),e.value=p.join(""),$(e).scrollTop(1e3),u=!0}return n.html(o&&0>i?0:i),u}}function mblogTagsInit(e){var t=$(e[0]),a=$(e[1]),o=$(e[2]),n=$(e[3]),i=$(e[4]),s=$(e[5]),l=e[6];i.lengthLimit();var r={tags:{user_tags:[],def_tags:[],used_tags:[],added_tags:[]},_init:function(){for(var e in this.tags)this.tags[e]=[];for(var a,o=t.find(".added-tag"),e=0,i=o.length;i>e;e++)a=$.trim($(o[e]).text()),a&&this.tags.user_tags.push(a);$.fn.comtags&&n.append(function(){for(var e="",t=$.fn.comtags.tags,a=0;a<t.length;a++)e+='<a href="#">'+t[a]+"</a>";return e}),this._initSysTags(),this._flashHotTagHtml()},_initSysTags:function(){for(var e,t=$.G.getMonthCookie("usedtags"),a=t?t.split(";"):[],o=n.find("a"),i=o.length,s=i>=12?12:i,l=0;s>l;l++)e=$.trim($(o[l]).text()),e&&this.tags.def_tags.push(e);for(var e,l=0,r=a.length;r>l;l++)e=$.trim(a[l]),e&&-1===$.inArray(e,this.tags.def_tags)&&"|"!==e&&this.tags.used_tags.push(e);if(i>12)for(var e,l=12;i>l&&(e=$.trim($(o[l]).text()),!(this.tags.used_tags.length>8));l++)-1===$.inArray(e,this.tags.used_tags)&&this.tags.used_tags.push(e);this._saveToCookie()},_saveToCookie:function(){$.G.setMonthCookie("usedtags",this.tags.def_tags.join(";")+";|;"+this.tags.used_tags.slice(0,20).join(";"))},_escapeHTML:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return e.replace(/[&<>"'\/]/g,function(e){return t[e]})},_flashHotTagHtml:function(){for(var e,t=this.tags.def_tags,a=this.tags.used_tags,o=this._getCurTags(),i=[],s=!1,l=0,r=o.length;r>l;l++)if(e=o[l],$.inArray(e,t)>-1){s=!0;break}for(var e,c,l=0,r=t.length;r>l;l++)c="",e=t[l],c+='<a class="def-tags',$.inArray(e,o)>-1&&(c+=" locked"),s&&(c+=" locked"),c+='" href="javascript:;"><i>'+this._escapeHTML(e)+"</i></a>",i.push(c);for(var e,l=0,r=a.length;r>l;l++)e=a[l],$.inArray(e,o)>-1?i.push('<a class="user-tags locked" href="javascript:;"><i>'+this._escapeHTML(e)+"</i></a>"):i.push('<a class="user-tags" href="javascript:;"><i>'+this._escapeHTML(e)+"</i></a>");n.find("a").remove(),n.append(i.slice(0,20).join(""))},_removeFromSelect:function(e){var a=(t.find(".added-tag"),this.tags.user_tags),o=this.tags.added_tags,n=(this.tags.used_tags,$.inArray(e,a));-1!==n&&(this.tags.user_tags=a.slice(0,n).concat(a.slice(n+1,a.length))),n=$.inArray(e,o),-1!==n&&(this.tags.added_tags=o.slice(0,n).concat(o.slice(n+1,o.length)),tf=!1),this._flashHotTagHtml(),t.find(".added-tag").each(function(t,a){$.trim($(a).text())===e&&$(a).remove()}),t.closest("div").find(".tag-tips").removeClass("red")},_flashPageCnt:function(){if(o.length){for(var e=this._getCurTags(),t=[],a=0,n=e.length;n>a;a++)t.push('<a class="mytag" href="'+l+e[a]+'/"><i>'+this._escapeHTML(e[a])+"</i></a>");o.find("a").not("#addnewtag").remove(),o.prepend(t.join(""))}i.focus()},_remove:function(e){return!a.hasClass("form-locked")&&(a.addClass("form-locked"),e||(e=$.trim(i.prev().text())),e)?-1===$.inArray(e,this.tags.user_tags)?(this._removeFromSelect(e),void a.removeClass("form-locked")):void(a.length?(t.find(".abtn").addClass("abtn-no"),$.ajax({url:a.getFormAction(),data:a.paramForm(getToken(2))+"&tags="+encodeURIComponent(e),mysuccess:function(t,a){r._removeFromSelect(e),r._flashPageCnt()}}).always(function(){a.removeClass("form-locked"),t.find(".abtn").removeClass("abtn-no")})):(a.removeClass("form-locked"),r._removeFromSelect(e),r._flashPageCnt())):void 0},_add:function(e){var a=e.split(","),o=this.tags.user_tags.concat(this.tags.added_tags);i.val("");for(var n,s=0,l=a.length;l>s;s++){if(n=a[s],o.length>=5)return void t.closest("div").find(".tag-tips").addClass("red");n&&-1===$.inArray(n,this.tags.user_tags)&&-1===$.inArray(n,this.tags.added_tags)&&(o.push(n),this.tags.added_tags.push(n),i.before('<a class="added-tag" href="javascript:;"><i>'+this._escapeHTML(n)+"</i></a>"),-1===$.inArray(n,this.tags.used_tags)&&-1===$.inArray(n,this.tags.def_tags)&&this.tags.used_tags.unshift(n))}this._flashHotTagHtml(),this._saveToCookie()},_checkLength:function(){return t.find(".added-tag").length},_getCurTags:function(){return this.tags.user_tags.concat(this.tags.added_tags)},_beforeSubmit:function(){var e=$.trim(i.val());e.length&&this._add(e)},_afterSubmit:function(){this.tags.user_tags=this._getCurTags(),this.tags.added_tags=[]}};s.bind("click",function(e){r.tags.added_tags=[],n.find(".locked").removeClass("locked")}),n.delegate("a","click",function(e){var a=$(this),o=$.trim(a.text());if(!a.hasClass("locked")){if(r._checkLength()>=5)return void t.closest("div").find(".tag-tips").addClass("red");a.hasClass("def-tags")?n.find(".def-tags").each(function(){$(this).hasClass("locked")||$(this).addClass("locked")}):a.addClass("locked"),r._add(o),i.focus()}}),i.bind("keyup",function(e){var t=$(this),a=t.val().slice(-1);if(188===e.keyCode&&!e.shiftKey||13===e.keyCode||229===e.keyCode&&"\uff0c"===a){var o=t.val(),n=o.length;n=13===e.keyCode?n:n-1,o=o.substr(0,n),o=o.replace(/,/gi," "),t.val(o),o.length&&r._add(o)}}),i.bind("keydown",function(e){var t=$(this),a=$.trim(t.val());return 8===e.keyCode&&!a&&r._getCurTags().length&&r._remove(),13===e.keyCode?void e.preventDefault():void 0}),t.click(function(e){i.focus()}),t.delegate("a","click",function(e){r._remove($.trim($(this).text()))}),t.submit(function(e){var t,a=$(this),o=a.find(".abtn");o.find("[type=submit]");return r._beforeSubmit(),(t=r.tags.added_tags.join(","))?void(o.hasClass("abtn-no")||(o.addClass("abtn-no"),a.find("input[name=tags]").val(t),$.ajax({url:a.getFormAction(),data:a.paramForm(getToken(2)),mysuccess:function(e,t){SUGAR.PopOut.closeMask(0),r._flashPageCnt(),r._afterSubmit()}}).always(function(){o.removeClass("abtn-no")}))):(r._flashPageCnt(),void SUGAR.PopOut.closeMask(0))}),r._init()}function taobaoThumbPic(e,t,a){if(/^http:\/\/[^\/]*(alicdn|taobaocdn|aliimg)\.com/.test(e)){var e=e.replace(/_\.webp\w{0,10}$/gi,"");return e=e.replace(/_\d+x[\da-z]{1,10}\.jpg$/gi,""),t?e+"_"+t+"x"+a+".jpg":e}return e}function callFavOffset(e){if(e.length){var t=e.find("div.woo-pcont:visible").offset(),a=t.top,o=t.left,n=parseInt(e.css("marginLeft"))||0;e.data("offset",{left:o-n,top:a})}}function callFavorite(){function e(e,t){t?e.addClass("woocov"):e.removeClass("woocov")}$("div.woo .collbtn .y").SGfavorite(),$("div.woo .collbtn .x").SGcomment(),$("div.woo .collbtn .z").SGlike();var t=$("#woo-holder"),a=$(window);if(t.length){var o=$.browser.msie,n=o&&"6.0"===$.browser.version,i=-20,s=0,l=65;n?t.delegate("div.woo","mousemove",function(o){callFavOffset(t);var n=$(this),i=parseInt(n.css("top"))||0,r=a.scrollTop(),c=t.data("offset"),d=c.top;e(n.find(".a u"),!0),n.find(".collbtn").css({display:"block",top:Math.max(r-(d+i)-s+l,s)})}):(t.delegate("div.woo","mouseenter",function(o){callFavOffset(t);var n=$(this),r=n.find(".collbtn"),c=parseInt(n.css("top"))||0,d=a.scrollTop(),u=t.data("offset"),p=u.top;if(e(n.find(".a u"),!0),$("#collbtn").css("display","none").removeAttr("id").addClass("collbtn"),r.attr("id","collbtn").addClass("collbtn"),d-(p+c)+i+s+l>0){var f=n.offset().left;r.css({left:f,position:"fixed",top:s+l,display:"block"})}else r.css({position:"absolute",left:0,top:s,display:"block"})}),t.delegate("div.woo","mousemove",function(e){var t=$(this),a=t.find(".collbtn");$("#collbtn")[0]!=a[0]&&$("#collbtn").css("display","none").removeAttr("id").addClass("collbtn"),a.attr("id","collbtn").addClass("collbtn")})),t.delegate("div.woo","mouseleave",function(t){var a=$(this);e(a.find(".a u"),!1),a.find(".collbtn").css("display","none").removeAttr("id").addClass("collbtn")})}}!function(){document.cookie="js=1; path=/"}(),$.G={gaq:function(e){},isRedirect:function(e){return e=e.split("?")[0],e.indexOf("/dj/go2/")>-1||e.indexOf("/redirect/")>-1},addfavorite:function(e,t){return document.all?(window.external.addFavorite(e,t),!0):window.sidebar&&window.sidebar.addPanel?(window.sidebar.addPanel(t,e,""),!0):!1},store:function(e){var t=$("#win-house");return t.length||(t=$('<div id="win-house" class="h0"></div>').appendTo("body")),e&&t.append(e),t},getToken:function(e){var t={},a="",o="",n="",i=$(window),s=i.data("verif")||[],l=$("input","#form-token");return(a=$.Bom.getCookie("csrftoken"))?(o="csrfmiddlewaretoken="+a,t.csrfmiddlewaretoken=a):l.length&&(a=l.val(),t.csrfmiddlewaretoken=a,o=$.param(t)),n='<input type="hidden" name="csrfmiddlewaretoken" value="'+a+'" />',s.length&&(o+="&ccode="+s[0],o+="&ctoken="+s[1],t.ccode=s[0],t.ctoken=s[1],n+='<input type="hidden" name="ccode" value="'+s[0]+'" /><input type="hidden" name="ctoken" value="'+s[1]+'" />'),e?3==e?n:2==e?t:o:o},getTokenVal:function(){var e="",t=$("input","#form-token");return(e=$.Bom.getCookie("csrftoken"))||t.length&&(e=t.val()),e},setCookie:function(e,t){$.Bom.setSubCookie("sg",e,t)},setDayCookie:function(e,t){$.Bom.setSubCookie("sgd",e,t,{expires:1})},setWeekCookie:function(e,t){$.Bom.setSubCookie("sgw",e,t,{expires:7})},setMonthCookie:function(e,t){$.Bom.setSubCookie("sgm",e,t,{expires:30})},setYearCookie:function(e,t){$.Bom.setSubCookie("sgy",e,t,{expires:365})},getCookie:function(e){return $.Bom.getSubCookie("sg",e)},getDayCookie:function(e){return $.Bom.getSubCookie("sgd",e)},getWeekCookie:function(e){return $.Bom.getSubCookie("sgw",e)},getMonthCookie:function(e){return $.Bom.getSubCookie("sgm",e)},getYearCookie:function(e){return $.Bom.getSubCookie("sgy",e)},simpleMarqueeW:function(e,t,a,o){var n=$(e),i=n.find(":first-child"),s=n.parent();if(i.length){var l,i,r,t=t||4e3,a=a||2,o=o||20,c=!1,d=function(){r=i.outerWidth(!0),clearInterval(l),l=setInterval(u,o)},u=function(){c||(s.scrollLeft()+a>=r?(clearInterval(l),n.append(i),s.scrollLeft(0),setTimeout(d,t)):s.scrollLeft(s.scrollLeft()+a))};n.mouseover(function(){c=!0}),n.mouseout(function(){c=!1}),setTimeout(d,t)}},simpleMarqueeH:function(e,t,a,o,n){var i=$(e),s=i.find(":first-child");if(s.length){var l,s,r,t=t||4e3,o=o||2,n=n||20,c=!1,d=function(){r=s.outerHeight(!0),clearInterval(l),l=setInterval(u,n)},u=function(){c||(i.scrollTop()+o>=r?(clearInterval(l),i.append(s),i.scrollTop(0),setTimeout(d,t)):i.scrollTop(i.scrollTop()+o))};i.mouseover(function(){c=!0}),i.mouseout(function(){c=!1}),setTimeout(d,a)}},scrollToAnchor:function(e,t){var t=t||0,a=($(window),$("body,html")),o=$("a[name="+e+"]");if(e&&o.length){var n=o.offset().top-t||0;a.animate({scrollTop:n},200)}else window.ActiveXObject&&!window.XMLHttpRequest&&a.animate({scrollTop:n},200)},bindChecks:function(e,t,a,o,n,i){function s(e){var t=[],a="",o=c.find(l);e.prop("checked")?(o.each(function(e,a){var o=$(a),n=o.attr("value");o.prop("checked",!0),void 0!==n&&o.attr("dvalue",n),t.push(o.attr("dvalue"))}),r.prop("checked",!0).add(o).addClass("checked")):(o.each(function(e,t){$(t).prop("checked",!1)}),r.prop("checked",!1).add(o).removeClass("checked")),a=$.trim(t.join(" ")).replace(/ /gi,","),r.attr("dvalue",a),r.filter("[type=checkbox]").val(a)}var l="input[type=checkbox],[checked],[checked=false]",r=$(e),c=$(t);a?r.prop("checked",!0):void 0!==a?r.prop("checked",!1):"true"==r.attr("dchecked")?r.prop("checked",!0):r.prop("checked")||r.prop("checked",!1),s(r),"checkbox"!=r.attr("type")&&r.click(function(e){var t=!0;$.isFunction(o)&&(t=o()),t&&r.prop("checked",!r.prop("checked"))}),r.click(function(e){e.stopPropagation();var t=$(this),a=!0;$.isFunction(o)&&(a=o.call(this,r,c,l)),a&&(s(t),$.isFunction(n)&&n.call(this,r,c,l))}),c.delegate(l,"click",function(e){e.stopPropagation();var t=$(this);"checkbox"!=t.attr("type")&&t.prop("checked",!t.prop("checked"));var a=$.trim(r.attr("dvalue")),o=a?a.split(","):[],n="",s=t.attr("value");void 0!==s&&t.attr("dvalue",s),s=t.attr("dvalue"),o=$(o).filter(function(e,t){return t!==s}).get();var d=t.prop("checked");d?(o.push(s),t.addClass("checked")):t.removeClass("checked"),n=$.trim(o.join(" ")).replace(/ /gi,","),r.attr("dvalue",n),"checkbox"==r.attr("type")&&r.val(n),$.isFunction(i)&&i.call(this,r,c,l,d)})},getCursorPosition:function(e){var t={text:"",start:0,end:0};if(e.setSelectionRange)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=t.start!=t.end?e.value.substring(t.start,t.end):"";else if(document.selection){var a,o=document.selection.createRange(),n=document.body.createTextRange();for(n.moveToElementText(e),t.text=o.text,t.bookmark=o.getBookmark(),a=0;n.compareEndPoints("StartToStart",o)<0&&0!==o.moveStart("character",-1);a++)"\n"==e.value.charAt(a)&&a++;t.start=a,t.end=t.text.length+t.start}return t},setCursorPosition:function(e,t){if(t||alert("You must get cursor position first."),e.setSelectionRange)e.focus(),e.setSelectionRange(t.start,t.end);else if(e.createTextRange){var a=e.createTextRange();e.value.length===t.start?(a.collapse(!1),a.select()):(a.moveToBookmark(t.bookmark),a.select())}},getSelectedText:function(){var e=window,t=document;return e.getSelection?e.getSelection().toString():t.getSelection?t.getSelection():t.selection?t.selection.createRange().text:void 0},blinkIt:function(e,t,a,o,n){return n=n||1e3,0===o?void a():($.isFunction(e)&&e(),void window.setTimeout(function(){$.G.blinkIt(t,e,a,--o,n)},n))},recurseDo:function(e,t,a,o,n){return 0==a?void($.isFunction(n)&&n()):(t=e.apply(null,t),void(t[0].length?setTimeout(function(){$.G.recurseDo(e,t,--a,o,n)},o):$.isFunction(n)&&n()))},getUSERID:function(){return"undefined"!=typeof USER&&USER.ID?USER.ID:""},isSTAFF:function(){return"undefined"!=typeof USER&&USER.ISSTAFF?!0:!1},dtImageTrans:function(e,t,a,o,n){var i=$.trim(e).replace(/^http(s)?:\/\//gi,""),i=i.split("/"),s=i[0],i=i[1];return-1==s.indexOf("duitang.com")||!i||"uploads"!=i&&"misc"!=i?e:t?(a=a||0,o=o||0,n=n?"_"+n:"",$.G.dtImageTrans(e).replace(/(\.[a-z_]+)$/gi,".thumb."+a+"_"+o+n+"$1")):e.replace(/(?:\.thumb\.\w+|\.[a-z]+!\w+)(\.[a-z_]+)$/gi,"$1")},getFitSize:function(e,t){if(e[0]&&e[1]&&t[0]&&(t[1]||(t[1]=t[0]),e[0]>t[0]||e[1]>t[1])){var a=e[0]/e[1],o=a>=t[0]/t[1];return o?[t[0],parseInt(t[0]/a)]:[parseInt(t[1]*a),t[1]]}return e},setImgSize:function(e,t,a){e.onload=null,e.removeAttribute("width"),e.removeAttribute("height");var o=e;if(o&&o.width&&o.height&&t&&(a||(a=t),o.width>t||o.height>a)){var n=o.width/o.height,i=n>=t/a;e[i?"width":"height"]=i?t:a,document.all&&(e[i?"height":"width"]=(i?t:a)*(i?1/n:n))}e.style.visibility="visible"},setImgSizeByAncestor:function(e,t){e.onload=null;var a=$(e).parent(t)[0];if(a){var o=parseInt($(a).css("width"));o=o?o:a.offsetWidth,$.G.setImgSize(e,o)}},getNum:function(e){return e?+e.replace(/^[^\d]*(\d+\.?\d*).*/,"$1")||0:0},isFromDomain:function(e){e=e.replace("http://","").replace("https://",""),e=e.split("?"),e=e[0].split("/"),e=e[0];for(var t=1;t<arguments.length;t++)if(e.indexOf(arguments[t])>-1)return!0;return!1},trimLink:function(e,t){return e.replace(/(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[\w-\.\/%]*)?(?:[?][\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?(?:#[\w-\.\/%!*\(\);\:@&=+$,\[\]]*)?/gi,function(e){return t?'<a href="'+e+'" target="_blank">'+e+"</a>":""})},isLink:function(e){return!!e.match(/^(?:http(?:s)?:\/\/)(?:(?:[\w-]+\.)+[\w-]+)(?:\:\d+)?(?:\/[^ \t\n]*)?$/gi)},removeParam:function(e,t){var a=new RegExp("\\?"+t+"(=[^&]*)?"),o=new RegExp("\\&"+t+"(=[^&]*)?");return e.replace(a,"?").replace(o,"").replace(/\?&/,"?").replace(/\?$/,"")},getParams:function(e){var t,a,o,n={},e=e.split("#")[0],i=e.indexOf("?"),s=i>-1?e.substr(i+1):"",l=s.split("&");for(o=0,len=l.length;o<len;o++){var r=l[o].indexOf("=");if(r>0){t=l[o].substring(0,r),a=l[o].substr(r+1);try{a.indexOf("+")>-1&&(a=a.replace(/\+/g," ")),n[t]=decodeURIComponent(a)}catch(c){}}}return n},addParam:function(e,t,a){var o=new RegExp("([&\\?])"+t+"=[^& ]*","g");e=e.replace(o,function(e,t){return"?"==t?"?":""});var n=e.indexOf("?");return e+=(n>-1?n+1!=e.length?"&":"":"?")+t+"="+a}},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){null==t?t=0:0>t&&(t=Math.max(0,this.length+t));for(var a=t;a<this.length;a++)if(this[a]===e)return a;return-1}),String.prototype.lenB||(String.prototype.lenB=function(){return this.replace(/[^\x00-\xff]/g,"**").length}),String.prototype.leftB||(String.prototype.leftB=function(e){var t=this,a=t.slice(0,e),o=a.replace(/[^\x00-\xff]/g,"**").length;if(e>=o)return a;switch(o-=a.length){case 0:return a;case e:return t.slice(0,e>>1);default:var n=e-o,i=t.slice(n,e),s=i.replace(/[\x00-\xff]/g,"").length;return s?t.slice(0,n)+i.leftB(s):t.slice(0,n)}}),String.prototype.cut||(String.prototype.cut=function(e,t,a){var o=this;return r=a?o.substr(0,e):o.leftB(e),r==o?r:r+("undefined"==typeof t?"\u2026":t)}),Date.prototype.pattern=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},a={0:"\u65e5",1:"\u4e00",2:"\u4e8c",3:"\u4e09",4:"\u56db",5:"\u4e94",6:"\u516d"};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"\u661f\u671f":"\u5468":"")+a[this.getDay()+""]));for(var o in t)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("00"+t[o]).substr((""+t[o]).length)));return e},$.ajaxSetup({type:"POST",timeout:2e4,wrongmsg:function(e){var t=$.trim(mergeServerMessage(e.message));t&&SUGAR&&(SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>'+t+"</h3></div>"),$({}).delay(4e3).queue(function(){SUGAR.PopOut.closeMask()}))},errormsg:function(){SUGAR&&(SUGAR.PopOut.alert('<div class="prompt prompt-fail"><h3>\u7f51\u7edc\u51fa\u95ee\u9898\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5</h3></div>'),$({}).delay(2e3).queue(function(){SUGAR.PopOut.closeMask()}))},success:function(e,t,a){if(-1==$.inArray("html",this.dataTypes)){var o=$.isPlainObject(e)?e:$.parseJSON(e);if(!o)return void $.G.gaq("/_trc/Error/ajax/json_parse_fail_"+this.url);if(o.success||1==o.status)$.isFunction(this.mysuccess)&&this.mysuccess(o,e);else{$.isFunction(this.myfailure)?this.myfailure(o,e):this.wrongmsg(o);var n=mergeServerMessage(o.message);n&&$.G.gaq("/_trc/Error/ajax/response_"+n+"_"+this.url)}}},error:function(e,t){$.G.gaq("/_trc/Error/ajax/status_"+t+"_"+(this.url?this.url:"null_"+window.location.href)),$.isFunction(this.myerror)&&this.myerror(e,t)}}),function(e){function t(e){e.preventDefault(),e.type="safeSubmit",a.handle?a.handle.apply(this,arguments):a.dispatch&&a.dispatch.apply(this,arguments)}var a=e.event;a.special;a.special.safeSubmit={setup:function(){var o=this;e(o);a.add(o,"submit",t)},teardown:function(){var o=this;e(o);a.remove(o,"submit",t)}},e.fn.safeSubmit=function(t,a,o){return"function"!=typeof o&&(o=a,a=t,t=null),o=o||function(){alert("\u8bf7\u8f93\u5165\u5185\u5bb9")},arguments.length>0?this.unbind("safeSubmit").bind("safeSubmit",t,function(t){var n=this,i=e(n),s=e("input[type=text],textarea",i).not("[name=]").not("[data-optional]"),l=e("[type=submit]",i);safe=!0,s.each(function(t,a){""===e.trim(e(a).val())&&safe&&(safe=!1)}),l.each(function(t,a){e(a).prop("disabled")&&safe&&(safe=!1)}),safe?a.call(this,arguments):o.call(this,arguments)}):this.trigger("safeSubmit")}}(jQuery),function(e){e.fn.serializeObject=function(){var t={},a=function(t){return t.name=e.camelCase(t.name),t},o=function(e,a){var o=t[a.name];"undefined"!=typeof o&&null!==o?t[a.name]=o.push?o.push(a.value):[o,a.value]:t[a.name]=a.value};return e.each(e.map(this.serializeArray(),a),o),t},e.fn.getFormAction=function(){var e=this,t=e[0];return t&&"form"===t.tagName.toLowerCase()?encodeURI(e.attr("action")):null},e.fn.paramForm=function(t){var a=e(this),o={};return a.find("input,select,textarea").not("[type=submit]").filter("[name]").each(function(t,a){(("checkbox"===e(a).attr("type")||"radio"===e(a).attr("type"))&&e(a).prop("checked")===!0||"checkbox"!==e(a).attr("type")&&"radio"!==e(a).attr("type"))&&("undefined"!==e.type(o[a.name])?o[a.name]+=","+a.value:o[a.name]=a.value)}),e.isPlainObject(t)&&e.extend(o,t),e.param(o)},e.fn.lengthLimit=function(t){return this.filter("textarea,input[type=text]").each(function(){var t=e(this),a=t.attr("maxlength"),o=function(e){var t=e?e.keyCode:null;if(t&&8!==t&&13!==t&&!(t>36&&41>t)){var o=this,n=o.value,i=n.cut(a,"");i.length<n.length&&(o.value=i,o.scrollTop=o.scrollHeight)}};e(this).change(function(e){o.call(this,e)}).keyup(function(e){o.call(this,e)}),o.apply(this)}),this},e.fn.inputTagLimit=function(t){var a=e.extend(!0,{},{invalid:new RegExp("/"),taglen:20},t);return this.filter("textarea,input[type=text]").each(function(){var t=e(this),o=a.taglen,n=function(n){var i=n?n.keyCode:null;if(i&&8!==i&&13!==i&&!(i>36&&41>i)){var s=t.val(),l=s.split(" "),l=l[l.length-1],r=s.substring(0,s.length-l.length);" "!=s[s.length-1]&&l&&l.lenB()>o&&(l=l.cut(o,""),s=r+l),t.val(s.replace(a.invalid,"")),vl=t.val().length,e.G.setCursorPosition(t[0],{start:vl,end:vl})}};e(this).change(function(e){n.call(this,e)}).keyup(function(e){n.call(this,e)}),n.apply(this)}),this},e.fn.pagelimit=function(t){function a(){var e=parseInt(this.value)||0,t=i||0;e>t?this.value=t:1>e?this.value=1:this.value=e}function o(e){e.keyCode>=37&&e.keyCode<=40||46==e.keyCode||8==e.keyCode||a.call(this)}var n=e(this),i=t.length||0;n.change(o).keyup(o),a.call(this)}}(jQuery),function(e){function t(e,t){for(var a=0,o="";t>a;a++)o+=e;return o}e.fn.autogrow=function(a){return this.filter("textarea").each(function(){this.timeoutId=null;var a=e(this),o=a.height(),n=e("<div></div>").css({position:"absolute",wordWrap:"break-word",top:0,left:-9999,display:"none",width:a.width(),fontSize:a.css("fontSize"),fontFamily:a.css("fontFamily"),lineHeight:a.css("lineHeight")}).appendTo(document.body),i=function(){var i=this.value.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(e){return t("&nbsp;",e.length-1)+" "});n.html(i),e(this).css("overflow","hidden").css("height",Math.max(n.height()+(parseInt(a.css("lineHeight"))||0),o))},s=function(){clearTimeout(this.timeoutId);var e=this;this.timeoutId=setTimeout(function(){i.apply(e)},100)};e(this).change(i).keyup(s).keydown(s),i.apply(this)}),this}}(jQuery),function(e){function t(t,o){var i=t==window,d=o&&void 0!==o.message?o.message:void 0;o=e.extend({},e.blockUI.defaults,o||{}),o.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,o.overlayCSS||{});var m=e.extend({},e.blockUI.defaults.css,o.css||{}),g=e.extend({},e.blockUI.defaults.themedCSS,o.themedCSS||{});if(d=void 0===d?o.message:d,i&&f&&a(window,{fadeOut:0}),d&&"string"!=typeof d&&(d.parentNode||d.jquery)){var v=d.jquery?d[0]:d,b={};e(t).data("blockUI.history",b),b.el=v,b.parent=v.parentNode,b.display=v.style.display,b.position=v.style.position,b.parent&&b.parent.removeChild(v)}e(t).data("blockUI.onUnblock",o.onUnblock);var $,w,y=o.baseZ,k=e(e.browser.msie||o.forceIframe?'<iframe class="blockUI" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+o.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),_=e(o.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+y++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');w=o.theme&&i?'<div class="blockUI '+o.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:fixed"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>':o.theme?'<div class="blockUI '+o.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:absolute"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>':i?'<div class="blockUI '+o.blockMsgClass+' blockPage" style="z-index:'+(y+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+o.blockMsgClass+' blockElement" style="z-index:'+(y+10)+';display:none;position:absolute"></div>',$=e(w),d&&(o.theme?($.css(g),$.addClass("ui-widget-content")):$.css(m)),o.theme||o.applyPlatformOpacityRules&&e.browser.mozilla&&/Linux/.test(navigator.platform)||_.css(o.overlayCSS),_.css("position",i?"fixed":"absolute"),(e.browser.msie||o.forceIframe)&&k.css("opacity",0);var x=[k,_,$],C=e(i?"body":t);e.each(x,function(){this.appendTo(C)}),o.theme&&o.draggable&&e.fn.draggable&&$.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var T=u&&(!e.boxModel||e("object,embed",i?null:t).length>0);if(p||T){if(i&&o.allowBodyStretch&&e.boxModel&&e("html,body").css("height","100%"),(p||!e.boxModel)&&!i)var S=r(t,"borderTopWidth"),j=r(t,"borderLeftWidth"),P=S?"(0 - "+S+")":0,I=j?"(0 - "+j+")":0;e.each([k,_,$],function(e,t){var a=t[0].style;if(a.position="absolute",2>e)i?a.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.boxModel?0:"+o.quirksmodeOffsetHack+') + "px"'):a.setExpression("height",'this.parentNode.offsetHeight + "px"'),i?a.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):a.setExpression("width",'this.parentNode.offsetWidth + "px"'),I&&a.setExpression("left",I),P&&a.setExpression("top",P);else if(o.centerY)i&&a.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),a.marginTop=0;else if(!o.centerY&&i){var n=o.css&&o.css.top?parseInt(o.css.top):0,s="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+n+') + "px"';a.setExpression("top",s)}})}if(d&&(o.theme?$.find(".ui-widget-content").append(d):$.append(d),(d.jquery||d.nodeType)&&e(d).show()),(e.browser.msie||o.forceIframe)&&o.showOverlay&&k.show(),o.fadeIn){var G=o.onBlock?o.onBlock:c,A=o.showOverlay&&!d?G:c,D=d?G:c;o.showOverlay&&_._fadeIn(o.fadeIn,A),d&&$._fadeIn(o.fadeIn,D)}else o.showOverlay&&_.show(),d&&$.show(),o.onBlock&&o.onBlock();if(n(1,t,o),i?(f=$[0],h=e(":input:enabled:visible",f).not("[type=file]"),o.focusInput&&setTimeout(s,20)):l($[0],o.centerX,o.centerY),o.timeout){var U=setTimeout(function(){i?e.unblockUI(o):e(t).unblock(o)},o.timeout);e(t).data("blockUI.timeout",U)}}function a(t,a){var i=t==window,s=e(t),l=s.data("blockUI.history"),r=s.data("blockUI.timeout");r&&(clearTimeout(r),s.removeData("blockUI.timeout")),a=e.extend({},e.blockUI.defaults,a||{}),n(0,t,a),null===a.onUnblock&&(a.onUnblock=s.data("blockUI.onUnblock"),s.removeData("blockUI.onUnblock"));var c;c=i?e("body").children().filter(".blockUI").add("body > .blockUI"):e(".blockUI",t),i&&(f=h=null),a.fadeOut?(c.fadeOut(a.fadeOut),setTimeout(function(){o(c,l,a,t)},a.fadeOut)):o(c,l,a,t)}function o(t,a,o,n){t.each(function(e,t){this.parentNode&&this.parentNode.removeChild(this)}),a&&a.el&&(a.el.style.display=a.display,a.el.style.position=a.position,a.parent&&a.parent.appendChild(a.el),
e(n).removeData("blockUI.history")),"function"==typeof o.onUnblock&&o.onUnblock(n,o)}function n(t,a,o){var n=a==window,s=e(a);if((t||(!n||f)&&(n||s.data("blockUI.isBlocked")))&&(n||s.data("blockUI.isBlocked",t),o.bindEvents&&(!t||o.showOverlay))){var l="mousedown mouseup keydown keypress";t?e(document).bind(l,o,i):e(document).unbind(l,i)}}function i(t){if(t.keyCode&&9==t.keyCode&&f&&t.data.constrainTabKey){var a=h,o=!t.shiftKey&&t.target===a[a.length-1],n=t.shiftKey&&t.target===a[0];if(o||n)return setTimeout(function(){s(n)},10),!1}var i=t.data;return e(t.target).parents("div."+i.blockMsgClass).length>0?!0:0==e(t.target).parents().children().filter("div.blockUI").length}function s(e){if(h){var t=h[e===!0?h.length-1:0];t&&t.focus()}}function l(e,t,a){var o=e.parentNode,n=e.style,i=(o.offsetWidth-e.offsetWidth)/2-r(o,"borderLeftWidth"),s=(o.offsetHeight-e.offsetHeight)/2-r(o,"borderTopWidth");t&&(n.left=i>0?i+"px":"0"),a&&(n.top=s>0?s+"px":"0")}function r(t,a){return parseInt(e.css(t,a))||0}e.fn._fadeIn=e.fn.fadeIn;var c=function(){},d=document.documentMode||0,u=e.browser.msie&&(e.browser.version<8&&!d||8>d),p=e.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!d;e.blockUI=function(e){t(window,e)},e.unblockUI=function(e){a(window,e)},e.growlUI=function(t,a,o,n){var i=e('<div class="growlUI"></div>');t&&i.append("<h1>"+t+"</h1>"),a&&i.append("<h2>"+a+"</h2>"),void 0==o&&(o=3e3),e.blockUI({message:i,fadeIn:700,fadeOut:1e3,centerY:!1,timeout:o,showOverlay:!1,onUnblock:n,css:e.blockUI.defaults.growlCSS})},e.fn.block=function(a){return this.unblock({fadeOut:0}).each(function(){"static"==e.css(this,"position")&&(this.style.position="relative"),e.browser.msie&&(this.style.zoom=1),t(this,a)})},e.fn.unblock=function(e){return this.each(function(){a(this,e)})},e.blockUI.version=2.39,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"none",backgroundColor:"#fff"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.2},growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:200,timeout:0,showOverlay:!0,focusInput:!1,applyPlatformOpacityRules:!0,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg"};var f=null,h=[]}(jQuery),SUGAR=function(){var e=$.browser.msie,t=($.browser.mozilla,e&&"6.0"===$.browser.version);e&&"7.0"===$.browser.version,e&&"8.0"===$.browser.version,e&&"9.0"===$.browser.version,$.browser.opera;return{PopOut:function(){return{fnCloseMask:function(){this.closeMask()},poptorylen:10,poptory:[],WD:[400,484,660],STR:['<a href="javascript:;" target="_self" class="abtn l" onclick="SUGAR.PopOut.closeMask();"><button type="button"><u>\u5173\u95ed</u></button></a>','<a href="javascript:;" target="_self" class="abtn l" onclick="SUGAR.PopOut.closeMask();"><button type="button"><u>\u53d6\u6d88</u></button></a>'],go:function(e){if(e=-e,!(0>e||e>9)){var t,a=this;if(t=a.poptory[e]){var o=a.setCont([t.head,t.cont],t.n);a.blockPop(o,t.n,t.ht,t.opt)}}},alert:function(e,t,a){var o=this,t="s"===t?0:"m"===t?1:"l"===t?2:t,t=t||0;o.WD,$.G.store();("string"===$.type(e)||"number"===$.type(e))&&(e=["",e+""]),e[0]=e[0],e[1]=e[1]||"";var n="string"===$.type(e[1]),i=o.setCont(e,t),s=i.outerHeight();if(n){var l=i.html();i.remove(),i='<div class="mask-body">'+l+"</div>"}else o.poptory=[{head:e[0],cont:$(e[1]),n:t,ht:s,opt:a}].concat(o.poptory),o.poptory.length=o.poptorylen;o.blockPop(i,t,s,a)},setCont:function(e,t){var a,o,n=this,i=n.WD,s=$.G.store();return a=null==e[0]?"":$('<div class="tt-s"><span>'+e[0]+'</span><a class="mask-close" target="_self" href="javascript:;" onclick="SUGAR.PopOut.closeMask();">\u5173\u95ed</a></div>'),o=$('<div class="mask-body"></div>').css("width",i[t]).appendTo(s),o.append(a).append($('<div class="mask-cont"></div>').append(e[1])),o},blockPop:function(e,t,a,o){var n=this,i=n.WD,s=$.G.store();o=$.extend({position:"fixed"},o);var l,r,c,d=!1;"fixed"===o.position?d=!0:(l=$(window),r=l.scrollTop(),c=l.height()),$.blockUI({message:e,baseZ:9e3,focusInput:o&&void 0!==o.focus?o.focus:!0,onUnblock:function(){s.find(".mask-cont:empty").closest(".mask-body").remove(),o&&$.isFunction(o.fn)&&o.fn()},css:{position:o.position,top:d?"50%":r,left:"50%",textAlign:"left",marginLeft:-(i[t]/2),marginTop:d?-(a/2)-20:a>=c?0:(c-a)/2,width:i[t],height:a,border:"none",background:"none"},fadeIn:$(".blockOverlay:visible").length?0:200}),1>t&&n.setOverLay()},setOverLay:function(){if(!t){var e=$("div.blockPage"),a=e.outerWidth(),o=e.outerHeight(),n=parseInt(e.css("marginTop")),i=parseInt(e.css("marginLeft"));$("div.blockOverlay").css({width:a+24,height:o+24,top:"50%",left:"50%",marginTop:n-12,marginLeft:i-12,"border-radius":"8px","-moz-border-radius":"8px","-webkit-border-radius":"8px"})}},closeMask:function(){$.unblockUI()}}}()}}(),function(e){var t=e.browser.msie&&"6.0"===e.browser.version,a=e.browser.opera;e.fn.sidepop=function(o){var n={_create:function(t,a){var o=a.id,n=t.$pop,i=["none","none","none"];1==a.btnset?i[2]="":2==a.btnset?i[0]="":3==a.btnset&&(i[2]="",i[0]=""),t.$bar=e(a.btnset?['<div class="',a.btnClass.bars,'" ',a.seat?"":'style="display:none;"','><a  class="',a.btnClass.min,'" style="display:',i[0],'" href="javascript:;" target="_self">-</a><a class="',a.btnClass.max,'" style="display:',i[1],'" href="javascript:;" target="_self">+</a><a class="',a.btnClass.close,'" style="display:',i[2],'" href="javascript:;" target="_self">X</a></div>'].join(""):""),t.$cont=e('<div class="'+a.btnClass.cont+'"></div>'),a.seat?(t.$dom=e('<div class="'+o+'"></div>').append(t.$bar).append(t.$cont),t.$wrap=e("<div>").append(t.$dom),n.before(t.$wrap),t.$cont.append(n)):t.$dom=e('<div class="'+o+'"></div>').append(t.$bar).append(t.$cont.append(n)).appendTo(a.position)},_feature:function(o,n){var i=(o.$pop,o.$dom),s=o.$cont,l=e(window),r=l.width(),c=l.height();l.scrollTop();o.size=[null===n.width?s.outerWidth():n.width,null===n.height?s.outerHeight():n.height];var d="absolute";if(n.seat){i.removeClass(".SG-posfollow"),d="relative";var u=i.offset();o.inittop=u.top,o.initleft=u.left,o.$wrap.css({width:n.width,height:n.height})}else t||1!=n.isFixed||(d="fixed");i.css({position:d,bottom:"auto",zIndex:n.zIndex,width:o.size[0],height:o.size[1]}),o.bias="middle"===n.bias?(c-o.size[1])/2:n.bias,o.departure="center"===n.departure?(r-o.size[0])/2:n.departure,(t&&"bottom"==n.baseline||a&&"bottom"==n.baseline)&&(o.bias-=2),i.css({left:"right"===n.dockSide?"auto":o.departure,right:"left"===n.dockSide?"auto":o.departure}),"bottom"==n.baseline?n.seat||t||1!=n.isFixed||i.css({top:"auto",bottom:o.bias}):"top"==n.baseline&&(n.seat||t||1!=n.isFixed||i.css({bottom:"auto",top:o.bias}))},_bindBars:function(t,a){var o=t.$bar,i=a.btnClass;o.delegate("a","click",function(o){var s=e(this);s.hasClass(i.close)?n.close(t,a):s.hasClass(i.show)?n.show(t,a):s.hasClass(i.min)?n.min(t,a):s.hasClass(i.max)&&n.max(t,a)})},_scrollAnim:function(e,t){2===t.scroll?e.$dom.stop().css({opacity:0,top:n._getTop(e,t)[0]}).animate({opacity:1},t.fadeSpeed,function(){e.$bar.css("display","block")}):e.$dom.animate({top:n._getTop(e,t)[0]},t.floatSpeed,function(){e.$bar.css("display","block")})},_eventScroll:function(t){var a=t.data.props,o=t.data.c;2===o.scroll&&a.$dom.not(":animated").css({opacity:0}),e.isFunction(o.withScroll)&&o.withScroll(),window.clearTimeout(a.scrollTimer),a.scrollTimer=window.setTimeout(function(){n._scrollAnim(a,o)},o.scrollDelayTime)},_scrollSeatAnim:function(e,a){var o=e.$dom,i=n._getTop(e,a);e.inittop=e.$wrap.offset().top,e.$wrap.find(":first-child").length||e.$wrap.append(o),i[0]<e.inittop?(o.removeClass("SG-posfollow"),o.css({position:"relative",top:0,left:0})):a.seatrange&&i[0]>e.inittop+a.seatrange-i[2]?o.css({position:"relative",top:a.seatrange-i[2]+a.seattop,left:0}):(o.addClass("SG-posfollow"),t||1!=a.isFixed?o.appendTo(a.position).css({position:"absolute",top:i[0],left:e.initleft}):o.css({position:"fixed",top:i[0]-i[1]+a.seattop,left:e.initleft}))},_eventScrollSeat:function(t){var a=t.data.props,o=t.data.c;e.isFunction(o.withScroll)&&o.withScroll(),n._scrollSeatAnim(a,o)},_bindScroll:function(a,o){return!o.seat&&!t&&1==o.isFixed||0===o.scroll?void a.$bar.css("display","block"):void(o.seat?(a.$bar.css("display","block"),e(window).scroll({props:a,c:o},n._eventScrollSeat),n._scrollSeatAnim(a,o)):(e(window).scroll({props:a,c:o},n._eventScroll),n._scrollAnim(a,o)))},_unbindScroll:function(){e(window).unbind("scroll",n._eventScroll)},_getTop:function(t,a){var o=t.bias,n=t.$dom,i=n.outerHeight(!1),s=(e(window).width(),e(window).height()),l=e(window).scrollTop(),r=i+o-s;switch(r=0>r?0:r,a.baseline){case"top":return[l+o-r,l,i];case"bottom":return[l+s-i-o+r,l,i]}},close:function(t,a){var o=t.$dom,i=a.btnClass;o.css("display","none"),n._unbindScroll(t,a);var s=i.close;e("."+s,o).removeClass(s).addClass(i.show),e.isFunction(a.fnAfterClose)&&a.fnAfterClose.call(n,t,a)},show:function(t,a){var o=t.$dom,i=a.btnClass;o.css("display","block"),n._bindScroll(t,a);var s=i.show;e("."+s,o).removeClass(s).addClass(i.close)},min:function(t,a){var o=t.$dom,n=a.btnClass,i="left-right"===a.expandDir,s=i?{width:a.remainArea}:{height:a.remainArea};i||"bottom"!==a.baseline||(s.marginTop=t.size[1]-a.remainArea),o.animate(s,function(){e("."+n.min,o).css("display","none"),e("."+n.max,o).css("display","inline")})},max:function(t,a){var o=t.$dom,n=a.btnClass,i="left-right"===a.expandDir,s=i?{width:t.size[0]}:{height:t.size[1]};i||"bottom"!==a.baseline||(s.marginTop=0),o.animate(s,function(){e("."+n.min,o).css("display","inline"),e("."+n.max,o).css("display","none")})},_noop:e.noop},i=e.extend(!0,{},e.fn.sidepop.defaults,o),s=e(this),l={};return s.length?(l.$pop=s,n._create(l,i),n._feature(l,i),n._bindBars(l,i),n._bindScroll(l,i),e.isFunction(i.fnInitExe)&&i.fnInitExe.call(n,l,i),this):void 0},e.fn.sidepop.defaults={id:"",position:"body",width:null,height:null,remainArea:25,initTop:null,btnClass:{min:"SG-sidemin",max:"SG-sidemax",close:"SG-sideclose",show:"SG-sideshow",bars:"SG-sidebar",cont:"SG-sidecont"},btnset:1,scroll:2,fnInitExe:null,fnAfterClose:null,dockSide:"left",departure:0,baseline:"bottom",seat:!1,seatrange:null,seattop:0,withScroll:null,isFixed:0,bias:100,expandDir:"top-down",floatSpeed:150,fadeSpeed:250,scrollDelayTime:350,zIndex:1e3}}(jQuery),function(e){var t=1;e.fn.tippop=function(a){var o={_create:function(a,o){var n=o.id,i=a.$pop;a.$dom=e('<div class="'+n+' SG-tippop"></div>').append(e('<div class="pr"><u></u></div>')).append(i).appendTo("body"),a.size=[o.width,o.height],t=Math.max(t,o.zIndex),a.$dom.css({position:"absolute",bottom:"auto",zIndex:o.zIndex,width:a.size[0],height:a.size[1],display:"none"})},_bind:function(a,n){var i=a.$dom,s=e(n.triger),l=n.delegateSelector;e(".SG-close",i).click(function(e){e.preventDefault(),o.close(a)}),e(".SG-close-e",i).click(function(e){e.preventDefault(),o.close(a),s.unbind(n.eventType),i.remove()}),i.bind("mouseenter",function(e){clearTimeout(i.data("timer")),i.css({zIndex:++t})}).bind("mouseleave",function(e){i.data("timer",setTimeout(function(){o.close(a)},n.holdon))}),null===l?s.bind(n.eventType,function(e){o._show.call(this,a,n)}).bind("mouseleave",function(){i.mouseleave()}):s.delegate(l,n.eventType,function(e){o._show.call(this,a,n)}).delegate(l,"mouseleave",function(){i.mouseleave()})},close:function(e,t){e.$dom.css("display","none")},_show:function(a,n){var i=(a.$pop,a.$dom),s=i.outerWidth(),l=i.outerHeight(),r=e(document).width(),c=e(document).height(),d=e(this===o||n.triger0?n.triger:this),u=d.offset();d.outerWidth(),d.outerHeight();clearTimeout(i.data("timer")),a.offset=[u.left+n.biasX,u.top+n.biasY];var p=a.offset[0],f=a.offset[1];a.offset[0]=p+s>r?r-s-20:p,a.offset[1]=f+l>c?c-l-20:f,i.css({left:a.offset[0],top:a.offset[1],zIndex:++t,display:"block"})},_noop:e.noop},n=e.extend(!0,{},e.fn.tippop.defaults,a);return this.each(function(){var t=e(this),a={};t.data("tippop")||(a.$pop=t,o._create(a,n),o._bind(a,n),n.loadShow&&o._show(a,n),e.isFunction(n.fnInitExe)&&n.fnInitExe.call(o,a,n),t.data("tippop",!0))}).closest("."+n.id)},e.fn.tippop.defaults={id:"",triger:null,triger0:!1,eventType:"mouseover",holdon:1e3,delegateSelector:null,width:"auto",height:"auto",biasX:0,biasY:0,loadShow:!1,fnInitExe:null,zIndex:3e3}}(jQuery),function(){$.SGAlert=$.SGAlert||{},$.SGAlert.show=function(e,t,a,o){var a=a||".mask-body:visible",n=$(a),o=o||{visibility:"hidden",position:"absolute",zIndex:999999999,width:"auto",padding:"4px 12px",margin:"4px 0 0",lineHeight:"21px",fontSize:"12px",background:"#4c4c4c",borderRadius:"4px",color:"#fff"};n.length||(n=$("body"));var i=parseInt(n.css("width"))||n.outerWidth(),s=n.find(".SGAlert-holder");s.length||(s=$('<div class="SGAlert-holder"></div>').appendTo(n)),s.css(o).html(e),window.clearTimeout(s.data("timer"));var l=s.outerWidth(),r=s.outerHeight(!0),c=200;s.css({top:-r,visibility:"visible",left:(i-l)/2}).animate({top:0,opacity:1},c),t&&t>0&&s.data("timer",window.setTimeout(function(){s.animate({top:-r,opacity:0},c,function(){s.css("visibility","hidden")})},t))},$.SGAlert.clean=function(){$(".SGAlert-holder").remove()}}(),function(){function e(){var e=$("#dt-form-login");$.ajax({type:"GET",url:"/napi/audit/",success:function(t,o){"ccode"===t.data.audit_status&&(e.find(".dt-ccode").show(),a())}})}function t(){var e=$("#dt-form-login"),t=e.serializeObject();t.remember=e.find("input[name=remember]").prop("checked"),t.next=$("#dt-login").data("next")||"/",$.ajax({type:"POST",url:"/login/",data:t,success:function(e,t){if(1===e.status&&e.data.next){var a=decodeURIComponent(e.data.next);window.location.href=a}else 1!==e.status&&(window.location.href="/login/")}})}function a(){$.ajax({type:"GET",cache:!1,url:"/captcha/",mysuccess:function(e,t){if(e.data&&e.data.img){var a=$("#dt-form-login");$(".dt-ccodepic").attr({src:e.data.img}),a.find("input[name=token]").val(e.data.id)}}})}if(SUGAR&&SUGAR.PopOut){var o=$.browser.msie,n=(o&&"6.0"===$.browser.version,o&&"7.0"===$.browser.version,o&&"8.0"===$.browser.version);o&&"9.0"===$.browser.version;$.extend(SUGAR.PopOut,{login:function(o){var i=this,s=$("#poplogin"),l=$.G.store(),r=o;r||(r=location.pathname+location.search+location.hash),s.find("[name=next]").val(r),l.length||(l=$('<div id="win-house" class="h0"></div>').appendTo("body")),s.length||(s=$('<div id="poplogin" class="win-wraper clr"><div class="login clr"><div class="cont"><form id="dt-form-login" method="POST"  action="/login/?action=login&next='+r+'" method="POST" target="_self"><div class="dt-unme cnt-i clr"><input type="text" id="p-username" name="login_name" placeholder="\u7528\u6237\u540d/\u90ae\u7bb1" /></div><div class="dt-pswd cnt-i clr"><input type="password" id="p-password" name="pswd" placeholder="\u5bc6\u7801" /></div><div class="dt-ccode cnt-i clr"><input type="text" placeholder="\u9a8c\u8bc1\u7801" name="ccode" class="ccode"><img src="" class="dt-ccodepic"></div><div class="u-chk clr"><input class="dn" name="token" value=""><input class="chk" type="checkbox" name="remember" id="poplogin-rem" value="" checked /><label for="poplogin-rem" >\u8bb0\u4f4f\u6211</label><a href="/getpasswd/" class="r">\u5fd8\u8bb0\u5bc6\u7801\uff1f</a></div><div class="submit clr"><a class="abtn l" href="javascript:;" onmousedown="$.G.gaq(\'/_trc/Login/pop/direct\');" id="loginbtn"><button type="submit" class="pg-loginbtn"><u>\u767b\u5f55</u></button></a></div></form></div><div class="sites"><div class="clr"><ul class="pg-reg"><li><a class="qqsite" href="/connect/qq/?action=login&next='+r+'" onmousedown="$.G.gaq(\'/_trc/Login/pop/connect_qq\');"><i class="pg-QQ"></i>\u4f7f\u7528QQ\u8d26\u53f7\u767b\u5f55</a></li><li><a class="weibo" href="/connect/sina/?action=login&next='+r+'" onmousedown="$.G.gaq(\'/_trc/Login/pop/connect_sina\');"><i class="pg-weibo"></i>\u4f7f\u7528\u5fae\u535a\u8d26\u53f7\u767b\u5f55</a></li><li><a class="douban" href="/connect/douban/?action=login&next='+r+'" onmousedown="$.G.gaq(\'/_trc/Login/pop/connect_douban\');"><i class="pg-douban"></i>\u4f7f\u7528\u8c46\u74e3\u8d26\u53f7\u767b\u5f55</a></li><li><a class="taobao" href="/connect/taobao/?action=login&next='+r+'" onmousedown="$.G.gaq(\'/_trc/Login/pop/connec t_taobao\');"><i class="pg-taobao"></i>\u4f7f\u7528\u6dd8\u5b9d\u8d26\u53f7\u767b\u5f55</a></li><li><a class="qweibo" href="/connect/qweibo/?action=login&next='+r+'" onmousedown="$.G.gaq(\'/_trc/Login/pop/connect_qweibo\');"><i class="pg-qqweibo"></i>\u4f7f\u7528\u817e\u8baf\u5fae\u535a\u8d26\u53f7\u767b\u5f55</a></li></ul></div></div></div><div class="toreg clr"><a href="/reg/">\u8fd8\u6ca1\u6709\u8d26\u53f7?\u7acb\u5373\u6ce8\u518c</a></div></div>'),l.append(s),$("#dt-form-login").submit(function(e){e.preventDefault(),t()}),$(document).on("click",".dt-ccodepic",function(){a()}),e());var c=$("#p-username, #p-password");if(c.length&&"undefined"==typeof c.get(0).placeholder){var d=$("#poplogin").find("i");d.css("display","block"),d.click(function(e){$(this).css("display","none"),$(this).siblings("input").focus()}),c.focusin(function(e){$(this).siblings("i").css("display","none")}),c.focusout(function(e){""==$.trim(this.value)&&$(this).siblings("i").css("display","block")}),n&&c.keydown(function(e){13==e.keyCode&&$.trim($("#p-username").val())&&$.trim($("#p-password").val())&&(e.preventDefault(),e.stopPropagation(),s.find("form").submit())})}i.alert(["\u767b\u5f55",s,""],2),$({}).delay(100).queue(function(){var e;(e=$("#p-username")[0])&&e.focus()})}})}}(),function(e){e.fn.comtags={tags:["\u5bb6\u5c45","\u8bbe\u8ba1","\u63d2\u753b","\u7535\u5f71","\u65c5\u884c","\u624b\u5de5","\u5973\u88c5","\u7537\u88c5","\u914d\u9970","\u7f8e\u98df","\u6444\u5f71","\u827a\u672f","\u5c01\u9762","\u52a8\u6f2b","\u6000\u65e7","\u8857\u62cd","\u5c0f\u5b69","\u5ba0\u7269","\u690d\u7269","\u4eba\u7269"]}}(jQuery),function(){$.SGColl=function(){var e,t,a,o,n,i,s,l,r,c,d,u,p,f,h,m,g,v,b,w,y,k,_,x,C,T={upload:"\u4e0a\u4f20\u56fe\u7247",fetch:"\u6293\u53d6\u7f51\u9875\u56fe\u7247"},S=[],j=4e3;return{type:"upload",init:function(T,S){function P(e){keyupLenLimitForU(e.currentTarget,U,!0,!0)}var I=this;if(!$.G.getUSERID())return void SUGAR.PopOut.login();if("function"!=typeof T&&(S=T,T=$.noop),k=T,S&&$.isPlainObject(S)&&(_=$.extend({},S)),_&&_.type&&(I.type=_.type),!I.inited&&(I.inited=!0,t=$("#sgcoll-up"),e=$.G.store(),C,e.length||(e=$('<div id="win-house" class="h0"></div>').appendTo("body")),!t.length)){var G='<form id="form-sgcoll-poststatus" action="/people/mblog/add/" method="post" target="_blank"><input type="hidden" id="sgcoll-sourcetitle" name="source_title" value=""/><input type="hidden" id="sgcoll-sourcelink"  name="source_link" value=""/><!-- \u56fe\u7247\u533a\u57df --> <div id="sgcoll-pics"></div><div id="sgcoll-panel"><!-- \u4e13\u8f91\u533a\u57df --> <div class="sgcoll-album"><div id="sgcoll-albumsel" class="sgcoll-albumsel"><input id="sgcoll-albumsel-v" type="text" name="album" value="" data-optional="1"/><a class="sgcoll-shw" href="javascript:;">\u9ed8\u8ba4\u4e13\u8f91</a></div></div> <!-- \u8f93\u5165\u6846 --> <div class="sgcoll-cxa"><textarea name="content" class="txa" id="sgcoll-txa" data-optional="1"></textarea><span class="sgcoll-wremain dn"><b id="sgcoll-rmn">300</b> \u5b57</span><label for="sgcoll-txa" id="sgcoll-txa-lb">\u5199\u70b9\u4ecb\u7ecd\uff0c\u8ba9\u66f4\u591a\u4eba\u559c\u6b22ta</label></div> <!-- \u6807\u7b7e\u533a\u57df --> <div class="sgcoll-tags-wrp"><div id="sgcoll-tags-add" class="da tag-sel-cnt tag-use-cnt clr"><input id="sgcoll-tags-inp" class="tag-edt-ipt" autocomplete="off" type="text" value="" maxlength="20" /></div><label for="sgcoll-tags-inp" id="sgcoll-tags-lb"><i>&nbsp;</i>\u6dfb\u52a0\u9002\u5408\u7684\u6807\u7b7e\uff0c\u65b9\u4fbf\u5927\u5bb6\u627e\u5230</label><button class="dn" id="dopost-tags-reset" type="button" /><div class="tag-use-cnt tag-def-cnt da" id="sgcoll-tags-sel"><span id="sgcoll-tags-cls"><span>\u5173\u95ed</span></span><span class="tag-use-desc">\u70ed\u95e8\u6807\u7b7e\uff1a</span></div></div> <!-- \u53d1\u5e03\u6309\u94ae --> <div id="sgcoll-subarea" class="u-chk clr"><a class="abtn l" href="javascript:;" target="_self"><button id="sgcoll-abtnpost" type="submit"><u>\u53d1\u5e03</u></button></a><input type="checkbox" name="syncpost" class="chk s-sina dn" value="sina" id="sgcoll-sync"><label for="sgcoll-sync" title="\u540c\u6b65\u5230\u65b0\u6d6a\u5fae\u535a" class="s-sina dn" >\u540c\u6b65</label><div class="sgcoll-mbsite s-sina dn">\u65b0\u6d6a</div><div id="sgcoll-poststat"></div></div></div><input id="sgcoll-tags-val" type="hidden" name="tags" value=""/><input type="hidden" name="source" value=""/><input type="hidden" value="" name="" id="sgcoll-imgcont" /><input id="sgcoll-grpid" type="hidden" name="group" value/></form>';t=$('<div id="sgcoll-up"><div id="sgcoll-fetch-in" class="dn clr"><div class="sgcoll-dragdr"><a href="/about/collectit/?from=postbg" target="_blank">\u4f7f\u7528\u5806\u7cd6\u6536\u96c6\u5de5\u5177\uff0c\u6293\u53d6\u56fe\u7247\u66f4\u7b80\u5355 &gt;</a></div><div class="sgcoll-drgbox"><div class="gray sgcoll-fetch-normal" id="sgcoll-fchk">\u5c06\u56fe\u7247\u6240\u5728\u9875\u9762\u7f51\u5740\u5b8c\u6574\u5730\u7c98\u8d34\u5230\u8fd9\u91cc</div><form id="form-sgcoll-fetchpic" class="sgcoll-fetch-normal" action="/mblog/fetch/" method="post" target="_self"><input type="text" value="http://" autocomplete="off" class="ipt" name="url" id="sgcoll-fipt"><div class="tc"><a target="_self" href="javascript:;" class="abtn dib" id="sgcoll-fchab"><button type="submit"><u>\u786e\u5b9a</u></button></a></div></form><div id="sgcoll-fetching" class="l loading3 dn">\u6b63\u5728\u6293\u53d6<br/><a id="sgcoll-fetch-cancel" class="lkl" href="javascript:;">\u53d6\u6d88</a></div></div></div><div id="sgcoll-up-in" class="dn clr"><div id="sgcoll-dropimgcov">\u62d6\u62fd\u56fe\u7247\u5230\u8fd9\u91cc\u53ef\u76f4\u63a5\u4e0a\u4f20</div><div id="sgcoll-dropimg" class="sgcoll-dbox"><a id="sgcoll-upbtn" href="javascript:;" class="abtn abtn-up dib sgcoll-up-normal"><u><i></i>\u4e0a\u4f20\u56fe\u7247</u><form id="form-sgcoll-upic" target="alupifr" enctype="multipart/form-data" method="POST" action="/upload/photo/"><input name="img" hidefocus="true" type="file" /><input type="hidden" name="tid" value=""/><input type="hidden" name="callback" value="$.fn.uploadpic.upPicCallBack"><iframe name="alupifr" src="about:blank" class="dn" scrolling="no" frameborder="0" height="0" width="0"></iframe><input type="hidden" name="type" value="blog"/></form></a><div id="sgcoll-up-mess" class="sgcoll-up-normal">\u56fe\u7247\u9700\u5c0f\u4e8e10M\uff1b\u5982\u6709\u6765\u6e90\uff0c\u8bf7\u6ce8\u660e</div><div id="sgcoll-uploading" class="l loading3 dn">\u6b63\u5728\u4e0a\u4f20<br/><a id="sgcoll-up-cancel" class="uploadpic-delthepic lkl" href="javascript:;">\u53d6\u6d88</a></div></div></div><div id="sgcoll-uploaded" class="dn">'+G+"</div></div>").appendTo(e),o=$("#form-sgcoll-fetchpic"),n=$("#sgcoll-fipt"),i=$("#sgcoll-pics"),s=$("#sgcoll-uploaded"),l=$("#sgcoll-txa"),r=$("#sgcoll-txa-lb"),c=$("#sgcoll-imgcont"),d=$("#sgcoll-tags-add"),u=$("#sgcoll-tags-val"),p=$("#sgcoll-tags-inp"),f=$("#sgcoll-tags-lb"),h=$("#sgcoll-tags-sel"),m=$("#sgcoll-tags-cls").find("span"),g=$("#dopost-tags-reset"),v=$("#sgcoll-albumsel"),b=$("#sgcoll-subarea"),w=$("#form-sgcoll-poststatus"),y=$("#sgcoll-abtnpost"),C,"undefined"!=typeof BIND_SITES&&BIND_SITES.sina?b.find(".s-sina").removeClass("dn"):b.find(".s-sina").remove(),I.resetType(I.type,!0);var A=!(!$.browser.webkit||!navigator.userAgent.toString().match("Chrome"));if(A&&window.File&&window.FileList){var D=$("#sgcoll-dropimg,#sgcoll-dropimgcov");D.bind("dragenter",function(e){"Files"===e.originalEvent.dataTransfer.types.toString()&&(window.clearTimeout(D.data("timer")),D.css("backgroundPosition","0 -300px"),$("#sgcoll-dropimgcov").css("display","block"))}).bind("dragleave",function(e){window.clearTimeout(D.data("timer")),D.eq(0).data("timer",window.setTimeout(function(){D.css("backgroundPosition","0 0"),$("#sgcoll-dropimgcov").css("display","none")},100))}).bind("dragover",function(e){e.preventDefault(),e.stopPropagation(),window.clearTimeout(D.data("timer"))}).bind("drop",function(e){e.preventDefault(),e.stopPropagation(),$("#sgcoll-dropimgcov").css("display","none");var t=e.originalEvent.dataTransfer.files;if(t.length){var a=$("#form-sgcoll-upic input[type=file]").get(0);a.files=t}})}o.submit(function(e){e.preventDefault(),$.SGColl.doFetchPic()}),$("#sgcoll-fetch-cancel").click(function(e){e.preventDefault(),$.SGColl.resetFetch()}),n.focus(function(e){var t=this;$.browser.webkit?setTimeout(function(){t.select()},10):t.select()}),$("#sgcoll-upbtn").uploadpic(function(e,t,a){e.success?($.G.gaq("/_trc/Post/_/uppicok"),$.SGColl.resetPost(),i.html('<img id="sgcoll-upimg" data-iid="'+e.picid+'" src="'+$.G.dtImageTrans(e.src,!0,120,120,"c")+'" />'),c.val(e.picid),$("#sgcoll-up-in").addClass("dn"),$.SGColl.repop(),_.tags&&(p.val(_.tags),f.css("display","none"))):($.SGAlert.show(e.message,j),$.SGColl.resetFile(),$("#sgcoll-upbtn,#sgcoll-up-mess").removeClass("dn"))},{onupload:function(){$.G.gaq("/_trc/Post/_/uppicsubmit"),$.SGAlert.clean()},sel_holder:"#sgcoll-up",sel_form:"#form-sgcoll-upic",sel_normal:".sgcoll-up-normal",sel_uploading:"#sgcoll-uploading",sel_uploaded:"#sgcoll-uploaded"}),$("#sgcoll-up-cancel").click(function(e){t.find("input[name=tid]").data("uploadpic-tid","")}),a=$("#sgcoll-albumsel").find("a").myalbums({sel_valueipt:$("#sgcoll-albumsel-v"),sel_holder:$("#sgcoll-uploaded")}),mblogTagsInit(["#sgcoll-tags-add",null,null,"#sgcoll-tags-sel","#sgcoll-tags-inp","#dopost-tags-reset",""]),l.bind("focus click",function(e){e.stopPropagation(),$.SGColl.showLabel(this,"#sgcoll-txa-lb",!0)}).blur(function(){$.SGColl.showLabel(this,"#sgcoll-txa-lb")});var U=300;l.keyup(P).blur(P).focus(P),keyupLenLimitForU(l[0],U,!0,!0),l.keydown(function(e){e.metaKey&&13==e.which&&w.submit()}),$.fn.at&&l.at({isFixed:!0,upper:!0}),p.bind("focus click",function(e){e.stopPropagation(),window.clearTimeout(x),$.SGColl.showTagLabel(d,f,!0)}).blur(function(e){x=window.setTimeout(function(){$.SGColl.showTagLabel(d,f)},100)}),p.bind("focus",function(e){$.browser.msie&&"6.0"===$.browser.version?(h.css({display:"block",visibility:"hidden"}),h.css({top:-h.outerHeight()+1,bottom:"auto",visibility:"visible"})):h.css({top:"auto",bottom:d.outerHeight()-1,display:"block"})}),m.add($(document)).click(function(){h.css("display","none")}),d.add(h).click(function(e){e.stopPropagation()}),w.submit(function(e){e.preventDefault(),$.SGColl.doPost()})}I.resetType(I.type,!0),I.repop()},repop:function(){if(SUGAR.PopOut.alert([T[this.type],t,""],"m"),n.filter(":visible").length){var e=n.val();n.focus().val("").val(e).focus()}},checkFetchUrl:function(e){if($.G.isLink(e)){var t=e.split("://")[1].split("/")[0];return t.match(/\bduitang\.com/gi)?($.SGAlert.show("\u4ec5\u652f\u6301\u5916\u7ad9\u7f51\u5740\uff0c\u7ad9\u5185\u8bf7\u76f4\u63a5\u6536\u96c6",j),!1):!0}return $.SGAlert.show("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f51\u5740",j),!1},isPicUrl:function(e){var t=e.lastIndexOf("."),a=t>-1?e.substr(t+1):"";return a&&a.match(/^(jpg|png|gif)$/gi)?!0:!1},doFetchPic:function(){var e=this;$.G.gaq("/_trc/Post/_/dofetch"),$.SGAlert.clean();var t=$.trim(n.val());return t.match(/^http(?:s)?:\/\//gi)||(t="http://"+t,n.val(t)),t=taobaoThumbPic(t),e.isPicUrl(t)?void e.afterFetch(t,!0):void(e.checkFetchUrl(t)&&(n.blur(),$("#sgcoll-fetching").removeClass("dn"),$("#sgcoll-fetch-in").find(".sgcoll-fetch-normal").addClass("dn"),$.ajax({url:o.getFormAction(),data:o.paramForm(getToken(2)),mysuccess:function(a,o){$("#sgcoll-fetch-cancel:visible").length&&e.afterFetch(t,!1,a.data)},myfailure:function(t,a){$("#sgcoll-fetch-cancel:visible").length&&(e.resetFetch(),$.SGAlert.show(mergeServerMessage(t.message),j))},myerror:function(){e.resetFetch(),$.SGAlert.show("\u7f51\u7edc\u51fa\u95ee\u9898\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",j)}})))},afterFetch:function(e,t,a){var o=this;t&&(a={images:[e],title:"\u56fe\u7247"});var n=a.images;if(n.length){i.data("choose")||i.data("choose",!0).delegate(".vm","click",function(e){e.stopPropagation(),e.preventDefault();var t=$(this);i.find(".cur").removeClass("cur"),c.val(t.addClass("cur").find("img").attr("src"))}),o.resetPost(),$("#sgcoll-sourcelink").val(e),$("#sgcoll-sourcetitle").val(a.title);var s=n.length<10?n.length:10;i.html(['<div class="sgcoll-finfo"><div><span>\u6765\u6e90\uff1a</span>'+a.title.cut(60,"\u2026")+"</div><div><span>\u94fe\u63a5\uff1a</span>"+e.cut(60,"\u2026")+'</div></div><div id="sgcoll-picselect" class="sgcoll-picselect" ',s>3?'style="overflow-x:scroll;"':"",'><div class="sgcoll-piclist clr" style="width:',147*s-13,'px;"><!-- \u5faa\u73af\u5355\u5143\u5f00\u59cb -->',function(){for(var e="",t=0;s>t;t++){var a=n[t],a="/"===a.charAt(0)?"http://"+window.location.hostname+a:a;e+='<div class="vm ct l '+(t===s-1?"last":"")+" "+(0===t?"cur":"")+'"><div class="vma"><div class="vmb"> <img src="'+a+'" /></div></div></div>'}return e}(),"<!-- \u5faa\u73af\u5355\u5143\u7ed3\u675f --></div></div>"].join("")),$("#sgcoll-picselect").scrollTop(0),c.val(i.find("img:first").attr("src")),$("#sgcoll-fetch-in").addClass("dn"),$("#sgcoll-uploaded").removeClass("dn"),o.repop(),_.tags&&(p.val(_.tags),f.css("display","none")),$.G.gaq("/_trc/Post/_/dofetchok")}else o.resetFetch(),$.SGAlert.show("\u5f88\u62b1\u6b49\uff0c\u672a\u80fd\u6293\u53d6\u5230\u5408\u9002\u56fe\u7247",j)},doPost:function(){var e=this;if(!l.val())return void $.G.blinkIt(function(){l.css({backgroundColor:"#ffffcc"})},function(){l.css({backgroundColor:"transparent"})},function(){l.focus()},4,200);c.val()||$.SGAlert.show("\u6ca1\u6709\u56fe\u7247\u65e0\u6cd5\u53d1\u5e03\u54df",j);var t=y.closest(".abtn");if(!t.hasClass("abtn-no")){t.addClass("abtn-no"),$.SGAlert.show("\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019"),0===window.location.pathname.indexOf("/collect/")?$.G.gaq("/_trc/Post/_/dopost_outside"):$.G.gaq("/_trc/Post/_/dopost");var a=[],o=$.trim(p.val());d.find(".added-tag").each(function(e,t){var o=$(t);a.push($.trim(o.text()))}),-1===$.inArray(o,a)&&a.push(o),u.val(a.join(" ")),$.ajax({url:w.getFormAction(),data:w.paramForm(getToken(2)),mysuccess:function(t,a){$.G.gaq("/_trc/Post/_/dopostok");var o=v.find("[name=album]").val(),n=v.find(".sgcoll-shw").html();o&&"0"!=o&&($.Bom.removeCookie("sgt"),$.Bom.setSubCookie("sgt","ai"+$.G.getUSERID(),o,{expires:30}),$.Bom.setSubCookie("sgt","an"+$.G.getUSERID(),n,{expires:30})),S.unshift({id:t.data.id,val:l.val().cut(10,"\u2026")}),S=S.slice(0,5);var i=o&&"0"!=o?"/album/"+o+"/":"/album/people/"+$.G.getUSERID()+"/",s="upload"===e.type?'<a id="sgcoll-continue" href="javascript:;">\u7ee7\u7eed\u4e0a\u4f20</a><span>&nbsp;|&nbsp;</span><a href="/about/collectit/?from=postup" target="_blank">\u4f7f\u7528\u5806\u7cd6\u6536\u96c6\u5de5\u5177</a>':'<a href="/about/collectit/?from=postcoll" target="_blank">\u5b89\u88c5\u7cd6\u6536\u96c6\u5de5\u5177, \u5e2e\u4f60\u8f7b\u677e\u4fdd\u5b58\u56fe\u7247</a>',r='<div id="sgcoll-over"><div class="prompt prompt-success"><h3>\u6536\u96c6\u6210\u529f\uff01<a href="'+i+'" target="_blank">\u8fdb\u5165\u4e13\u8f91\u67e5\u770b &gt;</a></h3><p></p></div><div class="sgcoll-over-bot lkl"><span>\u6216\uff1a</span>'+s+"</div></div>";if(SUGAR.PopOut.alert([T[e.type],r,""],"m"),$("#sgcoll-continue").click(function(t){e.resetType(e.type,!0),e.repop()}),$.isFunction(k))k(t);else if($("#dymcare").length){var c=$.History.getHash();""!=c&&"!dym"!=c?$.History.setHash("!dym"):$("#dymcare").click()}},myfailure:function(e,t){var a=mergeServerMessage(e.message);
$.G.gaq("/_trc/Post/_/"+a),$.SGAlert.show(a)},myerror:function(){$.SGAlert.show("\u7f51\u7edc\u51fa\u95ee\u9898\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}}).always(function(){t.removeClass("abtn-no")})}},showLabel:function(e,t,a){var o=$(e),n=$(t);n.css("display",""!==$.trim(o.val())||a?"none":"block")},showTagLabel:function(e,t,a){var o=$(e),n=o.find("input"),i=$(t);i.css("display",o.find(".added-tag").length||$.trim(n.val())||a?"none":"block")},resetPost:function(){var e=this;i.html(""),l.val(""),r.css("display","block"),d.find(".added-tag").remove(),u.val(""),p.val(""),f.css("display","block"),h.find(".locked").removeClass("locked"),$("#sgcoll-sourcetitle").val(""),$("#sgcoll-sourcelink").val(""),"upload"===e.type?c.attr("name","photo_id"):"fetch"===e.type&&c.attr("name","image_src"),c.val(""),w.find("[name=source]").attr("value",e.type),g.click()},resetType:function(e,t){var a=this;"upload"===e?a.resetUpload():"fetch"===e&&a.resetFetch(t)},resetFetch:function(e){this.type="fetch",$("#sgcoll-up-in,#sgcoll-uploaded,#sgcoll-fetching").addClass("dn"),$("#sgcoll-fetch-in").removeClass("dn").find(".sgcoll-fetch-normal").removeClass("dn"),e&&n.val("http://")},resetUpload:function(){this.type="upload",$("#sgcoll-fetch-in,#sgcoll-uploaded,#sgcoll-uploading").addClass("dn"),$("#sgcoll-up-in,#sgcoll-upbtn,#sgcoll-up-mess").removeClass("dn abtn-no"),this.resetFile()},resetFile:function(){var e=$("#form-sgcoll-upic input[type=file]");e.after(e.clone(!0).val("")),e.remove()}}}()}(),$(function(){}),$(function(){function e(){var e=$("#popcreatealbum");e.length||(e=$('<div id="popcreatealbum" class="popcreatealbum"> <form id="form-popcreatealbum" method="post" action="/album/add/"> <table cellspacing="0" cellpadding="0"> <tr> <td width="60" align="right">\u4e13\u8f91\u540d</td> <td><input class="ipt" type="text" name="name" value="" maxlength="40"/></td> <td rowspan="4"> <h6>\u5e38\u7528\u6807\u7b7e</h6> <div class="usetag da" id="popal-mbaddtagsel"> </div> </td> </tr> <tr> <td align="right">\u63cf\u8ff0</td> <td><textarea class="txa" name="desc" maxlength="600" data-optional="1"></textarea></td> </tr> <tr> <td align="right">\u6807\u7b7e</td> <td> <div class="pr"> <div class="divipt clr"><input id="popal-mbaddtagipt" class="l ipt mr8" autocomplete="off" type="text" name="tags" value=""  maxlength="100" data-optional="1"/></div> <label for="popal-mbaddtagipt" id="popal-mbaddtag-lb">\u591a\u4e2a\u6807\u7b7e\u7528\u7a7a\u683c\u9694\u5f00</label> </div> </td> </tr> <tr> <td>&nbsp;</td> <td><a class="abtn l" href="javascript:;" target="_self"><button type="submit"><u>\u521b\u5efa</u></button></a></td> </tr> </table> </form> </div>').appendTo(o),$.fn.comtags&&$("#popal-mbaddtagsel").html(function(){for(var e="",t=$.fn.comtags.tags,a=0;a<t.length;a++)e+='<a href="#">'+t[a]+"</a>";return e}),tagSelectBind("#popal-mbaddtagsel","#popal-mbaddtagipt",5),setLabelIptFocus("#popal-mbaddtagipt","#popal-mbaddtag-lb"),e.find("[name=name],[name=desc]").lengthLimit(),$("#form-popcreatealbum").safeSubmit(function(e){if($.G.getUSERID()){var t=$(this),a=t.find("a.abtn"),o=a.find("[type=submit]");a.hasClass("abtn-no")||(a.addClass("abtn-no"),$.ajax({url:t.getFormAction(),data:t.paramForm($.G.getToken(2)),mysuccess:function(e,t){location.href="/album/"+e.data.id},myfailure:function(e,t){e.data&&e.data.robot_check?o.verif({w:1}):this.wrongmsg(e)},myerror:function(){this.errormsg()}}).always(function(){a.removeClass("abtn-no")}))}})),e.find("[name=name],[name=desc]").val(""),SUGAR.PopOut.alert(["\u521b\u5efa\u4e13\u8f91",e,""],2)}function t(e){var t=$("#popalbumblock"),a="pass"===e?"\u89e3\u5c4f":"\u5c4f\u853d",i="pass"===e?"/operate/audit/unblock_album/":"/operate/audit/block_album/";t.length?(t.find("form").attr("action",i),t.find(".albumbock-sw").text(a)):(t=$('<div id="popalbumblock" class="prompt"><form id="form-albumblock" method="post" action="'+i+'"><p class="albumconfirm" >\u5c06<span class="albumbock-sw">'+a+'</span>\u8be5\u4e13\u8f91\u4ee5\u53ca\u5176\u4e2d\u7684\u56fe\u7247\u3002</p><div class="album-pop-action clr"><a class="abtn abtn-w4 l" href="javascript:;" target="_self"><button type="submit"><u>\u786e\u5b9a<span class="albumbock-sw">'+a+"</span></u></button></a></div></form></div>").appendTo(o),$("#form-albumblock").delegate(".cancel","click",function(e){SUGAR.PopOut.closeMask(0)}),$("#form-albumblock").safeSubmit(function(e){if($.G.getUSERID()){var t=$(this),a=t.find('button[type="submit"]').closest(".abtn");a.hasClass("abtn-no")||(a.addClass("abtn-no"),$.ajax({type:"POST",cache:!1,url:t.getFormAction(),data:{album_id:n.title},mysuccess:function(e){var t=$(n).closest(".woo");t.length&&($(n).hasClass("ohblocked")?$(n).removeClass("ohblocked").text("\u5c4f\u853d"):$(n).addClass("ohblocked").text("\u89e3\u5c4f")),$("#albumblockbtn").length&&n.title==$("#albumblockbtn").attr("title")}}).always(function(){SUGAR.PopOut.closeMask(),a.removeClass("abtn-no")}))}})),SUGAR.PopOut.alert([a+"\u4e13\u8f91",t,""])}function a(){var e=$("#popalbumdel");e.length||(e=$('<div id="popalbumdel" class="prompt"><form id="form-albumdel" method="post" action="/album/delete/"><p class="albumconfirm" >\u5c06\u5220\u9664\u8be5\u4e13\u8f91\u4ee5\u53ca\u5176\u4e2d\u7684\u56fe\u7247\u3002</p><div class="album-pop-action clr"><a class="abtn abtn-w4 l" href="javascript:;" target="_self"><button type="submit"><u>\u786e\u5b9a\u5220\u9664</u></button></a></div></form></div>').appendTo(o),$("#form-albumdel").delegate(".cancel","click",function(e){SUGAR.PopOut.closeMask(0)}),$("#form-albumdel").safeSubmit(function(e){if($.G.getUSERID()){var t=$(this),a=t.find('button[type="submit"]').closest(".abtn");a.hasClass("abtn-no")||(a.addClass("abtn-no"),$.ajax({cache:!1,url:t.getFormAction()+n.title+"/",data:t.paramForm(getToken(2)),mysuccess:function(e){SUGAR.PopOut.alert('<div class="prompt prompt-success"><h3>\u5220\u9664\u6210\u529f\uff01</h3></div>'),$("#albumdelbtn").length&&n.title==$("#albumdelbtn").attr("title")?$({}).delay(1e3).queue(function(){SUGAR.PopOut.closeMask(0);var e="/people/"+$.G.getUSERID()+"/#album",t=$("#ppuserlnk");t.length&&(e=t.attr("href")),window.location.href=e}):($({}).delay(1e3).queue(function(){SUGAR.PopOut.closeMask(0)}),$(n).closest("div.woo").remove())}}).always(function(){a.removeClass("abtn-no")}))}})),SUGAR.PopOut.alert(["\u5220\u9664\u4e13\u8f91",e,""])}var o=$.G.store();$(document).delegate("#mynavtools-create,#createalbum-pp,#createalbum","click",function(t){e()});var n=null;$("#woo-holder").delegate("a.blockthisalbum","click",function(e){var a=$(this),o=a.hasClass("ohblocked")?"pass":"blocked";e.preventDefault(),n=this,t(o)}),$("#woo-holder").delegate("a.delthisalbum","click",function(e){e.preventDefault(),n=this,a()}),$("#albumdelbtn").click(function(e){e.preventDefault(),n=this,a()})}),$(function(){function e(e){var t=e||window.event,a=[].slice.call(arguments,1),o=0,n=0,i=0;return e=$.event.fix(t),e.type="mousewheel",t.wheelDelta&&(o=t.wheelDelta/120),t.detail&&(o=-t.detail/3),i=o,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(i=0,n=-1*o),void 0!==t.wheelDeltaY&&(i=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(n=-1*t.wheelDeltaX/120),a.unshift(e,o,n,i),($.event.dispatch||$.event.handle).apply(this,a)}var t=["DOMMouseScroll","mousewheel"];if($.event.fixHooks)for(var a=t.length;a;)$.event.fixHooks[t[--a]]=$.event.mouseHooks;$.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=t.length;a;)this.addEventListener(t[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=t.length;a;)this.removeEventListener(t[--a],e,!1);else this.onmousewheel=null}},$.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),$(function(){$.fn.jScrollPane=function(e){function t(e,t){function a(t){var n,s,r,c,d,f,h=!1,m=!1;if(H=t,void 0===L)d=e.scrollTop(),f=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),q=e.innerWidth()+ve,E=e.innerHeight(),e.width(q),L=$('<div class="jspPane" />').css("padding",ge).append(e.children()),B=$('<div class="jspContainer" />').css({width:q+"px",height:E+"px"}).append(L).appendTo(e);else{if(e.css("width",""),h=H.stickToBottom&&T(),m=H.stickToRight&&S(),c=e.innerWidth()+ve!=q||e.outerHeight()!=E,c&&(q=e.innerWidth()+ve,E=e.innerHeight(),B.css({width:q+"px",height:E+"px"})),!c&&be==z&&L.outerHeight()==N)return void e.width(q);be=z,L.css("width",""),e.width(q),B.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}L.css("overflow","auto"),z=t.contentWidth?t.contentWidth:L[0].scrollWidth,N=L[0].scrollHeight,L.css("overflow",""),W=z/q,Y=N/E,X=Y>1,V=W>1,V||X?(e.addClass("jspScrollable"),n=H.maintainPosition&&(J||te),n&&(s=x(),r=C()),o(),i(),l(),n&&(k(m?z-q:s,!1),y(h?N-E:r,!1)),G(),j(),M(),H.enableKeyboardNavigation&&D(),H.clickOnTrack&&u(),F(),H.hijackInternalLinks&&O()):(e.removeClass("jspScrollable"),L.css({top:0,left:0,width:B.width()-ve}),P(),A(),U(),p()),H.autoReinitialise&&!me?me=setInterval(function(){a(H)},H.autoReinitialiseDelay):!H.autoReinitialise&&me&&clearInterval(me),d&&e.scrollTop(0)&&y(d,!1),f&&e.scrollLeft(0)&&k(f,!1),e.trigger("jsp-initialised",[V||X])}function o(){X&&(B.append($('<div class="jspVerticalBar" />').append($('<div class="jspCap jspCapTop" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragTop" />'),$('<div class="jspDragBottom" />'))),$('<div class="jspCap jspCapBottom" />'))),ae=B.find(">.jspVerticalBar"),oe=ae.find(">.jspTrack"),Q=oe.find(">.jspDrag"),H.showArrows&&(le=$('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",c(0,-1)).bind("click.jsp",I),re=$('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",c(0,1)).bind("click.jsp",I),H.arrowScrollOnHover&&(le.bind("mouseover.jsp",c(0,-1,le)),re.bind("mouseover.jsp",c(0,1,re))),r(oe,H.verticalArrowPositions,le,re)),ie=E,B.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ie-=$(this).outerHeight()}),Q.hover(function(){Q.addClass("jspHover")},function(){Q.removeClass("jspHover")}).bind("mousedown.jsp",function(e){$("html").bind("dragstart.jsp selectstart.jsp",I),Q.addClass("jspActive");var t=e.pageY-Q.position().top;return $("html").bind("mousemove.jsp",function(e){h(e.pageY-t,!1)}).bind("mouseup.jsp mouseleave.jsp",f),!1}),n())}function n(){oe.height(ie+"px"),J=0,ne=H.verticalGutter+oe.outerWidth(),L.width(q-ne-ve);try{0===ae.position().left&&L.css("margin-left",ne+"px")}catch(e){}}function i(){V&&(B.append($('<div class="jspHorizontalBar" />').append($('<div class="jspCap jspCapLeft" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragLeft" />'),$('<div class="jspDragRight" />'))),$('<div class="jspCap jspCapRight" />'))),ce=B.find(">.jspHorizontalBar"),de=ce.find(">.jspTrack"),Z=de.find(">.jspDrag"),H.showArrows&&(fe=$('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",c(-1,0)).bind("click.jsp",I),he=$('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",c(1,0)).bind("click.jsp",I),H.arrowScrollOnHover&&(fe.bind("mouseover.jsp",c(-1,0,fe)),he.bind("mouseover.jsp",c(1,0,he))),r(de,H.horizontalArrowPositions,fe,he)),Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(e){$("html").bind("dragstart.jsp selectstart.jsp",I),Z.addClass("jspActive");var t=e.pageX-Z.position().left;return $("html").bind("mousemove.jsp",function(e){g(e.pageX-t,!1)}).bind("mouseup.jsp mouseleave.jsp",f),!1}),ue=B.innerWidth(),s())}function s(){B.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ue-=$(this).outerWidth()}),de.width(ue+"px"),te=0}function l(){if(V&&X){var e=de.outerHeight(),t=oe.outerWidth();ie-=e,$(ce).find(">.jspCap:visible,>.jspArrow").each(function(){ue+=$(this).outerWidth()}),ue-=t,E-=t,q-=e,de.parent().append($('<div class="jspCorner" />').css("width",e+"px")),n(),s()}V&&L.width(B.outerWidth()-ve+"px"),N=L.outerHeight(),Y=N/E,V&&(pe=Math.ceil(1/W*ue),pe>H.horizontalDragMaxWidth?pe=H.horizontalDragMaxWidth:pe<H.horizontalDragMinWidth&&(pe=H.horizontalDragMinWidth),Z.width(pe+"px"),ee=ue-pe,v(te)),X&&(se=Math.ceil(1/Y*ie),se>H.verticalDragMaxHeight?se=H.verticalDragMaxHeight:se<H.verticalDragMinHeight&&(se=H.verticalDragMinHeight),Q.height(se+"px"),K=ie-se,m(J))}function r(e,t,a,o){var n,i="before",s="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==i?s=t:t==s&&(i=t,n=a,a=o,o=n),e[i](a)[s](o)}function c(e,t,a){return function(){return d(e,t,this,a),this.blur(),!1}}function d(e,t,a,o){a=$(a).addClass("jspActive");var n,i,s=!0,l=function(){0!==e&&$e.scrollByX(e*H.arrowButtonSpeed),0!==t&&$e.scrollByY(t*H.arrowButtonSpeed),i=setTimeout(l,s?H.initialDelay:H.arrowRepeatFreq),s=!1};l(),n=o?"mouseout.jsp":"mouseup.jsp",o=o||$("html"),o.bind(n,function(){a.removeClass("jspActive"),i&&clearTimeout(i),i=null,o.unbind(n)})}function u(){p(),X&&oe.bind("mousedown.jsp",function(e){if(void 0===e.originalTarget||e.originalTarget==e.currentTarget){var t,a=$(this),o=a.offset(),n=e.pageY-o.top-J,i=!0,s=function(){var o=a.offset(),r=e.pageY-o.top-se/2,c=E*H.scrollPagePercent,d=K*c/(N-E);if(0>n)J-d>r?$e.scrollByY(-c):h(r);else{if(!(n>0))return void l();r>J+d?$e.scrollByY(c):h(r)}t=setTimeout(s,i?H.initialDelay:H.trackClickRepeatFreq),i=!1},l=function(){t&&clearTimeout(t),t=null,$(document).unbind("mouseup.jsp",l)};return s(),$(document).bind("mouseup.jsp",l),!1}}),V&&de.bind("mousedown.jsp",function(e){if(void 0===e.originalTarget||e.originalTarget==e.currentTarget){var t,a=$(this),o=a.offset(),n=e.pageX-o.left-te,i=!0,s=function(){var o=a.offset(),r=e.pageX-o.left-pe/2,c=q*H.scrollPagePercent,d=ee*c/(z-q);if(0>n)te-d>r?$e.scrollByX(-c):g(r);else{if(!(n>0))return void l();r>te+d?$e.scrollByX(c):g(r)}t=setTimeout(s,i?H.initialDelay:H.trackClickRepeatFreq),i=!1},l=function(){t&&clearTimeout(t),t=null,$(document).unbind("mouseup.jsp",l)};return s(),$(document).bind("mouseup.jsp",l),!1}})}function p(){de&&de.unbind("mousedown.jsp"),oe&&oe.unbind("mousedown.jsp")}function f(){$("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Q&&Q.removeClass("jspActive"),Z&&Z.removeClass("jspActive")}function h(e,t){X&&(0>e?e=0:e>K&&(e=K),void 0===t&&(t=H.animateScroll),t?$e.animate(Q,"top",e,m):(Q.css("top",e),m(e)))}function m(t){void 0===t&&(t=Q.position().top),B.scrollTop(0),J=t;var a=0===J,o=J==K,n=t/K,i=-n*(N-E);(we!=a||ke!=o)&&(we=a,ke=o,e.trigger("jsp-arrow-change",[we,ke,ye,_e])),b(a,o),L.css("top",i),e.trigger("jsp-scroll-y",[-i,a,o]).trigger("scroll")}function g(e,t){V&&(0>e?e=0:e>ee&&(e=ee),void 0===t&&(t=H.animateScroll),t?$e.animate(Z,"left",e,v):(Z.css("left",e),v(e)))}function v(t){void 0===t&&(t=Z.position().left),B.scrollTop(0),te=t;var a=0===te,o=te==ee,n=t/ee,i=-n*(z-q);(ye!=a||_e!=o)&&(ye=a,_e=o,e.trigger("jsp-arrow-change",[we,ke,ye,_e])),w(a,o),L.css("left",i),e.trigger("jsp-scroll-x",[-i,a,o]).trigger("scroll")}function b(e,t){H.showArrows&&(le[e?"addClass":"removeClass"]("jspDisabled"),re[t?"addClass":"removeClass"]("jspDisabled"))}function w(e,t){H.showArrows&&(fe[e?"addClass":"removeClass"]("jspDisabled"),he[t?"addClass":"removeClass"]("jspDisabled"))}function y(e,t){var a=e/(N-E);h(a*K,t)}function k(e,t){var a=e/(z-q);g(a*ee,t)}function _(e,t,a){var o,n,i,s,l,r,c,d,u,p=0,f=0;try{o=$(e)}catch(h){return}for(n=o.outerHeight(),i=o.outerWidth(),B.scrollTop(0),B.scrollLeft(0);!o.is(".jspPane");)if(p+=o.position().top,f+=o.position().left,o=o.offsetParent(),/^body|html$/i.test(o[0].nodeName))return;s=C(),r=s+E,s>p||t?d=p-H.horizontalGutter:p+n>r&&(d=p-E+n+H.horizontalGutter),isNaN(d)||y(d,a),l=x(),c=l+q,l>f||t?u=f-H.horizontalGutter:f+i>c&&(u=f-q+i+H.horizontalGutter),isNaN(u)||k(u,a)}function x(){return-L.position().left}function C(){return-L.position().top}function T(){var e=N-E;return e>20&&e-C()<10}function S(){var e=z-q;return e>20&&e-x()<10}function j(){B.unbind(Ce).bind(Ce,function(e,t,a,o){var n=te,i=J,s=e.deltaFactor||H.mouseWheelSpeed;return $e.scrollBy(a*s,-o*s,!1),n==te&&i==J})}function P(){B.unbind(Ce)}function I(){return!1}function G(){L.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){_(e.target,!1)})}function A(){L.find(":input,a").unbind("focus.jsp")}function D(){function t(){var e=te,t=J;switch(a){case 40:$e.scrollByY(H.keyboardSpeed,!1);break;case 38:$e.scrollByY(-H.keyboardSpeed,!1);break;case 34:case 32:$e.scrollByY(E*H.scrollPagePercent,!1);break;case 33:$e.scrollByY(-E*H.scrollPagePercent,!1);break;case 39:$e.scrollByX(H.keyboardSpeed,!1);break;case 37:$e.scrollByX(-H.keyboardSpeed,!1)}return o=e!=te||t!=J}var a,o,n=[];V&&n.push(ce[0]),X&&n.push(ae[0]),L.focus(function(){e.focus()}),e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||n.length&&$(e.target).closest(n).length){var i=te,s=J;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:a=e.keyCode,t();break;case 35:y(N-E),a=null;break;case 36:y(0),a=null}return o=e.keyCode==a&&i!=te||s!=J,!o}}).bind("keypress.jsp",function(e){return e.keyCode==a&&t(),!o}),H.hideFocus?(e.css("outline","none"),"hideFocus"in B[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in B[0]&&e.attr("hideFocus",!1))}function U(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function F(){if(location.hash&&location.hash.length>1){var e,t,a=escape(location.hash.substr(1));try{e=$("#"+a+', a[name="'+a+'"]')}catch(o){return}e.length&&L.find(a)&&(0===B.scrollTop()?t=setInterval(function(){B.scrollTop()>0&&(_(e,!0),$(document).scrollTop(B.position().top),clearInterval(t))},50):(_(e,!0),$(document).scrollTop(B.position().top)))}}function O(){$(document.body).data("jspHijack")||($(document.body).data("jspHijack",!0),$(document.body).delegate("a[href*=#]","click",function(e){var t,a,o,n,i,s,l=this.href.substr(0,this.href.indexOf("#")),r=location.href;if(-1!==location.href.indexOf("#")&&(r=location.href.substr(0,location.href.indexOf("#"))),l===r){t=escape(this.href.substr(this.href.indexOf("#")+1));try{a=$("#"+t+', a[name="'+t+'"]')}catch(c){return}a.length&&(o=a.closest(".jspScrollable"),n=o.data("jsp"),n.scrollToElement(a,!0),o[0].scrollIntoView&&(i=$(window).scrollTop(),s=a.offset().top,(i>s||s>i+$(window).height())&&o[0].scrollIntoView()),e.preventDefault())}}))}function M(){var e,t,a,o,n,i=!1;B.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(s){var l=s.originalEvent.touches[0];e=x(),t=C(),a=l.pageX,o=l.pageY,n=!1,i=!0}).bind("touchmove.jsp",function(s){if(i){var l=s.originalEvent.touches[0],r=te,c=J;return $e.scrollTo(e+a-l.pageX,t+o-l.pageY),n=n||Math.abs(a-l.pageX)>5||Math.abs(o-l.pageY)>5,r==te&&c==J}}).bind("touchend.jsp",function(e){i=!1}).bind("click.jsp-touchclick",function(e){return n?(n=!1,!1):void 0})}function R(){var t=C(),a=x();e.removeClass("jspScrollable").unbind(".jsp"),e.replaceWith(xe.append(L.children())),xe.scrollTop(t),xe.scrollLeft(a),me&&clearInterval(me)}var H,L,q,E,B,z,N,W,Y,X,V,Q,K,J,Z,ee,te,ae,oe,ne,ie,se,le,re,ce,de,ue,pe,fe,he,me,ge,ve,be,$e=this,we=!0,ye=!0,ke=!1,_e=!1,xe=e.clone(!1,!1).empty(),Ce=$.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===e.css("box-sizing")?(ge=0,ve=0):(ge=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),ve=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0)),$.extend($e,{reinitialise:function(e){e=$.extend({},H,e),a(e)},scrollToElement:function(e,t,a){_(e,t,a)},scrollTo:function(e,t,a){k(e,a),y(t,a)},scrollToX:function(e,t){k(e,t)},scrollToY:function(e,t){y(e,t)},scrollToPercentX:function(e,t){k(e*(z-q),t)},scrollToPercentY:function(e,t){y(e*(N-E),t)},scrollBy:function(e,t,a){$e.scrollByX(e,a),$e.scrollByY(t,a)},scrollByX:function(e,t){var a=x()+Math[0>e?"floor":"ceil"](e),o=a/(z-q);g(o*ee,t)},scrollByY:function(e,t){var a=C()+Math[0>e?"floor":"ceil"](e),o=a/(N-E);h(o*K,t)},positionDragX:function(e,t){g(e,t)},positionDragY:function(e,t){h(e,t)},animate:function(e,t,a,o){var n={};n[t]=a,e.animate(n,{duration:H.animateDuration,easing:H.animateEase,queue:!1,step:o})},getContentPositionX:function(){return x()},getContentPositionY:function(){return C()},getContentWidth:function(){return z},getContentHeight:function(){return N},getPercentScrolledX:function(){return x()/(z-q)},getPercentScrolledY:function(){return C()/(N-E)},getIsScrollableH:function(){return V},getIsScrollableV:function(){return X},getContentPane:function(){return L},scrollToBottom:function(e){h(K,e)},hijackInternalLinks:$.noop,destroy:function(){R()}}),a(t)}return e=$.extend({},$.fn.jScrollPane.defaults,e),$.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed}),this.each(function(){var a=$(this),o=a.data("jsp");o?o.reinitialise(e):($("script",a).filter('[type="text/javascript"],:not([type])').remove(),o=new t(a,e),a.data("jsp",o))})},$.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}),$(function(){function e(){var e=$("#dt-notification"),a=e.find(".dt-notification-btn"),o=$(".dt-menu-inner-nav-tab");f.on("click",function(){$(".dt-co-menu").length&&$(".dt-co-menu").hide()}),f.on("click",".dt-menu-message",function(e){e.stopPropagation()}),a.click(function(e){e.preventDefault(),e.stopPropagation(),$(".dt-co-menu").show();var a=o.eq(0)[0];t(a)}),o.click(function(){this.switchTab=t,this.switchTab(this)})}function t(e){var t=$(e),n=t.index(),u=t.find(".dt-tab-realnum").text(),m=$(".dt-notification-count"),g=$(".dt-allcount"),v=g.text(),b=$(".dt-bottom-location");switch(h.eq(n).find(".dt-nonoti").length||(p=window.setTimeout(function(){a(n)},1500)),n){case 0:var w=t.find(".dt-tab-hidenum"),y={};for(i=0;i<w.length;i++){var k=w.eq(i).data("cleanname"),_=w.eq(i).text();y[k]=_}var x=0;for(var C in y)x+=+y[C];x>0&&o(y),b.attr({href:"/notification/list/#/napi/notification/list/?read_all=0&limit=20&start=0"}),h.eq(n).find("li").length||h.eq(n).find(".dt-nonoti").length||l();break;case 1:b.attr({href:"/notification/list/#/napi/album/co_album/list/?start=0"}),h.eq(n).find("li").length||h.eq(n).find(".dt-nonoti").length||d();break;case 2:b.attr({href:"/notification/#/letters/1"}),h.eq(n).find("li").length||h.eq(n).find(".dt-nonoti").length||r();break;case 3:var y={},T=t.find(".dt-tab-realnum").text(),S=t.find(".dt-tab-numclean").data("cleanname");y[S]=T,T>0&&o(y),b.attr({href:"/notification/list/#/napi/people/list/by_recommend/?limit=20&start=0"}),h.eq(n).find("li").length||h.eq(n).find(".dt-nonoti").length||c()}v-=u,999>v&&m.text(v),0===v&&m.hide().text(""),g.text(v),t.addClass("tab-highlight").siblings().removeClass("tab-highlight").end().children("i").hide().text(""),h.eq(n).show().siblings().hide(),f.ajaxComplete(function(e,t,a){a.url.indexOf("/napi/")>-1&&200===t.status&&t.responseText.indexOf('"blogs":[]')<0&&s(h,n)}),s(h,n)}function a(e){h.eq(e).find("li").length||1===e||h.eq(e).find("ul").append('<img src="http://img5.duitang.com/uploads/people/201307/30/20130730175612_KU2dF.gif" alt="" class="pg-loadgif">')}function o(e){$.ajax({url:"/napi/read/",data:e,mysuccess:function(e,t){}})}function n(){$.ajax({type:"GET",cache:!1,url:"/napi/unread/",mysuccess:function(e,t){if(e.data){var a=e.data,o=0,n=a.recommend_friend_count,s=a.blog_forward_count,l=a.letter_count,r=a.album_like_count,c=a.blog_like_count,d=a.blog_comment_count,u=$("#dt-notification"),p=u.find(".dt-notification-btn"),f=u.find(".dt-notification-count"),h=u.find(".dt-menu-inner-notifi"),m=h.find(".dt-menu-inner-nav-tab"),g=(m.children("span"),m.children(".dt-tab-numclean")),v=m.children(".dt-tab-realnum");nofi_num=parseInt(s)+parseInt(r)+parseInt(c)+parseInt(d),o=nofi_num+parseInt(n)+parseInt(l);var b=[s,r,c,d],w=$(".dt-tab-hidenum");for(i=0;i<w.length;i++)w.eq(i).html(b[i]);if(v.eq(0).html(nofi_num),v.eq(2).html(l),v.eq(3).html(n),o>0){var y=999,k=o>y?y+"+":o;f.length?f.html(k):(p.append('<span class="dt-notification-count">'+k+"</span>"),p.append('<i class="dt-allcount dn">'+o+"</i>")),h.parent(".dt-menu").removeClass("disable"),g.hide()}else f&&f.remove(),h.parent(".dt-menu").hide().addClass("disable"),g.hide();var _=99;nofi_num>0&&(nofi_num=nofi_num>_?_+"+":nofi_num,g.eq(0).show().html(nofi_num)),l>0&&(l=l>_?_+"+":l,g.eq(2).show().html(l)),n>0&&(n=n>_?_+"+":n,g.eq(3).show().html(n))}}})}function s(e,t){var a=e.eq(t);a.jScrollPane({horizontalGutter:5,verticalGutter:5,showArrows:!1,mouseWheelSpeed:50}).bind("mousewheel",function(e){e.preventDefault()}),$(".jspDrag").hide(),$(".jspScrollable").mouseenter(function(){$(this).find(".jspDrag").stop(!0,!0).fadeIn("slow")}),$(".jspScrollable").mouseleave(function(){$(this).find(".jspDrag").stop(!0,!0).fadeOut("slow")})}function l(){$.ajax({type:"GET",cache:!1,url:"/napi/notification/list/?read_all=0&&types=BLOG_FORWARD,BLOG_COMMENT,ALBUM_LIKE,BLOG_LIKE",dataType:"json",mysuccess:function(e,t){window.clearTimeout(p);var a=e.data,o=a.object_list,n=$(".dt-all");n.html("");for(var i=0;i<o.length;i++){var s=o[i],l=s.actor,r=s.album,c=s.comment,d=s.blog,u=d&&d.photo.path,f=r&&r.name,h=r&&r.covers[0],m=r&&r.id,g=c&&c.content,v=d&&d.msg,b=d&&d.id,w=void 0!==l?l.avatar:"",y=void 0!==l?l.username:"",k=void 0!==l?l.id:"";if(u=$.G.dtImageTrans(u,!0,48,48,"c")||"",h=$.G.dtImageTrans(h,!0,48,48,"c")||"",w=$.G.dtImageTrans(w,!0,48,48,"c")||"",v&&v.length>12)var v=$.trim(v).substring(0,12).trim(this)+"...";if("BLOG_FORWARD"===s.type){var _='<a href="/people/mblog/'+b+'/detail/"><li class="clr"><div class="dt-people-avatar"><img src="'+w+'" alt="" class="dt-people-image" data-pdetail="/people/'+k+'/"><i class="dt-people-icon people-forward"></i></div><div class="dt-people-info"><p class="dt-people-name">'+y+'</p><p class="dt-people-msg">\u6536\u96c6\u4e86\u4f60\u7684'+v+'</p><img class="dt-opeople-image" src="'+u+'" alt=""></div></li></a>';n.append(_)}else if("BLOG_COMMENT"===s.type){if(void 0!==g){var _='<a href="/people/mblog/'+b+'/detail/"><li class="clr"><div class="dt-people-avatar"><img src="'+w+'" alt="" class="dt-people-image" data-pdetail="/people/'+k+'/"><i class="dt-people-icon people-comment"></i></div><div class="dt-people-info clr"><p class="dt-people-name">'+y+'</p><p class="dt-people-msg">\u8bc4\u8bba\u4e86\u4f60\u7684 '+v+'</p><p class="people-content">'+g+'</p><img class="dt-opeople-image" src="'+u+'" alt=""></div></li></a>';n.append(_)}}else if("ALBUM_LIKE"===s.type){var _='<a href="/album/'+m+'/"><li class="clr"><div class="dt-people-avatar"><img src="'+w+'" alt="" class="dt-people-image" data-pdetail="/people/'+k+'/"><i class="dt-people-icon people-like"></i></div><div class="dt-people-info"><p class="dt-people-name">'+y+'</p><p class="dt-people-msg">\u559c\u6b22\u4e86\u4f60\u7684\u4e13\u8f91 '+f+'</p><img class="dt-opeople-image" src="'+h+'" alt=""></div></li></a>';n.append(_)}else if("BLOG_LIKE"===s.type){var _='<a href="/people/mblog/'+b+'/detail/"><li class="clr"><div class="dt-people-avatar"><img src="'+w+'" alt="" class="dt-people-image" data-pdetail="/people/'+k+'/"><i class="dt-people-icon people-zan"></i></div><div class="dt-people-info"><p class="dt-people-name">'+y+'</p><p class="dt-people-msg">\u8d5e\u4e86\u4f60\u7684 '+v+'</p><img class="dt-opeople-image" src="'+u+'" alt=""></div></li></a>';n.append(_)}}n.find("li").length||n.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u7a7a\u8361\u8361</div>')},myerror:function(e,t){window.clearTimeout(p);var a=$(".dt-all");a.html(""),a.find("li").length||a.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u51fa\u9519\u4e86\u54df</div>')}})}function r(){$.ajax({type:"GET",cache:!1,url:"/napi/letter/list/?read_all=0",dataType:"json",mysuccess:function(e,t){window.clearTimeout(p);var a=e.data,o=a.object_list,n=$(".dt-message");n.html("");for(var i=0;i<o.length;i++){var s=o[i],l=s.participant,r=s.last_letter&&s.last_letter.blog,c=r&&r.photo.path,d=l.username,u=l.avatar,f=l.id,h=s.last_letter||{},m=h.message_type,g=h.msg,v=s.unread_count,b=s.id,c=$.G.dtImageTrans(c,!0,48,48,"c"),u=$.G.dtImageTrans(u,!0,48,48,"c");if(g&&g.length>12)var g=$.trim(g).substring(0,12);switch(m){case"text":n.append('<a class="dt-link-letter" href="/notification/#/letter/'+b+'"><li class="clr"><div class="dt-people-avatar"><img src="'+u+'" alt="" class="dt-people-image" data-pdetail="/people/'+f+'/"><i class="dt-icon-letter dt-icon-letter'+i+'"></i></div><div class="dt-people-info clr"><p class="dt-people-name">'+d+'</p><p class="people-msg">'+g+"</p></div></li></a>"),v>0&&$(".dt-icon-letter"+i).addClass("on");break;case"share_blog":n.append('<a class="dt-link-letter" href="/notification/#/letter/'+b+'"><li class="clr"><div class="dt-people-avatar"><img src="'+u+'" alt="" class="dt-people-image" data-pdetail="/people/'+f+'/"><i class="dt-icon-letter dt-icon-letter'+i+'"></i></div><div class="dt-people-info clr"><p class="dt-people-name">'+d+'</p><p class="people-msg">'+g+'</p><img class="dt-opeople-image" src="'+c+'" alt=""></div></li></a>'),v>0&&$(".dt-icon-letter"+i).addClass("on");break;case"share_album":var w=h.album;if(void 0!==w){var y=w.covers[0],y=$.G.dtImageTrans(y,!0,48,48,"c");n.append('<a class="dt-link-letter" href="/notification/#/letter/'+b+'"><li class="clr"><div class="dt-people-avatar"><img src="'+u+'" alt="" class="dt-people-image" data-pdetail="/people/'+f+'/"><i class="dt-icon-letter dt-icon-letter'+i+'"></i></div><div class="dt-people-info clr"><p class="dt-people-name">'+d+'</p><p class="people-msg">'+g+'</p><img class="dt-opeople-image" src="'+y+'" alt=""></div></li></a>'),v>0&&$(".dt-icon-letter"+i).addClass("on")}break;case"banner":var k=h.banner,_=k.image_url,_=$.G.dtImageTrans(_,!0,48,48,"c");n.append('<a class="dt-link-letter" href="/notification/#/letter/'+b+'"><li class="clr"><div class="dt-people-avatar"><img src="'+u+'" alt="" class="dt-people-image" data-pdetail="/people/'+f+'/"><i class="dt-icon-letter dt-icon-letter'+i+'"></i></div><div class="dt-people-info clr"><p class="dt-people-name">'+d+'</p><p class="people-msg">'+g+'</p><img class="dt-opeople-image" src="'+_+'" alt=""></div></li></a>'),v>0&&$(".dt-icon-letter"+i).addClass("on");break;case"co_album_invitation":}}n.find("li").length||n.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u7a7a\u8361\u8361</div>')},myerror:function(e,t){window.clearTimeout(p);var a=$(".dt-message");a.html(""),a.find("li").length||a.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u51fa\u9519\u4e86\u54df</div>')}})}function c(){$.ajax({type:"GET",cache:!1,url:"/napi/people/list/by_recommend/",dataType:"json",mysuccess:function(e,t){window.clearTimeout(p);var a=e.data,o=a.object_list,n=$(".dt-friend");n.html("");for(var i=0;i<o.length;i++){var s=o[i],l=s.relationship,r=s.username,c=s.recommend,d=s.avatar,u=s.id,d=$.G.dtImageTrans(d,!0,48,48,"c");0===l?(n.append('<li class="clr"><div class="dt-people-avatar"><img src="'+d+'" alt="" class="dt-people-image" data-pdetail="/people/'+u+'/"></div></a><div class="dt-people-info"><p class="dt-people-name"><a href="/people/'+u+'/">'+r+"</a></p><p>"+c+'</p></div><a class="btn-green follow" href="javascript:;">\u5173\u6ce8</a></li>'),n.find("li:last .follow").attr({"data-follow":'{"id":"'+u+'","rel":"0"}'})):1===l?(n.append('<li class="clr"><div class="dt-people-avatar"><img src="'+d+'" alt="" class="dt-people-image" data-pdetail="/people/'+u+'/"></div></a><div class="dt-people-info"><p class="dt-people-name"><a href="/people/'+u+'/">'+r+"</p></a><p>"+c+'</p></div><a class="btn-white unfollow" href="javascript:;">\u5df2\u5173\u6ce8</a></li>'),
n.find("li:last .unfollow").attr({"data-follow":'{"id":"'+u+'","rel":"1"}'})):2===l?(n.append('<li class="clr"><div class="dt-people-avatar"><img src="'+d+'" alt="" class="dt-people-image" data-pdetail="/people/'+u+'/"></div></a><div class="dt-people-info"><p class="dt-people-name"><a href="/people/'+u+'/">'+r+"</a></p><p>"+c+'</p></div><a class="btn-green follow" href="javascript:;">\u5173\u6ce8</a></li>'),n.find("li:last .follow").attr({"data-follow":'{"id":"'+u+'","name":"'+r+'","rel":"2"}'})):3===l&&(n.append('<li class="clr"><div class="dt-people-avatar"><img src="'+d+'" alt="" class="dt-people-image" data-pdetail="/people/'+u+'/"></div></a><div class="dt-people-info"><p class="dt-people-name"><a href="/people/'+u+'/">'+r+"</p></a><p>"+c+'</p></div><a class="btn-white unfollow" href="javascript:;">\u76f8\u4e92\u5173\u6ce8</a></li>'),n.find("li:last .unfollow").attr({"data-follow":'{"id":"'+u+'","name":"'+r+'","rel":"3"}'}))}n.find("li").length||n.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u7a7a\u8361\u8361</div>')},myerror:function(e,t){window.clearTimeout(p);var a=$(".dt-friend");a.html(""),a.find("li").length||a.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u51fa\u9519\u4e86\u54df</div>')}})}function d(){$.ajax({type:"GET",cache:!1,url:"/napi/album/co_album_invitation/list/",dataType:"json",mysuccess:function(e,t){window.clearTimeout(p);var a=e.data,o=a.object_list,n=$(".dt-inviter");$(".dt-coalbum");$(".dt-coalbum").html(""),$(".dt-inviter").html("");for(var i=0;i<o.length;i++){var s=o[i],l=s.inviter,r=l.id,c=l.username,d=l.avatar,f=s.album,h=f.covers[0],m=f.name,g=f.id,v=f.user,d=(v.id,$.G.dtImageTrans(d,!0,48,48,"c"));h=$.G.dtImageTrans(h,!0,48,48,"c"),n.append('<li class="clr"><div class="people-outer"><div class="dt-people-avatar"><img src="'+d+'" alt="" class="dt-people-image" data-pdetail="/people/'+r+'/"></div><div class="dt-people-info clr"><p class="dt-people-name">'+c+'</p><p class="dt-people-msg">\u9080\u8bf7\u4f60\u52a0\u5165\u5171\u5efa\u4e13\u8f91 <a href="/album/'+g+'/">'+m+'</a></p><div class="dt-pOpreate"><a href="javascript:;" class="btn-green dt-haccept" data-albumid="'+g+'">\u63a5\u53d7</a><a href="javascript:;" class="btn-white dt-hdeny" data-albumid="'+g+'">\u62d2\u7edd</a></div></div></div><img class="dt-inviter-hidecover" src="'+h+'"/></li>')}var b=n.find("li").length;$(".dt-item2-inviter_num").text(b),u()},myerror:function(e,t){var a=$(".dt-inviter"),o=$(".dt-coalbum");a.html(""),o.find("li").length||o.append('<div clr class="dt-nonoti">\u8fd9\u91cc\u51fa\u9519\u4e86\u54df</div>')}})}function u(){$.ajax({type:"GET",cache:!1,url:"/napi/album/co_album/list/",dataType:"json",mysuccess:function(e,t){var a=e.data,o=a.object_list,n=0;$pCoalbum=$(".dt-coalbum"),$(".dt-coalbum").html("");for(var i=0;i<o.length;i++){var s=o[i],l=s.blog,r=l?l.msg:"",c=s.covers[0],d=s.last_active_user,u=d&&d.avatar,p=(d&&d.id,s.name),f=s.id,h=s.actived_at,c=$.G.dtImageTrans(c,!0,48,48,"c"),u=$.G.dtImageTrans(u,!0,48,48,"c");if(r&&r.length>12)var r=$.trim(r).substring(0,12).trim(this)+"...";if(d){$pCoalbum.append('<a href="/album/'+f+'/" data-dtactived="'+h+'"><li class="clr"><div class="dt-people-outer"><div class="dt-opeople-avatar"><img src="'+c+'" alt="" class="dt-opeople-image"></div><div class="dt-people-info dt-people-info2 clr"><p class="dt-people-name">'+p+'</p><p class="dt-people-msg">'+r+'</p><img class="dt-people-image2" src="'+u+'" alt=""><i class="dt-icon-inviter off"></i></div></div></li></a>');var m="co_album_visted_"+f,g=$.Store.get(m),v=g!==h;v&&($(".dt-icon-inviter").eq(i).removeClass("off").addClass("on"),n+=1)}else $pCoalbum.append('<a href="/album/'+f+'/"><li class="clr"><div class="dt-opeople-avatar"><img src="'+c+'" alt="" class="dt-opeople-image"></div><div class="dt-people-info clr"><p class="dt-people-name">'+p+'</p><p class="dt-people-msg">'+r+"</p></div></li></a>")}$(".dt-item2-coalbum_num").text(n),$(".dt-inviter").find("li").length||$(".dt-coalbum").find("li").length||$(".dt-coalbum").append('<div clr class="dt-nonoti">\u8fd9\u91cc\u7a7a\u8361\u8361</div>')}})}var p,f=$(document),h=$(".dt-menu-inner-content-item");f.on("click",".dt-menu-inner-content-item .dt-people-avatar",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.find("img").data("pdetail");window.location.href=a}),f.on("click",".dt-coalbum li",function(e){var t=$(this),a=t.parent("a").attr("href"),o=t.parent("a").data("dtactived");a=a.split("/")[2];var n="co_album_visted_"+a,i=$.Store.get(n),s=i!==o;s&&$.Store.set(n,o)}),f.on("click",".dt-hdeny",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.data("albumid");t.hasClass("abtn-no")||(t.addClass("abtn-no"),$.ajax({url:"/napi/album/co_album_invitation/reject/",data:{album_id:a},mysuccess:function(e,a){t.closest("li").remove()}}).always(function(){t.removeClass("abtn-no")}))}),f.on("click",".dt-haccept",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.data("albumid"),o=t.closest(".dt-inviter").find(".dt-inviter-hidecover").attr("src");t.hasClass("abtn-no")||(t.addClass("abtn-no"),$.ajax({url:"/napi/album/co_album_invitation/accept/",data:{album_id:a},mysuccess:function(e,a){var n=e.data,i=n.album,s=i.user,l=s&&s.avatar,r=i.id,c=i.name,l=(i.desc,$.G.dtImageTrans(l,!0,48,48,"c")),d='<li><a href="/album/'+r+'/"><div class="dt-opeople-avatar"><img src="'+o+'" alt="" class="dt-opeople-image"></div><div class="dt-people-info clr"><p class="dt-people-name">'+c+'</p><p class="dt-people-msg"></p><img class="dt-people-image2" src="'+l+'" alt=""></div></a></li>';t.closest(".dt-inviter").prepend(d).end().closest("li").remove()}}).always(function(){t.removeClass("abtn-no")}))}),$(".dt-friend").SGfollow("a[data-follow]"),$("#dt-notification").length&&(window.setTimeout(function(){n()},500),window.location.href.toString().match(/duitang\.com\/myhome/gi)&&window.setInterval(n(),2e4)),e()}),$(function(){$.fn.extend({hasMenu:function(e){e||(e=".dt-menu");var t=$(this);t.each(function(t,a){var o,n,i=$(a),s=i.find(e);i.mouseover(function(){clearTimeout(n),s.hasClass("disable")||(o=setTimeout(function(){s.length?s.addClass("show"):i.addClass("show")},200))}).mouseout(function(){clearTimeout(o),s.hasClass("disable")||(n=setTimeout(function(){s.length?s.removeClass("show"):i.removeClass("show")},400))})})}});$("#dt-nav-btn"),$(".dt-trend"),$("#dt-notification"),window.location.pathname,window.location.hash;!function(){var e,t;$(document).delegate("#dt-nav","mouseover",function(){clearTimeout(t);var a=$(this),o=$("#dt-search-list");e=setTimeout(function(){a.addClass("show"),o.removeClass("show")},200)}).delegate("#dt-nav","mouseout",function(){clearTimeout(e);var a=$(this);t=setTimeout(function(){a.removeClass("show")},400)})}(),$(".dt-has-menu").hasMenu(),$("#dt-add").one("mouseover",function(){$("#mynavtools-local").click(function(e){$.SGColl.init({type:"upload"})})}),$(document).delegate("#dt-login","click",function(e){e.preventDefault(),SUGAR.PopOut.login()}),$.browser.msie&&"6.0"===$.browser.version||$("#header-wrap").sidepop({id:"pnav-header",width:"100%",height:65,scroll:1,baseline:"top",bias:0,seat:!0,isFixed:!0,zIndex:998,btnset:0});var e="  __              __                                \n /\\ \\          __/\\ \\__                             \n \\_\\ \\  __  __/\\_\\ \\ ,_\\    __      ___      __     \n /'_` \\/\\ \\/\\ \\/\\ \\ \\ \\/  /'__`\\  /' _ `\\  /'_ `\\   \n/\\ \\L\\ \\ \\ \\_\\ \\ \\ \\ \\ \\_/\\ \\L\\.\\_/\\ \\/\\ \\/\\ \\L\\ \\  \n\\ \\___,_\\ \\____/\\ \\_\\ \\__\\ \\__/.\\_\\ \\_\\ \\_\\ \\____ \\ \n \\/__,_ /\\/___/  \\/_/\\/__/\\/__/\\/_/\\/_/\\/_/\\/___L\\ \\ \n                                             /\\____/\n                                             \\_/__/         by xipeng.guan\n\n\u60f3\u6765\u5806\u7cd6\u5de5\u4f5c\uff1f\u8bf7\u53d1\u9001\u90ae\u4ef6\u5230 hr@duitang.com";window.console&&console.info&&console.info("%c   ","font-size:60px;background:url('http://img5.duitang.com/uploads/people/201312/26/20131226165635_LNYCt.png') no-repeat -10px -25px"),window.console&&console.info&&console.info(e),$(document).delegate("#dt-nav-hot-link, #dt-nav-new-link","click",function(){$("#dt-nav").removeClass("show")}),$("#dt-nav-content").delegate("a","mousedown",function(e){var t=$(this),a=t.text();$.G.gaq("/_trc/Nav/_/cate_link_"+a)}),$("#dt-search").find("form").submit(function(){$.G.gaq("/_trc/Nav/_/search_submit"),0==window.location.pathname.indexOf("/category/")&&$.G.gaq("/_trc/Nav/search/cate_"+window.location.pathname+"_"+$("#kw").val()),0==window.location.pathname.indexOf("/shopping/")&&$.G.gaq("/_trc/Nav/search/shop_"+window.location.pathname+"_"+$("#kw").val())}),$("#mynavtools-src").mousedown(function(){$.G.gaq("/_trc/Post/nav/fetch_entry")}),$("#mynavtools-local").mousedown(function(){$.G.gaq("/_trc/Post/nav/uppic_entry")}),$("#mynavtools-create").mousedown(function(){$.G.gaq("/_trc/AlbumPost/nav/entry")}),$(".dt-notification-btn").mousedown(function(){$.G.gaq("/_trc/Nav/_/message_entry")}),$(".dt-notification-btn .dt-menu-bottom a").mousedown(function(){$.G.gaq("/_trc/Nav/_/tip_know")}),$("#mynavtools-home").mousedown(function(){$.G.gaq("/_trc/Nav/_/tools_home")}),$("#mynavtools-find").mousedown(function(){$.G.gaq("/_trc/Nav/_/tools_find")}),$("#mynavtools-setting").mousedown(function(){$.G.gaq("/_trc/Nav/_/tools_setting")}),$("#mynavtools-logout").mousedown(function(){$.G.gaq("/_trc/Nav/_/tools_logout")}),$("#dt-login").mousedown(function(){$.G.gaq("/_trc/Nav/_/bar_login")}),$("#dt-register").mousedown(function(){$.G.gaq("/_trc/Nav/_/bar_register")}),$("#dt-ologin").delegate("a","mousedown",function(){var e=$(this).attr("class");$.G.gaq("/_trc/Nav/_/bar_outlogin_"+e)})}),$(function(){var e,t=$("#dt-search form"),a=t.find("input#kw"),o=t.find("button[type=submit]"),n=$("#dt-search .dt-search-line"),i=t.find("input#type"),s=$("#dt-search-list"),l=["feed","feed","album","people"];a.bind("keydown",function(e){var t=e.keyCode,a=$("#dt-search .dt-search-line.hover"),o=n.length,i=0;if(a.length)var s=n.index(a[0]);else var s=o-1;(40===t||38===t)&&(40===t?i=s===o-1?0:s+1:38===t&&(a.length||(s=0),i=0===s?o-1:s-1),a.removeClass("hover"),$(n[i]).addClass("hover").trigger("mouseover"))}),a.bind("keyup paste",function(e){var t=$(this),a=t.val();"paste"===e.type&&(a+=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.originalEvent.clipboardData.getData("Text")),a.length>0?(s.addClass("show"),a.length>10&&(a=a.cut(20)),s.find(".red").html(a)):s.removeClass("show")}).click(function(t){var a=$(this),o=a.val();o.length>0&&(clearTimeout(e),a.trigger("keyup"))}).blur(function(t){var a=$("#dt-search-list");e=setTimeout(function(){a.removeClass("show")},400)}),n.mouseover(function(e){var a=$(".dt-search-line"),o=a.index(this),n=$("#navsch-onlypd");a.removeClass("hover"),$(this).addClass("hover"),n.length||(n=$('<input id="navsch-onlypd" type="hidden" name="fq" value="1"/>')),1===o?t.append(n):$("#navsch-onlypd").remove(),i.val(l[o])}).mouseout(function(e){$(n[0]).trigger("mouseover")}).click(function(e){o.click()}),window.location.pathname.match(/^\/shopping\/.*$/)?(n.removeClass("hover"),$(n[1]).addClass("hover").trigger("mouseover")):(n.removeClass("hover"),$(n[0]).addClass("hover").trigger("mouseover"))}),function(e){function t(){var t=this,a=t.data("albumlike"),o=t.siblings("i"),n=e("span.like-count"),i=t.siblings(".act-i");a.cancel=1,o.length&&parseInt(o.html())>=0&&o.html(parseInt(o.html())+1+"\u4eba\u559c\u6b22"),n.length&&parseInt(n.html())>=0&&n.html(parseInt(n.html())+1+"\u4eba\u559c\u6b22"),i.length&&i.find("em").html(parseInt(i.find("em").html())+1),t.addClass("albumliked").find("span").html("\u5df2\u559c\u6b22")}function a(){var t=this,a=t.data("albumlike"),o=e("span.like-count"),n=t.siblings("span"),i=t.siblings(".act-i");a.cancel=0,o.length&&parseInt(o.html())>=0&&o.html(parseInt(o.html())-1+"\u4eba\u559c\u6b22"),n.length>=1&&parseInt(n.html())>=0&&t.siblings("span").html(parseInt(t.siblings("span").html())-1+"\u4eba\u559c\u6b22"),i.length&&i.find("em").html(parseInt(i.find("em").html())-1),t.hasClass("act-o")?t.removeClass("albumliked"):t.removeClass("albumliked").addClass("albumtolike").find("span").html("\u559c\u6b22")}e.fn.SGalbumlike=function(o,n,i){function s(o){if(o.stopPropagation(),o.preventDefault(),!e.G.getUSERID())return void SUGAR.PopOut.login();var n=e(this),i=n.data("albumlike"),s=i.id,l="",r="/unlike/",c="/like/";n.data("locked")||(n.data("locked",1),n.data("like")&&(l=n.data("like").like_id),i.cancel?e.ajax({url:r,data:"like_id="+l,mysuccess:function(e,t){a.call(n),n.removeData("locked")},myerror:function(){this.errormsg()}}).always(function(){n.removeData("locked")}):e.ajax({url:c,data:"object_id="+s+"&category=0&"+getToken(1),mysuccess:function(e,a){n.data("like",{like_id:e.data.like_id+""}),t.call(n)},myerror:function(){this.errormsg()}}).always(function(){n.removeData("locked")}))}return"function"!=typeof o&&(i=n,n=o,o=e.noop),"string"!=typeof n&&(i=n,n=""),i=e.extend({},i),n?this.delegate(n,"click",s):this.click(s),this}}(jQuery),$(function(){$(document).SGalbumlike(".albumlikebtn",{})}),function(e){e.fn.myalbums=function(t,a,o){function n(t){e.G.getUSERID()&&(e(u.sel_holder)!=e("body")?r.appendTo(u.sel_holder):r.css({position:"absolute",zIndex:30001,left:t.left+u.biasleft,top:t.top+u.biasleft}),r.css("display","block"==r.css("display")?"none":"block"),!l.data("loaded")&&e("a",d).length<=1?(d.addClass("loading"),e.ajax({cache:!1,type:"GET",url:"/album/collect/list/?count=0",mysuccess:function(t,a){d.removeClass("loading");var o=t.data.albums,n=c.val();if(o&&o.length){for(var i=0,s=o.length;s>i;i++)o[i].is_default_album||e("<a "+(n==o[i].id?'class="cur"':"")+' href="#" data-albumid="'+o[i].id+'">'+o[i].name.cut(40,"\u2026")+"</a>").appendTo(d);0==n&&d.find("a").eq(0).addClass("cur")}l.data("loaded",1)},myfailure:function(e,t){d.removeClass("loading")}})):r.find(".cur").removeClass("cur").end().find("a[data-albumid="+c.val()+"]").addClass("cur"))}function i(e,t){c.val(e),l.html(t),d.find(".cur").removeClass("cur").end().find("a[data-albumid="+e+"]").addClass("cur").prependTo(d),d.scrollTop(0),r.css("display","none")}function s(){c=e(u.sel_valueipt),c.length||(c=e('<input class="dn" type="text" value="">').appendTo(l)),r=e("#myalbums-wrap"),r.length||(r=e('<div id="myalbums-wrap" style="display:none"><div id="myalbums-albs"><a data-albumid="0" href="javascript:;">\u9ed8\u8ba4\u4e13\u8f91</a></div><div class="clr"><form action="/album/add/" method="post"><input type="text" value="" name="name" class="ipt l" maxlength="40"><a target="_self" href="javascript:;" class="abtn l"><button type="submit"><u>\u521b\u5efa</u></button></a></form></div></div>').click(function(e){e.stopPropagation()}).appendTo("body"),r.find("input").lengthLimit()),e(document).click(function(e){r.css("display","none")}),d=e("#myalbums-albs"),d.delegate("a","click",function(t){t.preventDefault();var a=this.innerHTML,o=e(this).data("albumid")||0;i(o,a)});var t=e.browser.mozilla?"DOMMouseScroll":"mousewheel";navigator.userAgent.toString().match(/ipad/gi)&&(e('<a id="ipadalbumselectordown" class="ipadalbumsel" href="javascript:;"></a>').appendTo(r).click(function(e){d.get(0).scrollTop+=26}).bind("dblclick",function(e){e.preventDefault(),e.stopPropagation()}),e('<a id="ipadalbumselectorup" class="ipadalbumsel" href="javascript:;"></a>').appendTo(r).click(function(e){d.get(0).scrollTop-=26}).bind("dblclick",function(e){e.preventDefault(),e.stopPropagation()})),d.bind(t,function(e){e.originalEvent.wheelDelta?this.scrollTop+=-1*e.originalEvent.wheelDelta:this.scrollTop+=e.originalEvent.detail>0?60:-60,e.preventDefault()}),r.find("input").click(function(){e(this).focus()}),r.find("form").safeSubmit(function(t){var a=this,o=e(a),n=o.find(".abtn"),s=n.find("[type=submit]");n.hasClass("abtn-no")||(n.addClass("abtn-no"),e.ajax({url:o.getFormAction(),data:o.paramForm(e.G.getToken(2)),mysuccess:function(t,a){var n=o.find("input"),s=e.trim(n.val());n.val(""),d.prepend(e('<a href="#" data-albumid="'+t.data.id+'">'+s.cut(40,"\u2026")+"</a>")).scrollTop(0),i(t.data.id,s)},myfailure:function(e,t){e.data&&e.data.robot_check?s.verif({w:1}):this.wrongmsg(e)}}).always(function(){n.removeClass("abtn-no")}))}),f.bind(u.event,function(t){t.stopPropagation(),t.preventDefault();var a=e(this).offset();n(a)})}var l=this;if(!(l.length<=0)){"function"!=typeof t&&(o=a,a=t,t=e.noop),"string"!=typeof a&&(o=a,a="");var r,c,d,u=e.extend({},e.fn.myalbums.defaults,o),p=!!a,f=p?e(a,l):l;return u.fn=t,s(),r}},e.fn.myalbums.defaults={sel_holder:"body",sel_valueipt:"",event:"click",biastop:0,biasleft:0}}(jQuery),function(e){function t(e){SUGAR.PopOut.alert([null,f,""],2)}function a(){v.find("a.abtn").addClass("abtn-no"),v.find(".s-sina").css({opacity:.5,color:"#aaa"})}function o(){v.find("a.abtn").removeClass("abtn-no"),v.find(".s-sina").css({opacity:1,color:"#333"})}function n(e,t){g.find("input[name=album]").val(e).end().find("a,span").html(t)}function i(e,t){b.html(t).attr("class",e)}function s(){h.val(""),i("","")}function l(t,a){e.G.blinkIt(function(){i("re-postsuc",y[0]+"\u6210\u529f\uff01")},null,function(){SUGAR.PopOut.closeMask(),e.isFunction(a)&&a(t),s()},1,800);var o=e(".collection").find("em");1===o.length&&t.blog&&o.each(function(){o.html(parseInt(o.html())+1)})}function r(t,a){if(t){var o=e(p);if(o.addClass("re-done").attr("href","/people/mblog/"+t+"/detail/").attr("target","_blank").attr("title","\u53bb\u770b\u6211\u7684\u6536\u96c6"),a){var n=o.closest(".woo").find(".d1"),i=e(".otheralbums h4").find("span").text(),s=parseInt(n.text())||parseInt(i)||0;n.html(s+1).removeClass("dn"),o.find("em").length&&o.find("i").addClass("y-done").end().find("em").html("\u5df2\u6536\u96c6 "+(s+1))}}}function c(a,n,i,l,r){w=!1,y=["\u6536\u96c6","\u6536\u96c6\u5230","\u6536\u96c6"],u("/people/mblog/forward/",r,i),f.css("display","block"),s(),o();var c,d=a.closest(".center"),p="";d.length?(c=d.find(".js-favorite-blogtit"),p=c.text()):(c=a.closest(".woo").find("div.g"),p=e("<div>"+c.html()+"</div>").find("a").remove().end().text()),h.val(e.trim(p)),e("#re-inp-parent").attr("name","parent").val(n),m.empty().scrollTop(0);var g,v,b=d.find(".js-favorite-blogimg");b.length?(g=b.data("width"),v=b.data("height")):(b=a.closest("div.woo").find("div.mbpho img"),g=b.outerWidth(),v=parseInt(b.attr("height"))),g>200&&(v=200*v/g,g=200),$i=e("<img />").attr("src",b.attr("src")).appendTo(m),$i.css({width:g,height:v,marginTop:200>=v?(200-v)/2:0,cursor:200>=v?"default":"move"}),e.data(m[0],"imgProp",{height:v}),t(a)}function d(a,n,i,l,r,c,d,p){w=p,y=["\u7f16\u8f91","\u8f6c\u79fb\u5230","\u63d0\u4ea4"],u("/blog/edit/",r,i,c,d,p),f.css("display","block"),s(),o();var g,v=a.closest(".center"),b="";v.length?(g=v.find(".js-favorite-blogtit"),b=g.text()):(g=a.closest(".woo").find("div.g"),b=e("<div>"+g.html()+"</div>").find("a").remove().end().text()),h.val(e.trim(b)),e("#re-inp-parent").attr("name","blog").val(n),m.empty().scrollTop(0);var $=v.find("img.js-favorite-blogimg");if($.length)var k=$.data("height"),_=$.data("width"),k=200*k/_,x=e("<img />").attr("src",$.attr("src")).appendTo(m);else{$=a.closest("div.woo").find("div.mbpho img");var k=parseInt($.attr("height")),x=e("<img />").attr("src",$.attr("src")).appendTo(m)}x.css({width:200,marginTop:200>k?(200-k)/2:0,cursor:200>=k?"default":"move"}),e.data(m[0],"imgProp",{height:k}),t(a)}function u(t,s,c,d,u,p){function k(e){keyupLenLimitForU(e.currentTarget,300,!0,!0)}if(f&&f.length)e.G.store(f);else{f=e('<div id="re-favorite"><form action="'+t+'" target="_self"><div id="re-head"><a id="re-close" target="_self" href="javascript:;" onclick="SUGAR.PopOut.closeMask();">\u5173\u95ed</a><h1>'+y[0]+'</h1></div><div id="re-cont" class="clr"><div id="re-left" class="l"></div> <div id="re-right" class="r"> <p>'+y[1]+'</p> <div id="re-albumsel"><input class="dn" type="text" data-optional="1" value="0" name="album"><a id="re-albumtrig" href="javascript:;">\u9ed8\u8ba4\u4e13\u8f91</a><span id="re-onlyeditwds"></span></div><textarea name="content"'+("\u7f16\u8f91"!=y[0]||c!=e.G.getUSERID()&&!e.G.isSTAFF()?' class="txa txa-no" disabled ':' class="txa" ')+' data-optional="1" ></textarea> <div id="re-subpan" class="u-chk clr"> <a href="javascript:;" class="abtn l "><button type="submit"><u>'+y[2]+"</u></button></a>"+(typeof BIND_SITES!=$&&BIND_SITES.sina?'<input id="re-sycn-sina" type="checkbox" value="sina" class="chk s-sina" name="syncpost" /><label class="s-sina" title="\u540c\u6b65\u5230\u65b0\u6d6a\u5fae\u535a" for="re-sycn-sina">\u540c\u6b65</label><div class="re-mbsite s-sina">\u65b0\u6d6a</div>':"")+'<div id="re-poststat"></div></div></div></div><input id="re-inp-parent" type="hidden" name="parent" value="" data-optional="1" /></form></div>'),e.G.store(f);var _=e.G.getYearCookie("sync");e("#re-sycn-sina").prop("checked",-1===_.indexOf("sina")?!1:!0).change(function(){var t=e(this),a=t.attr("value");_=_.replace(new RegExp(","+a,"ig"),""),t.prop("checked")||-1!==_.indexOf(a)?t.prop("checked")&&e.G.setYearCookie("sync",_+","+a):e.G.setYearCookie("sync",_)}),b=e("#re-poststat"),g=f.find("#re-albumsel"),g.removeClass("re-onlyedit").find("a").myalbums({sel_valueipt:g.find("input[name=album]"),sel_holder:f}),m=e("#re-left").mousemove(function(t){if(t.stopPropagation(),!e.data(this,"movelock")){var a=e(this),o=e.data(this,"imgProp")||{},n=o.height;if(n>200){var i=t.pageY,s=m.offset().top,l=i-s-50,l=0>l?0:l;e.data(this,"movelock",!0),a.stop().animate({scrollTop:l*(n-200)*2/200},50,"linear",function(){e.data(a[0],"movelock",!1)})}}}),h=f.find("textarea.txa"),h.keyup(k).blur(k).focus(k),keyupLenLimitForU(h[0],300,!0,!0),e.fn.at&&h.at({isFixed:!0}),v=f.find("form").safeSubmit(function(t){var n=e(this),c=h.val(),d=g.find("input").val(),u=e("#re-albumtrig").text(),p=n.find("a.abtn");p.find("[type=submit]");p.hasClass("abtn-no")||(a(),i("re-inpost","\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7a0d\u5019"),e.ajax({url:n.getFormAction(),data:n.paramForm(getToken(2)),success:function(t){var a=e.isPlainObject(t)?t:e.parseJSON(t);if(!a||"object"!=typeof a)return void i("re-posterr","\u51fa\u73b0\u5f02\u5e38\uff0c\u53ef\u80fd\u662f\u7f51\u7edc\u539f\u56e0");if(a.data||(a.data={}),a.data.content=c,a.data.albumid=d,a.data.albumname=u,a.success){var n=g.find("[name=album]").val(),p=g.find("a").html();!w&&n&&"0"!=n&&(e.Bom.removeCookie("sgt"),e.Bom.setSubCookie("sgt","ai"+e.G.getUSERID(),n,{expires:30}),e.Bom.setSubCookie("sgt","an"+e.G.getUSERID(),p,{expires:30})),l(a.data,s),r(a.data&&a.data.blog,1)}else if(a.data&&a.data.robot_check);else{var f=e.trim(mergeServerMessage(a.message));i("re-posterr",f),o(),"\u4f60\u5df2\u7ecf\u6536\u96c6\u4e86\u8be5\u5206\u4eab"==f?r():o(),e.G.gaq("/_trc/Error/ajax/response_"+f+"_forward")}},myerror:function(){i("re-posterr","\u7f51\u7edc\u539f\u56e0\u5bfc\u81f4\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5"),o()}}).always(function(){}))},function(t){e.G.blinkIt(function(){h.css({backgroundColor:"#d7ebf7"})},function(){h.css({backgroundColor:"#fff"})},function(){h.focus()},4,200)})}if(p?(g.addClass("re-onlyedit"),e("#re-subpan").find("input,label,div.re-mbsite").css("visibility","hidden")):(g.removeClass("re-onlyedit"),e("#re-subpan").find("input,label,div.re-mbsite").css("visibility","visible")),"undefined"!=typeof d)d=d||"",u=u||"\u9ed8\u8ba4\u4e13\u8f91",n(d,u);else{var x=e.Bom.getSubCookie("sgt","ai"+e.G.getUSERID())||"",C=e.Bom.getSubCookie("sgt","an"+e.G.getUSERID())||"\u9ed8\u8ba4\u4e13\u8f91";n(x,C)}v.attr("action",t),f.find("h1").html(y[0]).end().find("#re-right p").eq(0).html(y[1]).end().find(".abtn u").html(y[2])}var p,f,h,m,g,v,b,$,w=!1,y=["\u6536\u96c6","\u6536\u96c6\u5230","\u6536\u96c6"];e.fn.SGfavorite=function(t){function a(t){if(e(this).hasClass("re-done"))return!0;t.stopPropagation(),t.preventDefault();var a=e(this),o=a.data("favorite"),o=o?o:a.closest(".collbtn").data("favorite"),i=o?o.id:0,s=e.G.getUSERID(),l=o.owner,r=o.rooter;if(p=this,1!=o.edit||l!=s&&!e.G.isSTAFF()){if(l==s)return void alert("\u4f60\u6536\u96c6\u8fc7\u7684\uff0c\u4e0d\u80fd\u518d\u6536\u96c6\u54e6~");if(r==s)return void alert("\u4f60\u7b2c\u4e00\u6b21\u53d1\u5e03\u7684\uff0c\u4e0d\u80fd\u518d\u6536\u96c6\u54e6~");var u=a.parent();u.hasClass("collbtn")&&e.G.gaq("/_trc/Repost/waterfall/popstart"),c(a,i,r,l,n)}else d(a,i,r,l,n,o.belongalbumid,o.belongalbumname,o.onlyedit)}t=t||{};var o=t.etype||"click",n=t.callback;return e.G.getUSERID()?e(document).on(o,this.selector,a):(this.attr("title")||this.attr("title","\u767b\u5f55\u624d\u80fd\u8fdb\u884c\u64cd\u4f5c\u54e6\uff0c\u70b9\u51fb\u5c31\u53ef\u4ee5\u767b\u5f55\u5566"),e(document).on(o,this.selector,function(e){e.stopPropagation(),e.preventDefault(),SUGAR.PopOut.login()})),this},e.fn.SGcomment=function(t){function a(t,a,o,n,i,s,l){var r=i.find(".re-comt");i.find(".re-comt").stop().clearQueue().animate({height:0},200).queue(function(){e.Woo.resetCol(-118,s,l),e.data(n[0],"comment",-1),r.find("textarea").blur()}),e.data(n[0],"comment",0)}function o(t,a,o,n,i,s,l,r){if("undefined"==typeof e.data(n[0],"comment")){var c=e('<li class="re-comt"><img width="24" height="24" src='+USER.smallAvatar+'><form action="/napi/comment/create/"><div class="pb8"><textarea class="txa" name="content" placeholder="\u53d1\u5e03\u8bc4\u8bba..."></textarea><a class="abtn l" href="#"><u>\u8bc4\u8bba</u></a></div><input type="hidden" name="_type" value=""/><input type="hidden" value="'+a+'" name="comment_message_id"></form></li>');i.after(c),e.fn.at&&c.find("textarea").at({pageMembers:s.find("li p a:first-child")}),c.find("a.abtn").click(function(t){t.stopPropagation(),t.preventDefault();var a=e(this),o=a.closest("form"),n=o.find("textarea"),i=e.trim(n.val());return i?void(a.hasClass("abtn-no")||(a.addClass("abtn-no"),e.ajax({url:"/napi/comment/create/",data:o.paramForm(getToken(2)),mysuccess:function(t,o){var i=e(".dt-avatar").attr("src"),s=e(['<li><a href="/myhome/" target="_blank"><img src="',i,'" width="24" height="24"></a><p><a href="/myhome/" target="_blank">\u6211</a><br/><span>',t.data.content.replace(/<br\s*\/?>/i," ").replace(/@[\u2E80-\u9FFF\d\w]{1,20}/gi,""),"</span></p></li>"].join(""));c.before(s.css("display","none")),n.val(""),s.slideDown(200,function(){e.Woo.resetCol(s.outerHeight(!0),l,r)});var d=a.closest(".woo").find(".d3"),u=parseInt(d.text())||0;d.html(++u).removeClass("dn")},myerror:function(){this.errormsg()}}).always(function(){a.removeClass("abtn-no")}))):void alert("\u8bf7\u8f93\u5165\u5185\u5bb9\uff01")})}var d=e(window),u=d.height(),p=d.scrollTop(),f=s.find(".re-comt"),h=f.offset(),m=h.top,g=m+118-(u+p);if(g>0){var v=e.browser,b=v.webkit,$=e(b?"body":"html");$.animate({scrollTop:"+="+g},400,function(){})}f.stop().clearQueue().animate({height:118},200).queue(function(){e.Woo.resetCol(118,l,r),e.data(n[0],"comment",1),f.find("textarea").focus()}),e.data(n[0],"comment",0)}function n(t){t.stopPropagation(),t.preventDefault();var n,i=e(t.target).closest("a"),s=i.closest(".woo"),l=s.find(".f").last(),r=s.find("li").not(".re-comt").last(),c=i.closest(".collbtn").data("favorite"),c=c?c:l.data("favorite");if(!l.length&&c&&c.id)return void(window.location.href="/people/mblog/"+c.id+"/detail/#reply");if(n=e.data(l[0],"comment"),0!==n){var d=c.id,u=c.owner,p=e.data(e("#woo-holder")[0],"zindex")||10,n=n==$||0>n?!1:!0,f=s[0].className,h=e.G.getNum(f.match(/\bco\d+\b/gi).toString()),m=parseInt(s.css("top"))||0;s.css("zIndex",++p),e.data(e("#woo-holder")[0],"zindex",p),n?a(i,d,u,l,s,h,m):o(i,d,u,l,r,s,h,m)}}t=t||{};var i="click";return e.G.getUSERID()?e(document).on(i,this.selector,n):(this.attr("title","\u767b\u5f55\u624d\u80fd\u8bc4\u8bba\uff0c\u70b9\u51fb\u4e0b\u5c31\u53ef\u4ee5\u767b\u5f55\u5566"),e(document).on(i,this.selector,function(e){e.stopPropagation(),e.preventDefault(),SUGAR.PopOut.login()})),this},e.fn.SGlike=function(t){function a(t,a){t.hasClass("no-sub")||(t.addClass("no-sub"),e.ajax({url:"/like/",data:"object_id="+a+"&category=1&"+getToken(1),mysuccess:function(a,o){t.addClass("re-zan");var n=t.closest(".woo").find(".d2"),i=t.closest(".action").find("em"),s=n.html(),l=0;t.data("like")?t.data("like").likeid=a.data.like_id:t.data("like",{likeid:a.data.like_id+""}),l=s?parseInt(s)+1:1,n.length&&n.html(l).removeClass("dn")&&(t.find("i").length?t.find("i").html(l).addClass("z-done"):t.html(l).addClass("z-done")),i.length&&i.each(function(){e(this).html(parseInt(i.html())+1)})},myerror:function(){this.errormsg()}}).always(function(){t.removeClass("no-sub")}))}function o(t,a){t.hasClass("no-sub")||(t.data("like")&&(a=t.data("like").likeid),a&&(t.addClass("no-sub"),e.ajax({url:"/unlike/",data:"like_id="+a+"&"+getToken(1),mysuccess:function(a,o){t.removeClass("re-zan");var n=t.closest(".woo").find(".d2"),i=t.closest(".action").find("em"),s=n.html(),l=0;l=parseInt(s)>1?parseInt(s)-1:0,n.length&&(l?n.html(l):n.html(l).addClass("dn"))&&(t.find("i").length?t.find("i").html(l).removeClass("z-done"):t.html(l).removeClass("z-done")),i.length&&i.each(function(){e(this).html(parseInt(i.html())-1<0?0:parseInt(i.html())-1)})},myerror:function(){this.errormsg()}}).always(function(){t.removeClass("no-sub")})))}function n(t){t.stopPropagation(),t.preventDefault();var n=e(this),i=n.data("favorite"),i=i?i:n.closest(".collbtn").data("favorite"),s=i.id,l=(i.owner,i.likeid);n.hasClass("re-zan")?o(n,l):a(n,s)}t=t||{};var i="click";e.G.getUSERID()?e(document).on(i,this.selector,n):(this.attr("title")||this.attr("title","\u767b\u5f55\u4e4b\u540e\u624d\u80fd\u8d5e\u54e6\uff01"),e(document).on(i,this.selector,function(e){e.stopPropagation(),e.preventDefault(),SUGAR.PopOut.login()}))}}(jQuery),$(function(){var e=$("#woo-holder");if(e.length){var t=$(window);t.scroll(function(){var a=t.scrollTop(),o=$("#collbtn");if(o.length&&!ie6){var n=e.data("offset"),i=0;if(n){var s=o.closest("div.woo"),l=parseInt(s.css("top"))||0,r=n.top,c=-20,d=65;if(a-(r+l)+c+i+d>0){var u=s.offset().left;s.find(".collbtn").css({left:u,position:"fixed",top:i+d,display:"block"})}else s.find(".collbtn").css({position:"absolute",left:0,top:i,display:"block"})}}})}}),function(e){e.fn.SGfollow=function(t,a,o){"function"!=typeof t&&(o=a,a=t,t=e.noop),"string"!=typeof a&&(o=a,a=""),o=e.extend({},o);var n=function(){var e=this,t=e.data("follow");t.rel>1?e.addClass("follow followed").removeClass("unfollow followeo"):e.addClass("follow").removeClass("unfollow"),e.html("<i></i>\u5173\u6ce8"),t.rel+=-1},i=function(){var e=this,t=e.data("follow");t.rel>1?e.addClass("unfollow followeo").removeClass("follow followed"):e.addClass("unfollow").removeClass("follow"),e.html("<i></i>\u5df2\u5173\u6ce8"),t.rel+=1},s=function(t){if(t.preventDefault(),!e.G.getUSERID())return void SUGAR.PopOut.login();var a=e(this),o=a.data("follow"),s=o.id,l="/people/follow/del/",r="/people/follow/add/";a.data("locked")||(a.data("locked",1),e.ajax({url:o.rel%2?l:r,data:"follow_id="+s+"&"+getToken(),mysuccess:function(e,t){o.rel%2?n.call(a):i.call(a)}}).always(function(){a.removeData("locked")}))};return a?this.delegate(a,"click",s):this.click(s),this}}(jQuery),$(function(){if(!$.G.getUSERID()){var e=$.browser.msie&&"6.0"===$.browser.version,t=$.G.getCookie("ie6updated");if(e&&!t){var a=$('<div id="pop-ie6update">\u60f3\u83b7\u5f97\u66f4\u597d\u7684\u6d4f\u89c8\u4f53\u9a8c\uff0c\u5806\u7cd6\u5efa\u8bae\u4f60\u66f4\u65b0\u6d4f\u89c8\u5668\u3002\u63a8\u8350\u4f7f\u7528\uff1a<div class="clr ie6browser"><a target="_blank" class="chrome" href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-cn">Chrome</a><a target="_blank" class="jisu360" href="http://chrome.360.cn/">360\u6781\u901f</a><a target="_blank" class="ie9" href="http://www.microsoft.com/zh-cn/download/internet-explorer-8-details.aspx">IE8</a><a target="_blank" class="firefox" href="http://firefox.com.cn/download/">Firefox</a></div><div class="tr SG-sidebar mt8"><a href="javascript:;" class="SG-sideclose r graylk">\u77e5\u9053\u4e86</a></div></div>').sidepop({id:"side-ie6update",dockSide:"left",width:"auto",scroll:2,departure:-4,baseline:"bottom",
bias:-4,isFixed:!0,zIndex:800,btnset:0}).closest(".side-ie6update");a.find(".SG-sideclose").click(function(e){$.G.setCookie("ie6updated",1)})}var o=function(){var o=$(window).scrollTop();$(window).height();e&&!t&&a.css("visibility",o>1e3?"visible":"hidden")};$(window).scroll(o),o()}}),function(e){var t,a;e.fn.verifCallBack=function(o){var n=e(window);if(n.data("verif",o.code),t){var i=e("#ver-iframe").closest(".mask-body");i.closest(".blockPage");e.G.store(i),a.removeClass("abtn-no"),SUGAR.PopOut.go(-1),t.click(),window.setTimeout(function(){e(window).removeData("verif")},100)}},e.fn.verif=function(o){function n(){t=s,a="a"==s.attr("tagName")?s:s.closest("a"),i()}function i(){var t=e("#ver-iframe");t.length||(t=e('<iframe id="ver-iframe" style="display:block !important;width:100%;height:200px;" name="ver-iframe" src="about:blank" frameborder="0" scrolling="no"></iframe>')),t.attr("src","/webp/verif/"),l.w&&SUGAR.PopOut.alert(["\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",t],1)}var s=e(this),l=e.extend(!0,{},e.fn.verif.defaults,o);n()}}(jQuery),function(e){e.fn.uploadpic=function(t,a,o){function n(){var e=c;a?c.delegate(a,"mousemove",l).delegate(a+" "+d.sel_input,"change",r):(c.bind("mousemove",l).delegate(d.sel_input,"change",r),e=c.closest(d.sel_holder)),e.delegate("a.uploadpic-delthepic","click",i),c.delegate(a+" "+d.sel_input,"click",s)}function i(t){var a=e(this),o=a.closest(d.sel_holder),n=o.find(d.sel_uploading),i=o.find(d.sel_uploaded);o.find(d.sel_normal).removeClass("dn"),n.addClass("dn"),i.addClass("dn"),i.find("a.uploadpic-thepic").remove(),o.find("a.abtn-no").removeClass("abtn-no")}function s(t){if(!e.G.getUSERID())return t.preventDefault(),t.stopPropagation(),void SUGAR.PopOut.login();var a=e(this);a.closest("a").hasClass("abtn-no")&&(t.preventDefault(),t.stopPropagation())}function l(t){var a=e(this),o=a.offset();a.find(d.sel_input).css({left:t.pageX-o.left-70,top:t.pageY-o.top-10})}function r(){var t=e(this),a=t.closest(d.sel_form),o=e(getToken(3)),n=parseInt(1e10*Math.random());""!==t.val()&&(d.onupload(),a.find("input[name=tid]").val(n).attr("uploadpic-tid",n).data("uploadpic-config",d).data("uploadpic-callback",function(t,a){var o=t.data("uploadpic-config"),n=t.closest(o.sel_holder);if(a.success){a.src=a.src.replace(/^http\:\/\/img4\.duitang\.com/gi,"http://img4q.duitang.com");var i=n.find(o.sel_input),s=i.val();n.find(o.sel_form).closest("a").addClass("abtn-no").end().find("a.uploadpic-thepic").remove();var l=n.find(o.sel_input).blur(),r=l.clone();l.replaceWith(r);var c=n.find(o.sel_uploaded).removeClass("dn").prepend('<a class="uploadpic-thepic graylk" href="'+a.src+'" target="_blank">'+s.substr(s.lastIndexOf("\\")+1)+"</a>");c.find("a.uploadpic-delthepic").length||c.append('<a class="uploadpic-delthepic ml8 mr8" href="javascript:;">x\u5220\u9664</a>')}else n.find(o.sel_error).removeClass("dn").html(mergeServerMessage(a.message)).end().find("a.abtn-no").removeClass("abtn-no");n.find(o.sel_uploading).addClass("dn"),e.isFunction(o.fn)&&o.fn(a,n,o)}).end().append(o).submit(),o.remove(),t.closest(d.sel_holder).find(d.sel_normal).addClass("dn").end().find(d.sel_error).addClass("dn").end().find(d.sel_uploaded).addClass("dn").end().find(d.sel_uploading).removeClass("dn"),a.closest("a").addClass("abtn-no"))}var c=this;if(!(c.length<=0)){"function"!=typeof t&&(o=a,a=t,t=e.noop),"string"!=typeof a&&(o=a,a="");var d=e.extend({},e.fn.uploadpic.defaults,o);return d.fn=t,n(),this}},e.fn.uploadpic.defaults={onupload:e.noop,sel_holder:"",sel_form:"",sel_input:"input[type=file]",sel_normal:"",sel_error:"",sel_uploading:"",sel_uploaded:""},e.fn.uploadpic.upPicCallBack=function(t){if(e.isPlainObject(t)){var a=e("input[uploadpic-tid="+t.tid+"]");a.length&&e.isFunction(a.data("uploadpic-callback"))&&a.data("uploadpic-callback")(a,t)}}}(jQuery);var template=function(e,t){return template["object"==typeof t?"render":"compile"].apply(template,arguments)};!function(e,t){"use strict";e.version="1.4.0",e.openTag="<%",e.closeTag="%>",e.parser=null,e.render=function(e,t){var a=d(e);return void 0===a?u({id:e,name:"Render Error",message:"Not Cache"}):a(t)},e.compile=function(t,o){function n(a){try{return new s(a).template}catch(n){return i?(n.id=t||o,n.name="Render Error",n.source=o,u(n)):e.compile(t,o,!0)(a)}}var i=arguments[2];"string"!=typeof o&&(i=o,o=t,t=null);try{var s=c(o,i)}catch(l){return l.id=t||o,l.name="Syntax Error",u(l)}return n.prototype=s.prototype,n.toString=function(){return s.toString()},t&&(a[t]=n),n},e.helper=function(e,t){r[e]=t};var a={},o="".trim,n=o&&!t.document,i={},s=function(){var e=Array.prototype.forEach||function(e,t){for(var a=this.length>>>0,o=0;a>o;o++)o in this&&e.call(t,this[o],o,this)};return function(t,a){e.call(t,a)}}(),l=Object.create||function(e){function t(){}return t.prototype=e,new t},r=e.prototype={$forEach:s,$render:e.render,$getValue:function(e){return void 0===e?"":e}};s("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield".split(","),function(e){i[e]=!0});var c=function(t,a){function n(e){return v+=e.split(/\n/).length-1,e=e.replace(/('|"|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),e=w[1]+"'"+e+"'"+w[2],e+"\n"}function c(e){var t=v;return h?e=h(e):a&&(e=e.replace(/\n/g,function(){return v++,"$line="+v+";"})),0===e.indexOf("=")&&(e=e.substring(1).replace(/[\s;]*$/,""),o&&(e="$getValue("+e+")"),e=w[1]+e+w[2]),a&&(e="$line="+t+";"+e),d(e),e+"\n"}function d(e){e=e.replace(/\/\*.*?\*\/|'[^']*'|"[^"]*"|\.[\$\w]+/g,""),s(e.split(/[^\$\w\d]+/),function(e){if(/^this$/.test(e))throw{message:'Prohibit the use of the "'+e+'"'};!e||i.hasOwnProperty(e)||/^\d/.test(e)||b.hasOwnProperty(e)||(u(e),b[e]=!0)})}function u(e){var t;t="print"===e?k:"include"===e?_:r.hasOwnProperty(e)?"$helpers."+e:"$data."+e,$+=e+"="+t+","}var p=e.openTag,f=e.closeTag,h=e.parser,m=t,g="",v=1,b={$out:!0,$line:!0},$="var $helpers=this,"+(a?"$line=0,":""),w=o?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=o?"if(content!==undefined){$out+=content;return content}":"$out.push(content);",k="function(content){"+y+"}",_="function(id,data){if(data===undefined){data=$data}var content=$helpers.$render(id,data);"+y+"}";s(m.split(p),function(e,t){e=e.split(f);var a=e[0],o=e[1];1===e.length?g+=n(a):(g+=c(a),o&&(g+=n(o)))}),m=g,a&&(m="try{"+m+"}catch(e){e.line=$line;throw e}"),m=$+w[0]+m+"this.template="+w[3];try{var x=new Function("$data",m),C=x.prototype=l(r);return C.toString=function(){return this.template},x}catch(T){throw T.temp="function anonymous($data) {"+m+"}",T}},d=function(t){var o=a[t];if(void 0===o&&!n){var i=document.getElementById(t);return i&&e.compile(t,i.value||i.innerHTML),a[t]}return a.hasOwnProperty(t)?o:void 0},u=function(e){function a(){return a+""}var o="[template]:\n"+e.id+"\n\n[name]:\n"+e.name;return e.message&&(o+="\n\n[message]:\n"+e.message),e.line&&(o+="\n\n[line]:\n"+e.line,o+="\n\n[source]:\n"+e.source.split(/\n/)[e.line-1].replace(/^[\s\t]+/,"")),e.temp&&(o+="\n\n[temp]:\n"+e.temp),t.console&&console.error(o),a.toString=function(){return"{Template Error}"},a}}(template,this),"undefined"!=typeof module&&module.exports&&(module.exports=template),function(){$.History?window.console.warn("$.History has already been defined..."):($.History={options:{debug:!1},timer:null,state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},extractHash:function(e){var t=e.replace(/^[^#]*#/,"").replace(/^#+|#+$/,"");return t},getState:function(){var e=$.History;return e.state},setState:function(e){var t=$.History;return e=t.extractHash(e),t.state=e,t.state},getHash:function(){var e=$.History,t=e.extractHash(window.location.hash||location.hash);return t},setHash:function(e){var t=$.History;return e=t.extractHash(e),"undefined"!=typeof window.location.hash?window.location.hash!==e&&(window.location.hash=e):location.hash!==e&&(location.hash=e),e},go:function(e){var t=$.History;e=t.extractHash(e);var a=t.getHash(),o=t.getState();return e!==a?t.setHash(e):(e!==o&&t.setState(e),t.trigger()),!0},hashchange:function(e,t,a){var o=$.History;if(o.nativeSupport||o.notSupportTrigger)o.firedFirstTime=!0,o.notSupportTrigger=!1;else if(o.nativeSupport=!0,o.timer&&clearInterval(o.timer),o.firedFirstTime)return!1;var n=o.getHash();return o.go(n),!0},bind:function(e,t){var a=$.History;return t?("undefined"==typeof a.handlers.specific[e]&&(a.handlers.specific[e]=[]),a.handlers.specific[e].push(t)):(t=e,a.handlers.generic.push(t)),!0},trigger:function(e){var t=$.History;"undefined"==typeof e&&(e=t.getState());var a,o,n,i;if("undefined"!=typeof t.handlers.specific[e])for(i=t.handlers.specific[e],a=0,o=i.length;o>a;++a)(n=i[a])(e);for(i=t.handlers.generic,a=0,o=i.length;o>a;++a)(n=i[a])(e);return!0},construct:function(){var e=$.History;return $(document).ready(function(){e.domReady()}),!0},configure:function(e){var t=$.History;return t.options=$.extend(t.options,e),!0},domReadied:!1,domReady:function(){var e=$.History;if(!e.domRedied)return e.domRedied=!0,e.$window=$(window),e.$window.bind("hashchange",this.hashchange),e.nativeSupport=e.nativeSupport(),setTimeout(e.hashchangeLoader,200),!0},nativeSupport:function(e){e=e||$.browser;var t=e.version,a=parseInt(t,10),o=t.split(/[^0-9]/g),n=parseInt(o[0],10),i=parseInt(o[1],10),s=parseInt(o[2],10),l=!1;return e.msie&&a>=8?l=!0:e.webkit&&a>=528?l=!0:e.mozilla?n>1?l=!0:1===n&&(i>9?l=!0:9===i&&s>=2&&(l=!0)):e.opera&&(n>10?l=!0:10===n&&i>=60&&(l=!0)),l},hashchangeLoader:function(){var e=$.History;if(e.nativeSupport){var t=e.getHash();t&&e.$window.trigger("hashchange")}else{var a;if($.browser.msie){e.$iframe=$('<iframe id="jquery-history-iframe" style="display: none;"></iframe>').prependTo(document.body)[0],e.$iframe.contentWindow.document.open(),e.$iframe.contentWindow.document.close();var o=!1;a=function(){var t=e.getHash(),a=e.getState(),n=e.extractHash(e.$iframe.contentWindow.document.location.hash);a!==t?(o||(e.$iframe.contentWindow.document.open(),e.$iframe.contentWindow.document.close(),e.$iframe.contentWindow.document.location.hash=t),o=!1,e.notSupportTrigger=!0,e.$window.trigger("hashchange")):a!==n&&(o=!0,e.setHash(n))}}else a=function(){var t=e.getHash(),a=e.getState();a!==t&&(e.notSupportTrigger=!0,e.$window.trigger("hashchange"))};e.timer=setInterval(a,2e3)}return!0}},$.History.construct())}(),function(e,t){var a,o,n,i,s,l,r,c=(e.location,$(e)),d=$.History,u=0,p=!1,f=!1,h=!1,m=!1,g=!1,v=[],b=[],w=function(e){w.init(e)};$.extend(w,{dfConf:{formprefix:"#woo-form-",frame:["#woo-holder",".woo-swa",".woo-swb",".woo-pcont",".woo-pager",".woo-masned"],gopre:null,gonext:null,gotop:null,footer:null,unit:".woo",anchor:"woo-anchor",anchordiff:70,sink:$(null),sinkheight:0,sinkright:!1,unitsnum:24,subpagenum:4,scrollwait:100,lbias:400,appendnum:12,batchopen:!1,batchdelay:6,batchnum:2,nearbypagenum:3,ajaxdatatype:"text",ajaxcache:!1,resize:!1,refreshwhenswitch:!1,exrecycle:!1,exrecycletop:.5,exrecyclebot:1,onScroll:function(e){},onFirstArrange:function(e){},onOnePageOver:function(e,t){},onLazyAddOver:function(e,t){},onTabSwitch:function(e,t,a,o,n){},beforeImageLoad:function(e){return e},requestAlways:function(e,t){}},init:function(e){if("string"==typeof e.arrsplit){var t=e.arrsplit;e.arrsplit=[]}if("number"==typeof e.arrmasnw){var o=e.arrmasnw;e.arrmasnw=[]}if("number"==typeof e.arrmessw){var n=e.arrmessw;e.arrmessw=[]}if("number"==typeof e.arrmargin){var i=e.arrmargin;e.arrmargin=[]}if("number"==typeof e.arrfmasnw){var s=e.arrfmasnw;e.arrfmasnw=[]}if("number"==typeof e.arrgap){var u=e.arrgap;e.arrgap=[]}for(var p=0;p<e.arrform.length;p++)t!==h&&e.arrsplit.push(t),o!==h&&e.arrmasnw.push(o),n!==h&&e.arrmessw.push(n),i!==h&&e.arrmargin.push(i),s!==h&&e.arrfmasnw.push(s),u!==h&&e.arrgap.push(u);w._varClean(),this.conf=$.extend({},this.dfConf,e);var h,e=this.conf,m=e.frame,g=$(m[1]),v=$(m[2]);this.$holder=l=$(m[0]),l.length&&g.length&&v.length&&(this.$conts=v,this.$gonext=$(e.gonext),this.$gopre=$(e.gopre),this.$gotop=$(e.gotop),this.$footer=$(e.footer),r=w.WooTemp,a=c.height(),(d&&!d.getHash()||!d)&&w._switch(g,v),d&&d.bind(function(e){f?f=!1:w._switch(g,v);var t=e.split("-p"),a=parseInt(t[1])||1;a>1?w.$gopre.css("display","block"):w.$gopre.css("display","none")}),this.setClickGoPre(),this.setClickGoNext(),this.setClickGoTop(),c.unbind("scroll.woo").bind("scroll.woo",w._winScroll),c.unbind("resize.woo").bind("resize",w._winResize))},_varClean:function(){p=!1,f=!1,h=!1,m=!1,v=[],b=[],w.masn=[],w.pagine=[]},_winScroll:function(){h=!0,e.clearTimeout(s),s=e.setTimeout(function(){h=!1},w.conf.scrollwait);var t=c.scrollTop();w.$gotop.css("visibility",t>100?"visible":"hidden")},_winResize:function(){w.throttle(function(){a=c.height();var e=w.conf;e.resize&&!e.exrecycle&&o!=(o=c.width())&&w.resize()},100)},$holder:$(null),masn:[],pagine:[],resetCol:function(e,t,a){var o=l.find(this.conf.frame[5]+":visible").not(".woo-tmpmasn"),n=w._getDataColY(o);if(n&&n[t]){n[t]+=e;var i=Math.max.apply(Math,n);o.data("colY",n).css({height:i}),l.find("div.co"+t).each(function(t,o){var n=parseInt(o.style.top);n>a&&(o.style.top=n+e+"px")})}},throttle:function(t,a){e.clearTimeout(w.throttle.timer),w.throttle.timer=setTimeout(function(){t.call(this)},a)},resize:function(){for(var e=0;e<b.length;e++){var t=b[e];e===u&&t?(t.setCols(),t.figure(),t.arrangeContents(!0)):t&&t.resetDomWidth()}},recurseDo:function(t,a,o,n,i){return 0==o?void($.isFunction(i)&&i()):(a=t.apply(null,a),void(a[0].length?e.setTimeout(function(){w.recurseDo(t,a,--o,n,i)},n):$.isFunction(i)&&i()))},getFormAction:function(e){return encodeURI(e.attr("action"))},paramForm:function(e,a){var o={};return $("input,select,textarea",e).not("[type=submit]").filter("[name]").each(function(e,a){(("checkbox"===$(a).attr("type")||"radio"===$(a).attr("type"))&&$(a).prop("checked")===!0||"checkbox"!==$(a).attr("type")&&"radio"!==$(a).attr("type"))&&(o[a.name]!==t?o[a.name]+=","+a.value:o[a.name]=a.value)}),$.isPlainObject(a)&&$.extend(o,a),$.param(o)},scrollTo:function(e,t,a){if("undefined"!=typeof jQuery)return void $("body,html").animate({scrollTop:e},t,a);var o=parseInt(document.body.scrollTop),n=0,i=10;e=parseInt(e),t/=i;var s=setInterval(function(){n++,document.body.scrollTop=(e-o)/t*n+o,document.documentElement.scrollTop=(e-o)/t*n+o,n>=t&&($.isFunction(a)&&a(),clearInterval(s))},i)},scrollToAnchor:function(){var t=($("body,html"),w.conf);if($tohsh=$("a[name="+t.anchor+"]"),t.anchor&&$tohsh.length){var a=$tohsh.offset().top-t.anchordiff||0;w.scrollTo(a,200)}else e.ActiveXObject&&!e.XMLHttpRequest&&w.scrollTo(a,200)},_clickGoTop:function(e){e.preventDefault(),e.stopPropagation(),m=!0;var t=this;$("body,html");w.scrollTo(0,200,function(){t.style.visibility="hidden",m=!1})},setClickGoTop:function(){w.$gotop.unbind("click.woo").bind("click.woo",w._clickGoTop)},_clickGoPre:function(e){e.preventDefault(),w._clickGo.call(this,-1)},setClickGoPre:function(){w.$gopre.unbind("click.woo").bind("click.woo",w._clickGoPre)},_clickGoNext:function(e){e.preventDefault(),w._clickGo.call(this,1)},setClickGoNext:function(){w.$gonext.unbind("click.woo").bind("click.woo",w._clickGoNext)},_clickGo:function(e){var t=w.conf;if($(this).css("display","none"),v&&v[u]&&b&&b[u]){var a=l.find(t.frame[4]+":visible"),o=a.find(".woo-pbr").length,n=v[u]&&v[u].hasNextUpperPage,i=o&&n?!1:!0;if(o&&!n)return;v[u].isPagerClick=!0,i&&(v[u].loading=!1,v[u].lazyAdding=!0,v[u].halting=!0),v[u].slidePage(e,!0)}},_switch:function(e,t){var o=w.conf,n=o.frame,i=o.arrform;e.unbind("click.woo").tabswitch(function(e,o,n,s,l){var r=(e.eq(n),w._getPageNumFromHash());if($.Woo.conf.onTabSwitch(e,o,n,s,l),l){if(r=v[n]&&n!=s&&!w.conf.refreshwhenswitch?v[n].getPageNum():1,p=!0,f=!0,d){var c="!"+i[n];d.setHash(c+(r>1?"-p"+r:""))}o.eq(n).find(w.conf.frame[3]).last().css("height",a)}else;v[s]&&(v[s].idata=[],v[s].$data=$(null)),w._pageInit(t,n,r)},{event:"click.woo",focus:"woo-cur",cont:n[2],index:w._getFocusIdx(e)})},_pageInit:function(t,a,o){w.idx=u=a,g=!1,e.clearTimeout(n);var s=this.conf,l=s.frame,c=s.arrform,d=s.arrsplit,f=s.arrmasnw,h=s.arrmessw,m=s.arrmargin,y=s.arrfmasnw,k=s.arrgap,_=$.isArray(d)?d[a]:"",x=t.eq(a),C=x.find(l[3]).not(".woo-tmpmasn"),T=x.find(l[4]),S=parseInt(C.data("totalunits")),j=isNaN(S),P=C.data("wootemp")||0,I=C.data("subpagenum")||s.subpagenum,G=C.data("unitsnum")||s.unitsnum,A=C.data("sink")?$(C.data("sink")):$(s.sink),D=C.data("sinkheight")||s.sinkheight,U=!!C.data("sinkright")||s.sinkright,F=j?2:Math.ceil(S/G),O=!!y[a],M=f[a],R=$.isArray(h)?h[a]:null,M=R?M-R:M,H=m[a],L=k[a],q=O?M+y[a]:M,E=q!=M,B=F>2?!1:!0;if(this.$footer.css("display",1==F?"block":"none"),v[a])(v[a].lazyAdding||v[a].loading)&&p||(v[a].lazyAdding=!0,v[a].scrollLoading=!0,b[a].standardUnitCount=0,b[a].setCols(),v[a].refreshPage(o));else{var z,N=$(null);this.masn[a]=b[a]=new w.Masn(C,{unit:s.unit,gap:L||0,onAppend:w._doLoadImage,onFirstArrange:s.onFirstArrange,onArrange:function(t){t.length&&(z=2,N=t),v[a]&&(v[a].caching=1,v[a].$data=t),i&&e.clearTimeout(i),w._onscroll()},initAppendCounts:G,sinkWhat:A,firstHeight:D,rightAlignFirstBlock:U,specialColumnOpen:E,firstColumnWidth:q,columnMessWidth:R,columnWidth:M,columnMargin:H,batchOpen:s.batchopen,batchDelay:s.batchdelay,batchNum:s.batchnum}),this.pagine[a]=v[a]=new w.Pagine([C,T],{identity:"!"+c[a],arrRequestUrl:[$(s.formprefix+c[a])[0],_],requestAlways:s.requestAlways,onOnePageOver:s.onOnePageOver,ajaxDataType:s.ajaxdatatype,ajaxCache:s.ajaxcache,scrollBias:s.lbias,nearbyPageNum:s.nearbypagenum,subPageNum:I,unitsPerSub:G,currentUpperPage:o,totalPageNum:F,caching:z,$data:N,nextMode:B,analyzeResponse:r?r.analyzeResponse[P]:$.noop,lazyAdd:function(t){var o=this,n=o.config;if(0===o.$data.length&&0===o.idata.length)return o.caching=0,void(o.isLastSub()&&o.showFooter());o.lazyAdding=!0,o.caching=1;var i=o.$data,s=o.idata,l=i&&i.length||0,c=s&&s.length||0,d=l+c,p=t?Math.max(d+1,n.unitsPerSub):w.conf.appendnum,f=l+c-p,h=!1;t&&b[a]&&(b[a].clearColY(),h=!0);var m,g;l>=p?(m=i.slice(0,p),o.$data=i.slice(p)):(m=i,o.$data=$(null),g=s.slice(0,p-l),o.idata=s.slice(p-l));var v=r&&r.render[P]?r.render[P](g):g;b[a].appendContents(m,v,!1,!1,h,w.conf.batchnum,function(){if(0>=f){o.caching=0;var t=o.currentPage,a=n.subPageNum;t%a===0&&o.currentPage!=o.totalPageNum&&e.setTimeout(function(){o.prepareNext()},400),o.isLastSub()&&o.showFooter()}else o.caching=f<=n.unitsPerSub?1:2,o.$pager.css({height:0,overflow:"hidden"});e.setTimeout(function(){o.lazyAdding=!1,w.conf.onLazyAddOver(o,u)},200)})}})}p=!1,w.$gonext.css("visibility","hidden")},_getIdentityFromHash:function(){var e="";return d&&(e=d.getHash(),e=e.split("-")[0]),e},_getPageNumFromHash:function(){var e=1;if(d){var t=d.getHash();t=t.split("-p")[1],t&&(e=parseInt(t)||e)}return e},_getFocusIdx:function(e){for(var t=w.conf.arrform,a=w._getIdentityFromHash().substr(1),o=-1,n=0;n<t.length;n++)if(t[n]===a){o=n;break}return-1===o&&e.each(function(e,t){$(t).hasClass("woo-cur")&&(o=e)}),o=-1===o?0:o},_onscroll:function(){var t=c.scrollTop();if(!m&&!g&&(v[u]&&v[u].hasTouchedBottom()&&(v[u].doLazyAdd(),v[u].doLoadNext()),!h&&(w.conf.onScroll(t),l.length))){var a=w.conf,o=w.$gopre,n=w.$gonext,s=l.find(a.frame[4]+":visible"),r=s.find(".woo-pbr").length,d=v[u]&&v[u].hasNextUpperPage;o.add(n).css("visibility",t>l.position().top&&(!r||r&&d)?"visible":"hidden")}if(w.conf.exrecycle&&b[u]){var p=b[u],f=b[u].$dom,$=f.position().top;p.exRecycleInvisibleUnits(t,$,1,4,-1),p.exRecycleInvisibleUnits(t,$,0,3,1)}e.clearTimeout(i),i=e.setTimeout(w._onscroll,100)},_doLoadImage:function(t){t.find("img[srcd]").each(function(t,a){var o=$(a),n=o.attr("srcd");$.isFunction($.Woo.conf.beforeImageLoad)&&(n=$.Woo.conf.beforeImageLoad(n)),n&&o.css("display","none").one("load",function(e){$(this).css({visibility:"visible"}).fadeIn(400)}).one("error",function(){var t=$(this);e.setTimeout(function(){t.one("error",function(){t.attr("src",n)}).attr("src",n)},1e3)}).attr("src",n).removeAttr("srcd")})},_getDataColY:function(e){var t=e.data("colY");return t}}),w.Pagine=function(e,t){this.init(e,t)},w.Pagine.prototype={init:function(e,t){this.config=$.extend({},t);var a=this,o=a.config,n=o.currentUpperPage,i=o.subPageNum;a.hasNextUpperPage=!0,a.caching=o.caching,a.$data=o.$data||$(null),a.idata=[],a.$dom=e[0],a.$pager=e[1],a.unitsPerSub=o.unitsPerSub,a.totalPageNum=o.totalPageNum,a.currentUpperPage=n,a.currentPage=(n-1)*i+1,a.$loadingsm=$('<div id="woo-loading" class="woo-loading"></div>');var s=o.arrRequestUrl;"object"===$.type(s[0])&&"form"===s[0].tagName.toLowerCase()&&(a.arrurl=s),a.$dom.find(":first-child").length?n>1?(a.clearCont=!0,a.loadPage(a.currentPage,1)):a.setPager():(a.clearCont=!1,a.loadPage(a.currentPage,1))},loadPage:function(e,t,a){if(this.loading)return void(this.scrollLoading=!1);var o=this,n=o.config,i=n.subPageNum,s=t&&(e%i===1||1==i),l=!1;!t&&w.scrollToAnchor(),o.$pager.css("display","none"),o.pagerVisible=!1,o.loading=!0,o.currentUpperPage=e,i>1&&!t?e=(e-1)*i+1:i>1&&t&&(o.currentUpperPage=Math.floor((e-.1)/i)+1),t&&!s||!o.clearCont||(o.changeHashOnFirstLoad(n.identity,o.currentUpperPage),p=!0,l=!0,o.$dom.empty()),o.isPagerClick=!1,o._requestData(e,t,a,!1,l)},getPageNum:function(){return this.currentUpperPage},gotoPage:function(e){var t=this;t.clearCont=!0,t.loadPage(e,!1,!0)},refreshPage:function(e){var t=this,a=e||t.currentUpperPage;t.$data=$(null),t.idata=[],t.caching=0,t.halting=!0,t.loading=!1,t.gotoPage(a)},slidePage:function(e,t){var a=this,o=a.currentUpperPage;a.clearCont=!0,a.loadPage(o+e,!1,t)},slideSubPage:function(e){var t=this,a=t.currentPage;t.clearCont=!0,t.loadPage(a+e,1)},jumpPage:function(){var e=this,t=e.$pager.find("[type=text]").val()||0;t&&(e.clearCont=!0,e.loadPage(t))},prepareNext:function(){var e=this,t=e.currentPage;e.prepare&&e.prepare[0]===t+1||e._requestData(t+1,!0,!1,!0)},requestOver:function(e,t,a,o,n){var i=this,s=i.config,l=!i.$dom.find(":first-child").length,r=s.subPageNum,c=e%r===1;i.hasNoMore=!o,i.currentPage=e,i.caching=2,n&&(i.totalPageNum=Math.ceil(n/s.unitsPerSub)),l&&(i.loading=!0);var d=s.nextMode,u=i.currentPage,p=(i.currentUpperPage||u,i.totalPageNum),f=i.$loadingsm;i.$dom.removeClass("woo-loading"),i.isLastSub()||f.css("visibility","hidden"),d||u===p?o?i.totalPageNum=u+1:i.totalPageNum=u:d||(o?u>p&&(i.totalPageNum=u+1):i.totalPageNum=u),i.loadFromJson(a,l),(!t||c||i.isLastSub())&&i.setPager(),i.caching?i.$pager.css({display:"block",height:0,overflow:"hidden"}):i.isLastSub()&&i.$pager.css({display:"block",height:"auto"}),i.pagerVisible=!0},loadFromJson:function(e,t){var a=this,o=a.config;a.idata=a.idata.concat(e),o.lazyAdd.call(a,t)},_requestAlways:function(){var e=this,t=e.config;e.loading=!1,e.$dom.removeClass("woo-loading"),e.$loadingsm.css("visibility","hidden"),$.isFunction(t.requestAlways)&&t.requestAlways(e,u)},_beforeRequest:function(t){var a=this,o=a.$loadingsm;a.$pager.after(o),w.$footer.css("display","none"),t?(a.$dom.addClass("woo-loading"),o.css("visibility","hidden"),r&&r.reset&&r.reset(),a.idata=[],a.$data=$(null),i&&e.clearTimeout(i),w._onscroll()):o.css("visibility","visible")},_requestData:function(t,a,o,n,i){var s=this,l=s.config,c=(l.subPageNum,s.arrurl);if(c)if(!n&&s._beforeRequest(i),s.prepare&&s.prepare[0]==t)r&&r.setUnitsFromLatest&&r.setUnitsFromLatest(),s.requestOver(t,a,s.prepare[1],s.prepare[2],s.prepare[3]),s.prepare=null,e.setTimeout(function(){s._requestAlways()},50),s.scrollLoading=!1;else{var d=$(c[0]);$.ajax({type:"GET",dataType:l.ajaxDataType,cache:"undefined"!=typeof DEBUG&&DEBUG?!1:!!l.ajaxCache,url:"undefined"!=typeof DEBUG&&DEBUG?"?page="+t:w.getFormAction(d)+t+c[1],data:w.paramForm(d),timeout:2e4,success:function(e){if("undefined"!=typeof DEBUG&&DEBUG&&(e=DEBUG_DATA[Math.floor((DEBUG_DATA.length-1)*Math.random())]),!s.halting||o){o&&(s.halting=!1,s.$dom.empty()),r&&r.resetLatestUnits&&r.resetLatestUnits();var i=l.analyzeResponse(e);if(n){s.prepare=[t,i[0],i[1],i[2]];var c=[];$(i[0]).find("img[srcd]").each(function(e,t){var a=$(t);c.push(a.attr("srcd"))}),w.recurseDo(function(e){return(new Image).src=e.splice(0,1),[e]},[c],c.length,200)}else s.requestOver(t,a,i[0],i[1],i[2]);s.scrollLoading=!1,s._requestAlways()}},error:function(e,o){n||($('<div id="woo-retry" style="text-align:center;padding:12px 0 0;height:28px">\u7f51\u7edc\u7e41\u5fd9\uff0c<a href="javascript:;">\u70b9\u6b64\u91cd\u8bd5~</a></div>').click(function(e){e.stopPropagation(),e.preventDefault(),s._requestData(t,a),$(this).remove(),s.$loadingsm.css("display","block")}).insertAfter(s.$dom),s.$loadingsm.css("display","none")),s._requestAlways()}})}},hasNextUpperPage:function(){var e=this;return e.hasNextUpperPage},isLastSub:function(){var e=this;return e.currentPage%e.config.subPageNum===0||e.currentPage===e.totalPageNum},showFooter:function(){var t=this;t.$pager.css({height:"auto"}),w.$footer.css("display","block"),t.$loadingsm.remove(),e.clearTimeout(n),n=e.setTimeout(function(){t.isLastSub()&&0===t.$data.length&&0===t.idata.length&&(g=!0,w.conf.exrecycle||e.clearTimeout(i))},200),t.config.onOnePageOver(t,u)},setPager:function(){var e=this,t=e.config,a=e.currentUpperPage,o=t.nearbyPageNum,n=e.totalPageNum,i=t.subPageNum,s="";n=Math.floor((n-.1)/i)+1,(t.nextMode&&a>=n||!t.nextMode&&a>=n)&&e.hasNoMore&&(e.hasNextUpperPage=!1),e.isLastSub()?(s=['<div class="woo-pbr woo-mpbr"><ul class="woo-dib">',1==a?"":'<li><a class="woo-pre" href="javascript:;" pdir="-1" >\u4e0a\u4e00\u9875</a></li>',1==a?'<li class="woo-cur">1</li>':'<li><a href="javascript:;">1</a></li>',a-o>2?'<li class="woo-ell" >\u2026</li>':"",function(){for(var e="",t=a-o;a+o>=t;t++)t==a&&1!=t?e+='<li class="woo-cur">'+t+"</li>":t>1&&n>=t&&(e+='<li><a href="javascript:;">'+t+"</a></li>");return e}(),n-1>a+o&&!t.nextMode?'<li class="woo-ell" >\u2026</li>':"",n>a+o&&!t.nextMode?'<li><a href="javascript:;">'+n+"</a></li>":"",a==n?"":(t.nextMode?'<li class="woo-ell" >\u2026</li>':"")+'<li><a class="woo-nxt" href="javascript:;"  pdir="1">\u4e0b\u4e00\u9875</a></li>',"</ul></div>"].join(""),e.$pager.find(".woo-mpbr").remove(),e.$pager.append(s)):(e.$pager.find(".woo-mpbr").remove(),e.$pager.append(s)),e.addEventOnPagerClick();var l=w.$gonext;l.css("display","block"),e.$pager.find(".woo-pbr").length&&l.css("visibility",e.hasNextUpperPage?"visible":"hidden"),e.pagerVisible=!0,e.doLazyAdd()},changeHashOnFirstLoad:function(e,t){var a=this,o=e+(t>1?"-p"+t:""),n=d.getHash();(n||a.isPagerClick)&&n!==o&&d.setHash(o)},_pagerClick:function(e){var t=e.data.pager,a=e.target;if(a&&a.tagName&&"a"!=a.tagName.toLowerCase()&&(a=$(a).closest("a")[0]),t.$pager&&a&&a.tagName&&"a"===a.tagName.toLowerCase()&&!$(a).closest(".woo-nopagine",t.$pager.get(0)).length){e.preventDefault(),e.stopPropagation();var o=parseInt(a.innerHTML),n=a.getAttribute("pdir");t.isPagerClick=!0,o?t.gotoPage(o):"jump"===n?t.jumpPage():"sub"===n?t.slideSubPage(1):(n=parseInt(n))&&t.slidePage(n)}},addEventOnPagerClick:function(){var e=this;e.$pager.unbind("click.woo").bind("click.woo",{pager:e},e._pagerClick)},hasTouchedBottom:function(e){var o=this,n=o.config,e=e===t?c.scrollTop():e,i=w._getDataColY(o.$dom),s=o.$dom.offset().top+(parseInt(o.$dom.get(0).style.height)||0)-e-a,l=Math.max.apply(Math,i),r=Math.min.apply(Math,i);return s<n.scrollBias||l-r>s},doLazyAdd:function(){var e=this,t=e.config;!e.lazyAdding&&e.pagerVisible&&e.caching&&t.lazyAdd.call(e)},doLoadNext:function(){var e=this;e.config;e.lazyAdding||e.halting||e.scrollLoading||!e.pagerVisible||!(e.caching<2)&&e.caching||e.isLastSub()||(e.scrollLoading=!0,e.slideSubPage(1))}},w.Masn=function(e,t){this.init(e,t)},w.Masn.prototype={init:function(e,t){this.opts=$.extend({},t);var a=this;a.$dom=$(e),a.domInitWidth=a.$dom.data("domwidth")||"auto",a.figure(),a.arrangeContents(),a.opts.onFirstArrange(u)},figure:function(){var e=this,t=e.$dom,a=e.opts,o=$("<div>");t.css({position:"relative"}),e.colwf=e.colw=a.columnWidth,a.firstColumnWidth&&(e.colwf=a.firstColumnWidth),e.setCols(),e.clearColY(),t.prepend(o),e.offset0=o.offset(),e.domtop0=t.offset().top,e.left0=Math.round(o.position().left),o.remove(),a.firstHeight&&(e.firstWidth=e.colwf,e.firstHeight=a.firstHeight)},clearColY:function(){var e=this,t=[];if(e.unitCount=0,e.standardUnitCount=0,w.conf.exrecycle){e.arrColumnTail=[],e.posCoordination={},e.columnVisibleRange=[[],[]],e.unitCache={};for(var a=0;a<e.colCount;a++)e.columnVisibleRange[0][a]=e.columnVisibleRange[1][a]=a,t[a]=0}else for(var a=0;a<e.colCount;a++)t[a]=0;e.$dom.data("colY",t)},exIsUnitVisible:function(e,t,o,n){var i=w.conf.exrecycletop,s=w.conf.exrecyclebot,l=i>-10&&10>i?i*a:i,r=s>-10&&10>s?s*a:s,c=-1,d=t+o+n,u=t+o,p=e-l,f=e+a+r;return d>=p&&f>=u?c=0:p>d&&(c=1),c},exRecycleInvisibleUnits:function(e,a,o,n,i){for(var s,l=this,r=0,c=0,d=0;d<l.colCount;d++){for(s=l.columnVisibleRange[1&o][d],c=l.columnVisibleRange[1^o][d];r>=0&&r<l.unitCount;){r=s;var u=l.posCoordination[""+r];if(u===t)break;var p=l.exIsUnitVisible(e,a,u[0],u[1]);if(p==i)break;if(0!==p||u[5]||(l.unitCache[""+r]&&l.unitCache[""+r].appendTo(l.$dom),u[5]=1),l.columnVisibleRange[1&o][d]=r,-1==u[n]||u[n]==r)break;s=u[n]}for(;c>=0&&c<l.unitCount;){var u=l.posCoordination[""+c];if(u===t)break;var p=l.exIsUnitVisible(e,a,u[0],u[1]);if(0==p||p==i)break;if(u[5]&&(l.unitCache[""+c]&&l.unitCache[""+c].remove(),u[5]=0),-1==u[n]){l.columnVisibleRange[1&o][d]=l.columnVisibleRange[1^o][d];break}if(u[n]==c)break;c=l.columnVisibleRange[1^o][d]=u[n]}}},setContHeight:function(){var e=this,t=w._getDataColY(e.$dom);e.$dom.css({height:Math.max.apply(Math,t.concat(a-e.domtop0))}).data("colY",t)},setCols:function(){var e,t=this,a=t.opts,o=t.$dom,n=a.columnMessWidth||0,i=n?a.columnMargin:0;t.resetDomWidth(),e=t.domWidth,t.colCount=Math.max(Math.floor((e+a.columnMargin-t.colwf+t.colw-n)/t.colw),1),t.domWidth=t.colCount*t.colw+t.colwf-t.colw-a.columnMargin+n-i,o.css("width",t.domWidth)},resetDomWidth:function(){var e=this,t=e.$dom;t.css("width",e.domInitWidth),e.domWidth="auto"===e.domInitWidth?t.parent().width():e.domInitWidth},arrangeContents:function(e){var t,a,o=this,n=o.$dom,i=o.opts,s=i.initAppendCounts;if(t=n.children().filter(i.unit),a=t.length){e&&(s=a);var l=t.slice(0,s);t=t.slice(s).addClass("woo-wait"),o.appendContents(l,null,!0,e,!!i.firstHeight,s,$.noop),i.onAppend(l)}n.css("visibility","visible"),$.isFunction(i.onArrange)&&i.onArrange(t)},appendContents:function(e,t,a,o,n,i,s){var l=this,r=l.opts,c=l.$dom,i=(w._getDataColY(c),i||r.batchNum),d=l._placeEachUnit(l,r,c,e,t,a,o,n&&l.firstHeight),u=d[0],p=d[1];a?(w.conf.exrecycle&&p.each(function(e,t){var a=p.eq(e);l.unitCache[""+a.data("idx")]=a}),r.onAppend(p),l.setContHeight()):(u.appendTo(c),r.batchOpen?w.recurseDo(function(e,t){var a=0;return w.conf.exrecycle?e.each(function(o,n){var i=e.eq(o);l.unitCache[""+i.data("idx")]=i,a++,$(n).append(t.eq(o).children())}):e.each(function(e,o){a++,$(o).append(t.eq(e).children())}),r.onAppend(e),e=e.slice(i),t=t.slice(a),l.setContHeight(),[e,t]},[u,p],Math.ceil(u.length/i),r.batchDelay,function(){s()}):(w.conf.exrecycle?u.each(function(e,t){var a=u.eq(e);l.unitCache[""+a.data("idx")]=a,$(t).append(p.eq(e).children())}):u.each(function(e,t){$(t).append(p.eq(e).children())}),l.setContHeight(),r.onAppend(u),s()))},prePlaceUnit:function(e,t,a,o,n){var i,s,l,r,c,d=this,u=d.opts,p=a;for(i=Math.min.apply(Math,t);p--;)t[p]==i&&(s=p);return d.colwf!=d.colw&&(0===s&&!u.rightAlignFirstBlock||s===a-1&&u.rightAlignFirstBlock)&&(c=d.colwf,!n&&e.addClass("woo-spcol")),o&&u.specialColumnOpen&&e.removeData("ht").removeAttr("data-ht"),l=d.colw*s+d.left0+(!u.rightAlignFirstBlock&&s&&d.colwf!=d.colw?d.colwf-d.colw:0),r=n?d.firstHeight:e.data("ht")||(e.outerHeight?e.outerHeight(!0):e.height()+(parseInt(e.css("margin-top"))||0)+(parseInt(e.css("margin-bottom"))||0)),t[s]+=r+u.gap,[i,s,l,r,c]},_placeEachUnit:function(e,t,a,o,n,i,s,l){
var r,c,d,u,p,f,h,m,g=a.prev(),v=!!g.length,b="",y=$(null),k=w._getDataColY(a),_=e.colCount,x=0,C=s&&l;if(!v||v&&!g.hasClass("woo-tmpmasn")){var T=w.conf.frame,S=("."==T[3].indexOf(0)?T[3].substr(1):"")+" "+("."==T[5].indexOf(0)?T[5].substr(1):"")+" woo-loading";g=$('<div class="woo-tmpmasn '+a.attr("class")+'" style="position:relative;height:0;overflow:hidden;margin:0;padding:0;"></div>').removeClass(S),a.before(g)}var j=o.add(n).removeClass("woo-wait"),P=i?j.parent():g.append(j);if(y=P.find(t.unit).not(".woo-f,.woo-wait").each(function(a,o){var n=$(o),i=n.data("id");(0===a&&l&&!t.rightAlignFirstBlock||a===_-1&&l&&t.rightAlignFirstBlock)&&(r=e.prePlaceUnit(n,k,_,s,l),c=r[0],d=r[1],u=r[2],p=r[3],f=r[4],h='<div class="woo woo-f co'+d+" "+(f?"woo-spcol":"")+'" data-ht="'+p+'" data-idx="'+e.unitCount+'" style="position:absolute;overflow:hidden;top:'+c+"px;left:"+u+"px;width:"+(e.firstWidth-t.columnMargin)+'px;"></div>',b+=h,m=C?P.find(".woo-f:first").css({left:u,top:c}):$(h).append(t.sinkWhat),m.data("idx",e.unitCount),x=a,w.conf.exrecycle&&e.exCoordMap(c,p,d),e.unitCount++),r=e.prePlaceUnit(n,k,_,s),c=r[0],d=r[1],u=r[2],p=r[3],f=r[4],b+='<div class="'+t.unit.substr(1)+" co"+d+(f?" woo-spcol":"")+'" '+(i?'data-id="'+i+'"':"")+' data-ht="'+p+'" data-idx="'+e.unitCount+'" style="top:'+c+"px;left:"+u+'px;"></div>',n.css({top:c,left:u}).data("ht",p).data("idx",e.unitCount),n.removeClass(function(e,t){return"woo-spcol "+(t.match(/co\d+/gi)||[]).join(" ")}).addClass((f?"woo-spcol ":"")+"co"+d),w.conf.exrecycle&&e.exCoordMap(c,p,d),e.unitCount++,e.standardUnitCount++}),a.data("colY",k),!C&&l){var I=y.toArray();y=$(I.slice(0,x).concat(m?m.toArray():[],I.slice(x)))}return g.empty(),[$(b),y]},exCoordMap:function(t,a,o){var n=this,i=n.arrColumnTail[o]||o;n.posCoordination[""+n.unitCount]=[t,a,o,i,-1,0],n.posCoordination[""+i]&&(n.posCoordination[""+i][4]=n.unitCount),n.arrColumnTail[o]=n.unitCount;var s=n.unitCount;e.setTimeout(function(){n.posCoordination[""+s][5]=1},800)}},$.Woo=w}(window);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-19056403-7"]),_gaq.push(["_setDomainName","duitang.com"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="http://img5.duitang.com/static/buy/js/comm/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();